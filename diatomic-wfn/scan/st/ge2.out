#INFO: **** input file is /home/jluis/src/git/db/diatomic-wfn/scan/run_sp.py ****
#!/usr/bin/env python

import numpy, sys, os
from pyscf import lib, gto, scf, dft
from pyscf.tools import molden
from pyscf.data import radii

def read_molecule(path):

    charge = spin = 0
    with open(path, 'r') as myfile:
        output = myfile.read()
        output = output.lstrip()
        output = output.rstrip()
        output = output.split('\n')

    try:
        int(output[0])
    except ValueError:
        try:
            charge = int(output[0].split(' ')[0])
            spin = int(output[0].split(' ')[1]) - 1
        except ValueError:
            molecule = output
        else:
            molecule = '\n'.join(output[1:])
    else:
        if int(output[0]) == len(output) - 2:
            molecule = '\n'.join(output[2:])
            try:
                charge = int(output[1].split(' ')[0])
                spin = int(output[1].split(' ')[1])-1
            except ValueError:
                pass
        else:
            print "THIS IS NOT A VALID XYZ FILE"

    return (molecule, charge, spin)

directory = '../../diatomic/'
files = [i for i in os.listdir(directory) if i.endswith('.xyz')]

for filename in files:

    name = filename[:-8]
    mol = gto.Mole()
    (mol.atom, charge, spin) = read_molecule(directory+filename)
    mol.basis = 'aug-cc-pvtz'
    mol.charge = charge
    mol.spin = spin
    mol.output = name+'.out'
    mol.symmetry = 0
    mol.verbose = 4
    mol.build()

    mf = dft.RKS(mol) 
    mf.xc = 'scan'
    mf.grids.level = 4
    mf.max_cycle = 120
    mf.chkfile = name+'.chk'
    mf = scf.addons.remove_linear_dep_(mf)
    #mf = mf.newton()
    mf.kernel()
    #
    #stable_cyc = 3
    #for i in range(stable_cyc):
    #    new_mo_coeff = mf.stability(internal=True, external=False)[0]
    #    if numpy.linalg.norm(numpy.array(new_mo_coeff) - numpy.array(mf.mo_coeff)) < 10**-8:
    #        lib.logger.info(mf,"* The molecule is stable")
    #        break
    #    else:
    #        lib.logger.info(mf,"* The molecule is unstable")
    #        n_alpha = numpy.count_nonzero(mf.mo_occ)
    #        P_alpha = 2.0*numpy.dot(new_mo_coeff[:, :n_alpha], new_mo_coeff.T[:n_alpha])
    #        mf.kernel(dm0=(P_alpha))
    #        lib.logger.info(mf,"* Updated SCF energy and orbitals: %.6f" % mf.e_tot)
    #
    dm = mf.make_rdm1()
    nao = mol.nao_nr()
    unit = 2.541746
    origin = ([0.0,0.0,0.0])
    charges = mol.atom_charges()
    coords  = mol.atom_coords()
    mol.set_common_orig(origin)
    r2 = mol.intor_symmetric('int1e_r2')
    r2 = numpy.einsum('ij,ji->', r2, dm)
    lib.logger.info(mf,'Electronic spatial extent <R**2> (au): %.4f', r2)

    lib.logger.info(mf,'* Multipoles in the independent field-basis, Gauge -> (0,0,0)')
    ao_dip = mol.intor_symmetric('int1e_r', comp=3)
    el_dip = numpy.einsum('xij,ji->x', ao_dip, dm)
    lib.logger.info(mf,'Electronic Dipole moment(X, Y, Z, Debye): %.4f, %.4f, %.4f', *el_dip*unit)
    nucl_dip = numpy.einsum('i,ix->x', charges, coords)
    lib.logger.info(mf,'Nuclear Dipole moment(X, Y, Z, Debye): %.4f, %.4f, %.4f', *nucl_dip*unit)
    mol_dip = (nucl_dip - el_dip) * unit
    lib.logger.info(mf,'Total Dipole moment(X, Y, Z, Debye): %.4f, %.4f, %.4f', *mol_dip)

    lib.logger.info(mf,'Quadrupole moments (Debye-Angs)')
    rr = mol.intor_symmetric('int1e_rr', comp=9).reshape(3,3,nao,nao)
    rr = -1.0*numpy.einsum('xyij,ji->xy', rr, dm)
    rr += numpy.einsum('z,zx,zy->xy', charges, coords, coords)
    rr = rr*unit*lib.param.BOHR
    lib.logger.info(mf,'Total Quadrupole moments (XX, YY, ZZ): %.4f, %.4f, %.4f', \
    rr[0,0], rr[1,1], rr[2,2])
    lib.logger.info(mf,'Total Quadrupole moments (XY, XZ, YZ): %.4f, %.4f, %.4f', \
    rr[0,1], rr[0,2], rr[1,2])
 
    lib.logger.info(mf,'Octupole moments (Debye-Angs**2)')
    rrr = mol.intor_symmetric('int1e_rrr', comp=27).reshape(3,3,3,nao,nao)
    rrr = -1.0*numpy.einsum('xyzij,ji->xyz', rrr, dm)
    rrr += numpy.einsum('z,zx,zy,zk->xyk', charges, coords, coords, coords)
    rrr = rrr*unit*lib.param.BOHR**2
    lib.logger.info(mf,'Total Octupole moments (XXX, YYY, ZZZ, XYY): %.4f, %.4f, %.4f, %.4f', \
    rrr[0,0,0], rrr[1,1,1], rrr[2,2,2], rrr[0,1,1])
    lib.logger.info(mf,'Total Octupole moments (XXY, XXZ, XZZ, YZZ): %.4f, %.4f, %.4f, %.4f', \
    rrr[0,0,1], rrr[0,0,2], rrr[0,2,2], rrr[1,2,2])
    lib.logger.info(mf,'Total Octupole moments (YYZ, XYZ): %.4f, %.4f', rrr[1,1,2], rrr[0,1,2])

    lib.logger.info(mf,'Hexadecapole moments (Debye-Angs**3)')
    rrrr = mol.intor_symmetric('int1e_rrrr', comp=81).reshape(3,3,3,3,nao,nao)
    rrrr = -1.0*numpy.einsum('xyzwij,ji->xyzw', rrrr, dm)
    rrrr += numpy.einsum('z,zx,zy,zk,zw->xykw', charges, coords, coords, coords, coords)
    rrrr = rrrr*unit*lib.param.BOHR**3
    lib.logger.info(mf,'Total Hexadecapole moments (XXXX, YYYY, ZZZZ, XXXY): %.4f, %.4f, %.4f, %.4f', \
    rrrr[0,0,0,0], rrrr[1,1,1,1], rrrr[2,2,2,2], rrrr[0,0,0,1])
    lib.logger.info(mf,'Total Hexadecapole moments (XXXZ, YYYX, YYYZ, ZZZX): %.4f, %.4f, %.4f, %.4f', \
    rrrr[0,0,0,2], rrrr[1,1,1,0], rrrr[1,1,1,2], rrrr[2,2,2,0])
    lib.logger.info(mf,'Total Hexadecapole moments (ZZZY, XXYY, XXZZ, YYZZ): %.4f, %.4f, %.4f, %.4f', \
    rrrr[2,2,2,1], rrrr[0,0,1,1], rrrr[0,0,2,2], rrrr[1,1,2,2])
    lib.logger.info(mf,'Total Hexadecapole moments (XXYZ, YYXZ, ZZXY): %.4f, %.4f, %.4f', \
    rrrr[0,0,1,2], rrrr[1,1,0,2], rrrr[2,2,0,1])
     
    coeff = mf.mo_coeff[:,mf.mo_occ>0]
    occ = mf.mo_occ[mf.mo_occ>0]
    energy = mf.mo_energy[mf.mo_occ>0]
    den_file = name+'.mol'
    fspt = open(den_file,'w')
    molden.header(mol, fspt)
    molden.orbital_coeff(mol, fspt, coeff, ene=energy, occ=occ) 
    fspt.close()                    
    cmd = '/home/jluis/bin/molden2aim '+name
    os.system(cmd)
    den_file = name+'.wfn'
    fspt = open(den_file,'a')
    fspt.write('RHF\n')
    fspt.close()                    

    pmd_file = name+'.pmd'
    fspt = open(pmd_file,'w')
    fspt.write('%s.wfn\n' % (name))
    if (mol.symmetry == False):
        fspt.write('nosymmetry\n')
    fspt.write('tes\n')
    fspt.write('  epsiscp 0.220\n')
    fspt.write('  radialquad 7\n')
    fspt.write('  rmapping 2\n')
    fspt.write('  lmax 10\n')
    fspt.write('  nr 551\n')
    fspt.write('  lebedev 5810\n')
    fspt.write('  betasphere\n')
    for ia in range(mol.natm):
        symb = mol.atom_pure_symbol(ia)
        inuc = lib.parameters.NUC[symb]
        betarad = radii.COVALENT[inuc]/3.5
        fspt.write('  betaradw %d %1.3f\n' % ((ia+1),betarad))
    fspt.write('  radialquadbeta 7\n')
    fspt.write('  rmappingbeta 3\n')
    fspt.write('  lmaxbeta 8\n')
    fspt.write('  nrb 451\n')
    fspt.write('  lebedevbeta 3074\n')
    fspt.write('  dafh\n')
    fspt.write('endtes')
    fspt.close()                    

    cmd = 'rm '+name+'.mol'
    os.system(cmd)
#INFO: ******************** input file end ********************


System: ('Linux', 'silicio', '3.16.0-4-amd64', '#1 SMP Debian 3.16.51-3 (2017-12-13)', 'x86_64', '')  Threads 12
Python 2.7.14 (default, Apr  9 2018, 16:34:43) 
[GCC 7.3.0]
numpy 1.14.2  scipy 1.0.1
Date: Fri Jun 29 23:08:46 2018
PySCF version 1.5
PySCF path  /home/jluis/src/pyscf/pyscf
GIT ORIG_HEAD f2dbb26d09ae5148fbf5975669a994500ac7a4c9
GIT HEAD      ref: refs/heads/master
GIT master branch  f2dbb26d09ae5148fbf5975669a994500ac7a4c9

[ENV] PYSCF_TMPDIR /scratch-ssd/jluis
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 64
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry 0 subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 Ge     0.000000000000   0.000000000000   1.078854000000 AA    0.000000000000   0.000000000000   2.038738588392 Bohr
[INPUT]  2 Ge     0.000000000000   0.000000000000  -1.078854000000 AA    0.000000000000   0.000000000000  -2.038738588392 Bohr

nuclear repulsion = 251.13567914754
number of shells = 28
number of NR pGTOs = 254
number of NR cGTOs = 118
basis = aug-cc-pvtz
ecp = {}
CPU time:       636.33


******** <class 'pyscf.dft.rks.RKS'> flags ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
DIIS start cycle = 1
DIIS space = 8
SCF tol = 1e-09
SCF gradient tol = None
max. SCF cycles = 120
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = ge2.chk
max_memory 64000 MB (current use 95 MB)
XC functionals = scan
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs (JCP 102, 346 (M4)) radial grids
    
becke partition: Becke, JCP, 88, 2547 (1988)
pruning grids: <function nwchem_prune at 0x2b067e0f35f0>
grids dens level: 4
symmetrized grids: 0
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b067e0f3500>
Set gradient conv threshold to 3.16228e-05
tot grids = 60372
init E= -4152.93486568745
  HOMO = -0.199436048861326  LUMO = -0.191869028245671
cycle= 1 E= -4153.89611796798  delta_E= -0.961  |g|= 0.606  |ddm|= 1.87

WARN: HOMO -0.193224051559527 == LUMO -0.193224051559524

cycle= 2 E= -4153.87013465225  delta_E= 0.026  |g|= 0.665  |ddm|= 1.69
  HOMO = -0.192257249174261  LUMO = -0.188185614225795
cycle= 3 E= -4153.93357996012  delta_E= -0.0634  |g|=  0.1  |ddm|= 1.42

WARN: HOMO -0.188794232017174 == LUMO -0.188215968576664

cycle= 4 E= -4153.92551281041  delta_E= 0.00807  |g|= 0.153  |ddm|= 1.35
  HOMO = -0.195530999358383  LUMO = -0.193208070195851
cycle= 5 E= -4153.93404835123  delta_E= -0.00854  |g|= 0.0948  |ddm|= 1.35

WARN: HOMO -0.19433633326042 == LUMO -0.193499055996366

cycle= 6 E= -4153.93511295715  delta_E= -0.00106  |g|= 0.0795  |ddm|= 0.022

WARN: HOMO -0.19555268306095 == LUMO -0.19546557685805

cycle= 7 E= -4153.9235245501  delta_E= 0.0116  |g|= 0.174  |ddm|= 1.34

WARN: HOMO -0.195501225665097 == LUMO -0.195469567953556

cycle= 8 E= -4153.92410063208  delta_E= -0.000576  |g|= 0.169  |ddm|= 0.0385

WARN: HOMO -0.195531004406567 == LUMO -0.195472108707997

cycle= 9 E= -4153.92434528774  delta_E= -0.000245  |g|= 0.167  |ddm|= 0.742

WARN: HOMO -0.195408268200624 == LUMO -0.195364398073361

cycle= 10 E= -4153.92535677928  delta_E= -0.00101  |g|= 0.159  |ddm|= 0.47

WARN: HOMO -0.195197622109337 == LUMO -0.195184928470473

cycle= 11 E= -4153.92513258714  delta_E= 0.000224  |g|= 0.161  |ddm|= 0.361

WARN: HOMO -0.195112372964981 == LUMO -0.195000225578388

cycle= 12 E= -4153.92478987163  delta_E= 0.000343  |g|= 0.163  |ddm|= 0.233

WARN: HOMO -0.19557430503253 == LUMO -0.195427856731343

cycle= 13 E= -4153.92574169037  delta_E= -0.000952  |g|= 0.156  |ddm|= 0.0296
  HOMO = -0.196497896241738  LUMO = -0.188006201686443
cycle= 14 E= -4153.92815762245  delta_E= -0.00242  |g|= 0.155  |ddm|= 1.36
  HOMO = -0.19722090124787  LUMO = -0.185790480594446
cycle= 15 E= -4153.92425620576  delta_E= 0.0039  |g|= 0.184  |ddm|= 0.0489

WARN: HOMO -0.196285554616332 == LUMO -0.195291211058475

cycle= 16 E= -4153.92740744369  delta_E= -0.00315  |g|= 0.141  |ddm|= 1.35

WARN: HOMO -0.196255373840425 == LUMO -0.195439345324021

cycle= 17 E= -4153.92808859896  delta_E= -0.000681  |g|= 0.134  |ddm|= 0.0197

WARN: HOMO -0.195599034792256 == LUMO -0.195364710298681

cycle= 18 E= -4153.9278115295  delta_E= 0.000277  |g|= 0.137  |ddm|= 0.282

WARN: HOMO -0.19559942825579 == LUMO -0.195364869491743

cycle= 19 E= -4153.9278023732  delta_E= 9.16e-06  |g|= 0.137  |ddm|= 0.0301

WARN: HOMO -0.194666151988947 == LUMO -0.194501605467161

cycle= 20 E= -4153.9274410005  delta_E= 0.000361  |g|= 0.139  |ddm|= 0.687

WARN: HOMO -0.19498317102778 == LUMO -0.194570755022888

cycle= 21 E= -4153.9272582803  delta_E= 0.000183  |g|= 0.141  |ddm|= 0.339

WARN: HOMO -0.195026200227045 == LUMO -0.194540360362434

cycle= 22 E= -4153.9279341473  delta_E= -0.000676  |g|= 0.134  |ddm|= 0.0412
  HOMO = -0.195597005830858  LUMO = -0.182773009191488
cycle= 23 E= -4153.9237782701  delta_E= 0.00416  |g|= 0.189  |ddm|= 1.35
  HOMO = -0.195600720160428  LUMO = -0.182598795084867
cycle= 24 E= -4153.92352399615  delta_E= 0.000254  |g|= 0.191  |ddm|= 0.0031
  HOMO = -0.193714982968364  LUMO = -0.18835297753847
cycle= 25 E= -4153.93151514955  delta_E= -0.00799  |g|= 0.128  |ddm|= 0.123

WARN: HOMO -0.196079505058717 == LUMO -0.195834866885708

cycle= 26 E= -4153.92667390269  delta_E= 0.00484  |g|= 0.151  |ddm|= 1.35

WARN: HOMO -0.195981295802599 == LUMO -0.195781822500105

cycle= 27 E= -4153.92697826115  delta_E= -0.000304  |g|= 0.148  |ddm|= 0.0583

WARN: HOMO -0.195995008604719 == LUMO -0.19580254627832

cycle= 28 E= -4153.92710614414  delta_E= -0.000128  |g|= 0.146  |ddm|= 0.0176
  HOMO = -0.196893266687113  LUMO = -0.194559547752425
cycle= 29 E= -4153.93360874679  delta_E= -0.0065  |g|= 0.101  |ddm|= 1.35
  HOMO = -0.196685927444072  LUMO = -0.195535011664592
cycle= 30 E= -4153.93436885026  delta_E= -0.00076  |g|= 0.0912  |ddm|= 0.0274

WARN: HOMO -0.19643224868329 == LUMO -0.196065466562649

cycle= 31 E= -4153.92658052172  delta_E= 0.00779  |g|= 0.151  |ddm|= 1.34

WARN: HOMO -0.196726893140564 == LUMO -0.19626369859431

cycle= 32 E= -4153.92845358677  delta_E= -0.00187  |g|= 0.134  |ddm|= 0.067
  HOMO = -0.197493794041677  LUMO = -0.190061723030106
cycle= 33 E= -4153.92978010545  delta_E= -0.00133  |g|= 0.141  |ddm|= 1.34

WARN: HOMO -0.195187520833982 == LUMO -0.195073520689722

cycle= 34 E= -4153.92415588051  delta_E= 0.00562  |g|= 0.169  |ddm|= 1.36

WARN: HOMO -0.194627072501545 == LUMO -0.194515319870875

cycle= 35 E= -4153.92101597727  delta_E= 0.00314  |g|= 0.192  |ddm|= 0.744

WARN: HOMO -0.194710298075447 == LUMO -0.194619127200766

cycle= 36 E= -4153.92312853552  delta_E= -0.00211  |g|= 0.177  |ddm|= 0.122

WARN: HOMO -0.194667456756403 == LUMO -0.194560308641011

cycle= 37 E= -4153.9207948574  delta_E= 0.00233  |g|= 0.194  |ddm|= 0.127

WARN: HOMO -0.194651668972771 == LUMO -0.194488635991816

cycle= 38 E= -4153.92082151823  delta_E= -2.67e-05  |g|= 0.193  |ddm|= 0.164
  HOMO = -0.196427305019137  LUMO = -0.184880030672441
cycle= 39 E= -4153.92337902711  delta_E= -0.00256  |g|= 0.191  |ddm|= 1.41
  HOMO = -0.195115889535076  LUMO = -0.187649180232977
cycle= 40 E= -4153.92854428027  delta_E= -0.00517  |g|= 0.153  |ddm|= 0.0722
  HOMO = -0.196474380932029  LUMO = -0.19437466084612
cycle= 41 E= -4153.93313616345  delta_E= -0.00459  |g|= 0.106  |ddm|= 0.0989

WARN: HOMO -0.195730354902283 == LUMO -0.195613185859247

cycle= 42 E= -4153.93450147723  delta_E= -0.00137  |g|= 0.0899  |ddm|= 0.0348

WARN: HOMO -0.195995441534142 == LUMO -0.195219071346084

cycle= 43 E= -4153.92776038114  delta_E= 0.00674  |g|= 0.137  |ddm|= 1.34

WARN: HOMO -0.195430957117441 == LUMO -0.194566774764984

cycle= 44 E= -4153.92902027277  delta_E= -0.00126  |g|= 0.123  |ddm|= 0.106

WARN: HOMO -0.195135336884728 == LUMO -0.194516994341971

cycle= 45 E= -4153.92551432418  delta_E= 0.00351  |g|= 0.155  |ddm|= 1.15

WARN: HOMO -0.195004571963374 == LUMO -0.194701510603019

cycle= 46 E= -4153.92713541518  delta_E= -0.00162  |g|= 0.141  |ddm|= 0.0585

WARN: HOMO -0.195118237180664 == LUMO -0.194862620144339

cycle= 47 E= -4153.92759487083  delta_E= -0.000459  |g|= 0.136  |ddm|=  1.1

WARN: HOMO -0.195531960537351 == LUMO -0.194978058658632

cycle= 48 E= -4153.93462428332  delta_E= -0.00703  |g|= 0.0923  |ddm|= 1.34
  HOMO = -0.197186171499033  LUMO = -0.189643583294301
cycle= 49 E= -4153.92908084668  delta_E= 0.00554  |g|= 0.146  |ddm|= 0.112
  HOMO = -0.196677890939078  LUMO = -0.193956225778665
cycle= 50 E= -4153.93329368415  delta_E= -0.00421  |g|= 0.104  |ddm|= 0.0844

WARN: HOMO -0.195694486584818 == LUMO -0.195622141496408

cycle= 51 E= -4153.92699651608  delta_E= 0.0063  |g|= 0.146  |ddm|= 1.34

WARN: HOMO -0.195749202726308 == LUMO -0.195447808088552

cycle= 52 E= -4153.92685303349  delta_E= 0.000143  |g|= 0.146  |ddm|= 0.91

WARN: HOMO -0.195841292292401 == LUMO -0.195550295722876

cycle= 53 E= -4153.9270737124  delta_E= -0.000221  |g|= 0.144  |ddm|= 0.0128

WARN: HOMO -0.195051236706889 == LUMO -0.194633606785639

cycle= 54 E= -4153.92319031683  delta_E= 0.00388  |g|= 0.178  |ddm|= 1.12

WARN: HOMO -0.195071446164973 == LUMO -0.194574146560582

cycle= 55 E= -4153.92258040518  delta_E= 0.00061  |g|= 0.182  |ddm|= 0.0333

WARN: HOMO -0.195288252545323 == LUMO -0.194885392646634

cycle= 56 E= -4153.92399604557  delta_E= -0.00142  |g|= 0.172  |ddm|= 0.0533

WARN: HOMO -0.194437023830757 == LUMO -0.194174626251723

cycle= 57 E= -4153.92730865438  delta_E= -0.00331  |g|= 0.138  |ddm|= 0.104
  HOMO = -0.196848988076659  LUMO = -0.186878955998852
cycle= 58 E= -4153.92709034129  delta_E= 0.000218  |g|= 0.161  |ddm|= 1.35
  HOMO = -0.19732069839438  LUMO = -0.185757737958242
cycle= 59 E= -4153.92514700976  delta_E= 0.00194  |g|= 0.175  |ddm|= 0.0277
  HOMO = -0.197149711638374  LUMO = -0.188770405748433
cycle= 60 E= -4153.9286179206  delta_E= -0.00347  |g|= 0.149  |ddm|= 0.0628

WARN: HOMO -0.196301839735213 == LUMO -0.195519152655055

cycle= 61 E= -4153.93038725258  delta_E= -0.00177  |g|= 0.123  |ddm|=  1.3

WARN: HOMO -0.196225977524776 == LUMO -0.195646784459326

cycle= 62 E= -4153.92895766701  delta_E= 0.00143  |g|= 0.128  |ddm|= 0.301

WARN: HOMO -0.196146521536653 == LUMO -0.195563728499415

cycle= 63 E= -4153.92933390178  delta_E= -0.000376  |g|= 0.126  |ddm|= 0.162

WARN: HOMO -0.195889534620551 == LUMO -0.195314672328882

cycle= 64 E= -4153.92842913214  delta_E= 0.000905  |g|= 0.134  |ddm|= 0.218

WARN: HOMO -0.194482440935449 == LUMO -0.193789774671667

cycle= 65 E= -4153.92680834354  delta_E= 0.00162  |g|= 0.145  |ddm|= 0.207

WARN: HOMO -0.194338792136123 == LUMO -0.193723503221261

cycle= 66 E= -4153.9264749886  delta_E= 0.000333  |g|= 0.147  |ddm|= 0.0462
  HOMO = -0.190954773227135  LUMO = -0.184990615184487
cycle= 67 E= -4153.93206248834  delta_E= -0.00559  |g|= 0.135  |ddm|= 1.34
  HOMO = -0.192388236291142  LUMO = -0.188424573190641
cycle= 68 E= -4153.93302055034  delta_E= -0.000958  |g|= 0.113  |ddm|= 0.187
  HOMO = -0.191862309090978  LUMO = -0.188384307281708
cycle= 69 E= -4153.93424696544  delta_E= -0.00123  |g|= 0.102  |ddm|= 0.128
  HOMO = -0.194143667555602  LUMO = -0.192828379808559
cycle= 70 E= -4153.92815246715  delta_E= 0.00609  |g|= 0.135  |ddm|= 1.34
  HOMO = -0.193970828695489  LUMO = -0.192701575170819
cycle= 71 E= -4153.92779496857  delta_E= 0.000357  |g|= 0.134  |ddm|= 0.146
  HOMO = -0.194392895130439  LUMO = -0.192995449676355
cycle= 72 E= -4153.92831029439  delta_E= -0.000515  |g|= 0.133  |ddm|= 0.127
  HOMO = -0.19416167780525  LUMO = -0.192914234214834
cycle= 73 E= -4153.92878473063  delta_E= -0.000474  |g|= 0.129  |ddm|= 0.0278

WARN: HOMO -0.195272305949404 == LUMO -0.194449177705286

cycle= 74 E= -4153.93466269018  delta_E= -0.00588  |g|= 0.0973  |ddm|= 1.26

WARN: HOMO -0.195242807465591 == LUMO -0.194818866873763

cycle= 75 E= -4153.93230073855  delta_E= 0.00236  |g|= 0.097  |ddm|= 1.31
  HOMO = -0.195024830743909  LUMO = -0.189981454751417
cycle= 76 E= -4153.93174971841  delta_E= 0.000551  |g|= 0.122  |ddm|=  1.3
  HOMO = -0.195099218756108  LUMO = -0.190070377872819
cycle= 77 E= -4153.93174312528  delta_E= 6.59e-06  |g|= 0.122  |ddm|= 0.00359
  HOMO = -0.195236993515769  LUMO = -0.188850887894165
cycle= 78 E= -4153.93048421683  delta_E= 0.00126  |g|= 0.134  |ddm|= 0.0887
  HOMO = -0.193908342493257  LUMO = -0.189061374873722
cycle= 79 E= -4153.9324170701  delta_E= -0.00193  |g|= 0.117  |ddm|= 0.129
  HOMO = -0.195062586571589  LUMO = -0.191845691289231
cycle= 80 E= -4153.9332185576  delta_E= -0.000801  |g|= 0.106  |ddm|= 0.0843

WARN: HOMO -0.193423749930032 == LUMO -0.192888307916475

cycle= 81 E= -4153.92694780136  delta_E= 0.00627  |g|= 0.145  |ddm|= 1.33

WARN: HOMO -0.193268841056587 == LUMO -0.193064230877831

cycle= 82 E= -4153.92744143601  delta_E= -0.000494  |g|= 0.14  |ddm|= 0.0598
  HOMO = -0.194040130229561  LUMO = -0.192277044371579
cycle= 83 E= -4153.93641131911  delta_E= -0.00897  |g|= 0.0803  |ddm|= 1.31

WARN: HOMO -0.193070433594561 == LUMO -0.192456486566727

cycle= 84 E= -4153.92828867142  delta_E= 0.00812  |g|= 0.14  |ddm|= 1.33

WARN: HOMO -0.192951007041443 == LUMO -0.192714834568502

cycle= 85 E= -4153.9297085389  delta_E= -0.00142  |g|= 0.127  |ddm|= 0.131
  HOMO = -0.192900524851032  LUMO = -0.191127077671222
cycle= 86 E= -4153.93491310672  delta_E= -0.0052  |g|= 0.0947  |ddm|= 1.18
  HOMO = -0.193279210668335  LUMO = -0.192113141239156
cycle= 87 E= -4153.93617071902  delta_E= -0.00126  |g|= 0.0829  |ddm|= 0.581

WARN: HOMO -0.193338012610822 == LUMO -0.193188456167542

cycle= 88 E= -4153.93042588248  delta_E= 0.00574  |g|= 0.116  |ddm|= 1.32
  HOMO = -0.19261328806523  LUMO = -0.190891475860147
cycle= 89 E= -4153.93441953846  delta_E= -0.00399  |g|= 0.0939  |ddm|= 1.33

WARN: HOMO -0.192007025340134 == LUMO -0.191057627854012

cycle= 90 E= -4153.9364138685  delta_E= -0.00199  |g|= 0.0836  |ddm|= 0.457

WARN: HOMO -0.192221829078772 == LUMO -0.191852447455593

cycle= 91 E= -4153.93212144707  delta_E= 0.00429  |g|= 0.102  |ddm|= 1.32
  HOMO = -0.194007029180851  LUMO = -0.190698521193007
cycle= 92 E= -4153.93457317893  delta_E= -0.00245  |g|= 0.104  |ddm|= 1.27
  HOMO = -0.192331277728953  LUMO = -0.191295915683521
cycle= 93 E= -4153.93617493206  delta_E= -0.0016  |g|= 0.0866  |ddm|= 0.139

WARN: HOMO -0.193740321598802 == LUMO -0.193413940794927

cycle= 94 E= -4153.93422749351  delta_E= 0.00195  |g|= 0.0927  |ddm|= 1.28

WARN: HOMO -0.193786058465056 == LUMO -0.19360613251725

cycle= 95 E= -4153.93684614099  delta_E= -0.00262  |g|= 0.0734  |ddm|= 0.84

WARN: HOMO -0.194547428306532 == LUMO -0.193835396183024

cycle= 96 E= -4153.93641730839  delta_E= 0.000429  |g|= 0.0807  |ddm|= 0.84

WARN: HOMO -0.194582929279259 == LUMO -0.194441040568187

cycle= 97 E= -4153.93033646074  delta_E= 0.00608  |g|= 0.114  |ddm|= 1.15

WARN: HOMO -0.194668380121832 == LUMO -0.194354707608856

cycle= 98 E= -4153.93223249644  delta_E= -0.0019  |g|= 0.104  |ddm|= 0.36

WARN: HOMO -0.194563787142755 == LUMO -0.194183422834801

cycle= 99 E= -4153.93232191608  delta_E= -8.94e-05  |g|= 0.102  |ddm|= 0.267

WARN: HOMO -0.194503857056492 == LUMO -0.193924938850027

cycle= 100 E= -4153.92951427255  delta_E= 0.00281  |g|= 0.12  |ddm|= 0.593
  HOMO = -0.193124760106118  LUMO = -0.19125573028737
cycle= 101 E= -4153.93732704552  delta_E= -0.00781  |g|= 0.0732  |ddm|= 1.22

WARN: HOMO -0.19287634709835 == LUMO -0.192440239045406

cycle= 102 E= -4153.93607964391  delta_E= 0.00125  |g|= 0.0816  |ddm|= 0.592

WARN: HOMO -0.192863586637456 == LUMO -0.192415046605297

cycle= 103 E= -4153.93618787356  delta_E= -0.000108  |g|= 0.0814  |ddm|= 0.0439
  HOMO = -0.193024879760309  LUMO = -0.191472544412235
cycle= 104 E= -4153.93649180815  delta_E= -0.000304  |g|= 0.0854  |ddm|= 1.15

WARN: HOMO -0.193338139530219 == LUMO -0.192547303760267

cycle= 105 E= -4153.93641993233  delta_E= 7.19e-05  |g|= 0.08  |ddm|= 0.871

WARN: HOMO -0.193006502243643 == LUMO -0.192910584578287

cycle= 106 E= -4153.93179648588  delta_E= 0.00462  |g|= 0.102  |ddm|= 1.14

WARN: HOMO -0.193046440171656 == LUMO -0.192901436066905

cycle= 107 E= -4153.93680479793  delta_E= -0.00501  |g|= 0.0731  |ddm|= 1.14

WARN: HOMO -0.193632014774895 == LUMO -0.192962720689197

cycle= 108 E= -4153.93696730787  delta_E= -0.000163  |g|= 0.0692  |ddm|= 1.22

WARN: HOMO -0.193629005203214 == LUMO -0.193193440772855

cycle= 109 E= -4153.93695897307  delta_E= 8.33e-06  |g|= 0.0749  |ddm|= 1.27

WARN: HOMO -0.193623688850041 == LUMO -0.192832269399979

cycle= 110 E= -4153.93730550063  delta_E= -0.000347  |g|= 0.0739  |ddm|= 0.519

WARN: HOMO -0.193757430662473 == LUMO -0.192759273129363

cycle= 111 E= -4153.93576578727  delta_E= 0.00154  |g|= 0.0849  |ddm|=  0.5
  HOMO = -0.193685459748202  LUMO = -0.19260387884153
cycle= 112 E= -4153.93550053806  delta_E= 0.000265  |g|= 0.0872  |ddm|= 0.0799
  HOMO = -0.193734733740446  LUMO = -0.192586951561545
cycle= 113 E= -4153.93545919701  delta_E= 4.13e-05  |g|= 0.0876  |ddm|= 0.0196

WARN: HOMO -0.193193395072332 == LUMO -0.192470633512047

cycle= 114 E= -4153.93580802417  delta_E= -0.000349  |g|= 0.0853  |ddm|= 0.36
  HOMO = -0.193977846746998  LUMO = -0.192449266468894
cycle= 115 E= -4153.93116907891  delta_E= 0.00464  |g|= 0.112  |ddm|=  1.1
  HOMO = -0.193685581456775  LUMO = -0.192297046699755
cycle= 116 E= -4153.93249701209  delta_E= -0.00133  |g|= 0.103  |ddm|= 0.834
  HOMO = -0.192867119799745  LUMO = -0.191622396783865
cycle= 117 E= -4153.93699229422  delta_E= -0.0045  |g|= 0.0788  |ddm|= 1.25
  HOMO = -0.193292828001634  LUMO = -0.192168344011339
cycle= 118 E= -4153.93739823573  delta_E= -0.000406  |g|= 0.0718  |ddm|= 1.18

WARN: HOMO -0.193240181798948 == LUMO -0.192434218745926

cycle= 119 E= -4153.93687756703  delta_E= 0.000521  |g|= 0.0767  |ddm|= 0.918

WARN: HOMO -0.193117147970734 == LUMO -0.192641253563317

cycle= 120 E= -4153.9360334281  delta_E= 0.000844  |g|= 0.0802  |ddm|= 1.13
SCF not converged.
SCF energy = -4153.9360334281
Electronic spatial extent <R**2> (au): 339.6087
* Multipoles in the independent field-basis, Gauge -> (0,0,0)
Electronic Dipole moment(X, Y, Z, Debye): -0.1834, -0.9044, -0.0825
Nuclear Dipole moment(X, Y, Z, Debye): 0.0000, 0.0000, 0.0000
Total Dipole moment(X, Y, Z, Debye): 0.1834, 0.9044, 0.0825
Quadrupole moments (Debye-Angs)
Total Quadrupole moments (XX, YY, ZZ): -37.7652, -37.0375, -24.1859
Total Quadrupole moments (XY, XZ, YZ): 0.1278, -0.0006, -0.0016
Octupole moments (Debye-Angs**2)
Total Octupole moments (XXX, YYY, ZZZ, XYY): 0.4553, 2.2277, 0.2486, 0.1506
Total Octupole moments (XXY, XXZ, XZZ, YZZ): 0.7437, 0.0641, 1.0999, 5.9452
Total Octupole moments (YYZ, XYZ): 0.0617, 0.0006
Hexadecapole moments (Debye-Angs**3)
Total Hexadecapole moments (XXXX, YYYY, ZZZZ, XXXY): -67.7269, -64.8816, -225.8563, 0.1927
Total Hexadecapole moments (XXXZ, YYYX, YYYZ, ZZZX): -0.0016, 0.1894, -0.0041, -0.0052
Total Hexadecapole moments (ZZZY, XXYY, XXZZ, YYZZ): -0.0190, -22.1085, -54.6664, -53.6364
Total Hexadecapole moments (XXYZ, YYXZ, ZZXY): -0.0011, -0.0000, 0.1950
