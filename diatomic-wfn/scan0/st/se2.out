#INFO: **** input file is /home/jluis/src/git/db/diatomic-wfn/scan0/run_sp.py ****
#!/usr/bin/env python

import numpy, sys, os
from pyscf import lib, gto, scf, dft
from pyscf.tools import molden
from pyscf.data import radii

def read_molecule(path):

    charge = spin = 0
    with open(path, 'r') as myfile:
        output = myfile.read()
        output = output.lstrip()
        output = output.rstrip()
        output = output.split('\n')

    try:
        int(output[0])
    except ValueError:
        try:
            charge = int(output[0].split(' ')[0])
            spin = int(output[0].split(' ')[1]) - 1
        except ValueError:
            molecule = output
        else:
            molecule = '\n'.join(output[1:])
    else:
        if int(output[0]) == len(output) - 2:
            molecule = '\n'.join(output[2:])
            try:
                charge = int(output[1].split(' ')[0])
                spin = int(output[1].split(' ')[1])-1
            except ValueError:
                pass
        else:
            print "THIS IS NOT A VALID XYZ FILE"

    return (molecule, charge, spin)

directory = '../../diatomic/'
files = [i for i in os.listdir(directory) if i.endswith('.xyz')]

for filename in files:

    name = filename[:-8]
    mol = gto.Mole()
    (mol.atom, charge, spin) = read_molecule(directory+filename)
    mol.basis = 'aug-cc-pvtz'
    mol.charge = charge
    mol.spin = spin
    mol.output = name+'.out'
    mol.symmetry = 0
    mol.verbose = 4
    mol.build()

    mf = dft.RKS(mol) 
    mf.xc = 'scan0'
    mf.grids.level = 4
    mf.max_cycle = 120
    mf.chkfile = name+'.chk'
    mf = scf.addons.remove_linear_dep_(mf)
    #mf = mf.newton()
    mf.kernel()
    #
    #stable_cyc = 3
    #for i in range(stable_cyc):
    #    new_mo_coeff = mf.stability(internal=True, external=False)[0]
    #    if numpy.linalg.norm(numpy.array(new_mo_coeff) - numpy.array(mf.mo_coeff)) < 10**-8:
    #        lib.logger.info(mf,"* The molecule is stable")
    #        break
    #    else:
    #        lib.logger.info(mf,"* The molecule is unstable")
    #        n_alpha = numpy.count_nonzero(mf.mo_occ)
    #        P_alpha = 2.0*numpy.dot(new_mo_coeff[:, :n_alpha], new_mo_coeff.T[:n_alpha])
    #        mf.kernel(dm0=(P_alpha))
    #        lib.logger.info(mf,"* Updated SCF energy and orbitals: %.6f" % mf.e_tot)
    #
    dm = mf.make_rdm1()
    nao = mol.nao_nr()
    unit = 2.541746
    origin = ([0.0,0.0,0.0])
    charges = mol.atom_charges()
    coords  = mol.atom_coords()
    mol.set_common_orig(origin)
    r2 = mol.intor_symmetric('int1e_r2')
    r2 = numpy.einsum('ij,ji->', r2, dm)
    lib.logger.info(mf,'Electronic spatial extent <R**2> (au): %.4f', r2)

    lib.logger.info(mf,'* Multipoles in the independent field-basis, Gauge -> (0,0,0)')
    ao_dip = mol.intor_symmetric('int1e_r', comp=3)
    el_dip = numpy.einsum('xij,ji->x', ao_dip, dm)
    lib.logger.info(mf,'Electronic Dipole moment(X, Y, Z, Debye): %.4f, %.4f, %.4f', *el_dip*unit)
    nucl_dip = numpy.einsum('i,ix->x', charges, coords)
    lib.logger.info(mf,'Nuclear Dipole moment(X, Y, Z, Debye): %.4f, %.4f, %.4f', *nucl_dip*unit)
    mol_dip = (nucl_dip - el_dip) * unit
    lib.logger.info(mf,'Total Dipole moment(X, Y, Z, Debye): %.4f, %.4f, %.4f', *mol_dip)

    lib.logger.info(mf,'Quadrupole moments (Debye-Angs)')
    rr = mol.intor_symmetric('int1e_rr', comp=9).reshape(3,3,nao,nao)
    rr = -1.0*numpy.einsum('xyij,ji->xy', rr, dm)
    rr += numpy.einsum('z,zx,zy->xy', charges, coords, coords)
    rr = rr*unit*lib.param.BOHR
    lib.logger.info(mf,'Total Quadrupole moments (XX, YY, ZZ): %.4f, %.4f, %.4f', \
    rr[0,0], rr[1,1], rr[2,2])
    lib.logger.info(mf,'Total Quadrupole moments (XY, XZ, YZ): %.4f, %.4f, %.4f', \
    rr[0,1], rr[0,2], rr[1,2])
 
    lib.logger.info(mf,'Octupole moments (Debye-Angs**2)')
    rrr = mol.intor_symmetric('int1e_rrr', comp=27).reshape(3,3,3,nao,nao)
    rrr = -1.0*numpy.einsum('xyzij,ji->xyz', rrr, dm)
    rrr += numpy.einsum('z,zx,zy,zk->xyk', charges, coords, coords, coords)
    rrr = rrr*unit*lib.param.BOHR**2
    lib.logger.info(mf,'Total Octupole moments (XXX, YYY, ZZZ, XYY): %.4f, %.4f, %.4f, %.4f', \
    rrr[0,0,0], rrr[1,1,1], rrr[2,2,2], rrr[0,1,1])
    lib.logger.info(mf,'Total Octupole moments (XXY, XXZ, XZZ, YZZ): %.4f, %.4f, %.4f, %.4f', \
    rrr[0,0,1], rrr[0,0,2], rrr[0,2,2], rrr[1,2,2])
    lib.logger.info(mf,'Total Octupole moments (YYZ, XYZ): %.4f, %.4f', rrr[1,1,2], rrr[0,1,2])

    lib.logger.info(mf,'Hexadecapole moments (Debye-Angs**3)')
    rrrr = mol.intor_symmetric('int1e_rrrr', comp=81).reshape(3,3,3,3,nao,nao)
    rrrr = -1.0*numpy.einsum('xyzwij,ji->xyzw', rrrr, dm)
    rrrr += numpy.einsum('z,zx,zy,zk,zw->xykw', charges, coords, coords, coords, coords)
    rrrr = rrrr*unit*lib.param.BOHR**3
    lib.logger.info(mf,'Total Hexadecapole moments (XXXX, YYYY, ZZZZ, XXXY): %.4f, %.4f, %.4f, %.4f', \
    rrrr[0,0,0,0], rrrr[1,1,1,1], rrrr[2,2,2,2], rrrr[0,0,0,1])
    lib.logger.info(mf,'Total Hexadecapole moments (XXXZ, YYYX, YYYZ, ZZZX): %.4f, %.4f, %.4f, %.4f', \
    rrrr[0,0,0,2], rrrr[1,1,1,0], rrrr[1,1,1,2], rrrr[2,2,2,0])
    lib.logger.info(mf,'Total Hexadecapole moments (ZZZY, XXYY, XXZZ, YYZZ): %.4f, %.4f, %.4f, %.4f', \
    rrrr[2,2,2,1], rrrr[0,0,1,1], rrrr[0,0,2,2], rrrr[1,1,2,2])
    lib.logger.info(mf,'Total Hexadecapole moments (XXYZ, YYXZ, ZZXY): %.4f, %.4f, %.4f', \
    rrrr[0,0,1,2], rrrr[1,1,0,2], rrrr[2,2,0,1])
     
    coeff = mf.mo_coeff[:,mf.mo_occ>0]
    occ = mf.mo_occ[mf.mo_occ>0]
    energy = mf.mo_energy[mf.mo_occ>0]
    den_file = name+'.mol'
    fspt = open(den_file,'w')
    molden.header(mol, fspt)
    molden.orbital_coeff(mol, fspt, coeff, ene=energy, occ=occ) 
    fspt.close()                    
    cmd = '/home/jluis/bin/molden2aim '+name
    os.system(cmd)
    den_file = name+'.wfn'
    fspt = open(den_file,'a')
    fspt.write('RHF\n')
    fspt.close()                    

    pmd_file = name+'.pmd'
    fspt = open(pmd_file,'w')
    fspt.write('%s.wfn\n' % (name))
    if (mol.symmetry == False):
        fspt.write('nosymmetry\n')
    fspt.write('tes\n')
    fspt.write('  epsiscp 0.220\n')
    fspt.write('  radialquad 7\n')
    fspt.write('  rmapping 2\n')
    fspt.write('  lmax 10\n')
    fspt.write('  nr 551\n')
    fspt.write('  lebedev 5810\n')
    fspt.write('  betasphere\n')
    for ia in range(mol.natm):
        symb = mol.atom_pure_symbol(ia)
        inuc = lib.parameters.NUC[symb]
        betarad = radii.COVALENT[inuc]/3.5
        fspt.write('  betaradw %d %1.3f\n' % ((ia+1),betarad))
    fspt.write('  radialquadbeta 7\n')
    fspt.write('  rmappingbeta 3\n')
    fspt.write('  lmaxbeta 8\n')
    fspt.write('  nrb 451\n')
    fspt.write('  lebedevbeta 3074\n')
    fspt.write('  dafh\n')
    fspt.write('endtes')
    fspt.close()                    

    cmd = 'rm '+name+'.mol'
    os.system(cmd)
#INFO: ******************** input file end ********************


System: ('Linux', 'silicio', '3.16.0-4-amd64', '#1 SMP Debian 3.16.51-3 (2017-12-13)', 'x86_64', '')  Threads 12
Python 2.7.14 (default, Apr  9 2018, 16:34:43) 
[GCC 7.3.0]
numpy 1.14.2  scipy 1.0.1
Date: Fri Jun 29 23:20:44 2018
PySCF version 1.5
PySCF path  /home/jluis/src/pyscf/pyscf
GIT ORIG_HEAD f2dbb26d09ae5148fbf5975669a994500ac7a4c9
GIT HEAD      ref: refs/heads/master
GIT master branch  f2dbb26d09ae5148fbf5975669a994500ac7a4c9

[ENV] PYSCF_TMPDIR /scratch-ssd/jluis
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 68
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry 0 subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 Se     0.000000000000   0.000000000000   1.082168000000 AA    0.000000000000   0.000000000000   2.045001140768 Bohr
[INPUT]  2 Se     0.000000000000   0.000000000000  -1.082168000000 AA    0.000000000000   0.000000000000  -2.045001140768 Bohr

nuclear repulsion = 282.64042913093
number of shells = 28
number of NR pGTOs = 254
number of NR cGTOs = 118
basis = aug-cc-pvtz
ecp = {}
CPU time:      1015.60


******** <class 'pyscf.dft.rks.RKS'> flags ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
DIIS start cycle = 1
DIIS space = 8
SCF tol = 1e-09
SCF gradient tol = None
max. SCF cycles = 120
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = se2.chk
max_memory 64000 MB (current use 148 MB)
XC functionals = scan0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs (JCP 102, 346 (M4)) radial grids
    
becke partition: Becke, JCP, 88, 2547 (1988)
pruning grids: <function nwchem_prune at 0x2af83f16e5f0>
grids dens level: 4
symmetrized grids: 0
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2af83f16e500>
Set gradient conv threshold to 3.16228e-05
tot grids = 61836
init E= -4801.48010041115

WARN: HOMO -0.218070157130865 == LUMO -0.218070157130859

cycle= 1 E= -4803.04753197147  delta_E= -1.57  |g|= 0.246  |ddm|= 2.17
  HOMO = -0.227086804813717  LUMO = -0.179803464169499
cycle= 2 E= -4803.05263414748  delta_E= -0.0051  |g|= 0.148  |ddm|= 0.31
  HOMO = -0.22109566918989  LUMO = -0.170552758326944
cycle= 3 E= -4803.05433168558  delta_E= -0.0017  |g|= 0.0257  |ddm|= 0.129
  HOMO = -0.224398102579267  LUMO = -0.172526473508228
cycle= 4 E= -4803.05440014152  delta_E= -6.85e-05  |g|= 0.00311  |ddm|= 0.0213
  HOMO = -0.224093733417903  LUMO = -0.172134733619661
cycle= 5 E= -4803.05440317055  delta_E= -3.03e-06  |g|= 0.000893  |ddm|= 0.00468
  HOMO = -0.224113495011233  LUMO = -0.172134538260859
cycle= 6 E= -4803.05440346652  delta_E= -2.96e-07  |g|= 7.23e-05  |ddm|= 0.00167
  HOMO = -0.224137445709121  LUMO = -0.172156772936379
cycle= 7 E= -4803.0544034736  delta_E= -7.08e-09  |g|= 2.76e-05  |ddm|= 0.000406
  HOMO = -0.22413572496604  LUMO = -0.172154728342224
cycle= 8 E= -4803.05440347763  delta_E= -4.04e-09  |g|= 2.53e-05  |ddm|= 0.00025
  HOMO = -0.224136175996839  LUMO = -0.172155235970484
cycle= 9 E= -4803.05440348206  delta_E= -4.42e-09  |g|= 2.52e-05  |ddm|= 0.000277
  HOMO = -0.224136309198157  LUMO = -0.172155368817978
cycle= 10 E= -4803.05440349375  delta_E= -1.17e-08  |g|= 2.51e-05  |ddm|= 0.000734
  HOMO = -0.224170449311774  LUMO = -0.172119397470611
cycle= 11 E= -4803.05440411672  delta_E= -6.23e-07  |g|= 0.000139  |ddm|= 0.0465
  HOMO = -0.224145759103812  LUMO = -0.172144221145085
cycle= 12 E= -4803.05440386606  delta_E= 2.51e-07  |g|= 4.6e-05  |ddm|= 0.0211
  HOMO = -0.224301295155701  LUMO = -0.171991507831312
cycle= 13 E= -4803.0544046209  delta_E= -7.55e-07  |g|= 0.000647  |ddm|= 0.0765
  HOMO = -0.224248097810657  LUMO = -0.172043169197916
cycle= 14 E= -4803.05440448129  delta_E= 1.4e-07  |g|= 0.000442  |ddm|= 0.0175
  HOMO = -0.224217664448321  LUMO = -0.172074371105133
cycle= 15 E= -4803.05440437174  delta_E= 1.1e-07  |g|= 0.000321  |ddm|= 0.0122
  HOMO = -0.224238202458784  LUMO = -0.172054927853526
cycle= 16 E= -4803.05440445348  delta_E= -8.17e-08  |g|= 0.0004  |ddm|= 0.00881
  HOMO = -0.224211800205549  LUMO = -0.172078843944218
cycle= 17 E= -4803.05440439067  delta_E= 6.28e-08  |g|= 0.000302  |ddm|= 0.00756
  HOMO = -0.224231769240995  LUMO = -0.172059404627653
cycle= 18 E= -4803.05440447088  delta_E= -8.02e-08  |g|= 0.000379  |ddm|= 0.00851
  HOMO = -0.224138806477099  LUMO = -0.172150637953335
cycle= 19 E= -4803.05440367402  delta_E= 7.97e-07  |g|= 3.01e-05  |ddm|= 0.0702
  HOMO = -0.22415785583487  LUMO = -0.172134404495885
cycle= 20 E= -4803.05440322398  delta_E= 4.5e-07  |g|= 9.46e-05  |ddm|= 0.0279
  HOMO = -0.224321813815475  LUMO = -0.171972873126522
cycle= 21 E= -4803.05440479146  delta_E= -1.57e-06  |g|= 0.000721  |ddm|= 0.134
  HOMO = -0.224320252097442  LUMO = -0.171974403168651
cycle= 22 E= -4803.05440478735  delta_E= 4.11e-09  |g|= 0.000715  |ddm|= 0.000552
  HOMO = -0.224402441238545  LUMO = -0.17189329874121
cycle= 23 E= -4803.05440486438  delta_E= -7.7e-08  |g|= 0.00103  |ddm|= 0.0216
  HOMO = -0.224263629544703  LUMO = -0.17202958499723
cycle= 24 E= -4803.05440465624  delta_E= 2.08e-07  |g|= 0.000498  |ddm|= 0.0389
  HOMO = -0.224209814887785  LUMO = -0.172082737955478
cycle= 25 E= -4803.05440445157  delta_E= 2.05e-07  |g|= 0.000289  |ddm|= 0.0214
  HOMO = -0.224367397153128  LUMO = -0.171926055424388
cycle= 26 E= -4803.05440494672  delta_E= -4.95e-07  |g|= 0.0009  |ddm|= 0.0595
  HOMO = -0.224193706666463  LUMO = -0.172093820852879
cycle= 27 E= -4803.05440458294  delta_E= 3.64e-07  |g|= 0.00024  |ddm|= 0.0494
  HOMO = -0.224254861210035  LUMO = -0.172034704177687
cycle= 28 E= -4803.05440476884  delta_E= -1.86e-07  |g|= 0.000472  |ddm|= 0.0192
  HOMO = -0.224136361039173  LUMO = -0.172152569053831
cycle= 29 E= -4803.05440411614  delta_E= 6.53e-07  |g|= 2.98e-05  |ddm|= 0.0619
  HOMO = -0.224136901670743  LUMO = -0.172152575828637
cycle= 30 E= -4803.05440406096  delta_E= 5.52e-08  |g|= 2.8e-05  |ddm|= 0.00479
  HOMO = -0.22416777466779  LUMO = -0.172120233156758
cycle= 31 E= -4803.05440439629  delta_E= -3.35e-07  |g|= 0.000136  |ddm|= 0.0306
  HOMO = -0.224274660417153  LUMO = -0.172013205678276
cycle= 32 E= -4803.05440491868  delta_E= -5.22e-07  |g|= 0.000556  |ddm|= 0.0499
  HOMO = -0.224273385662936  LUMO = -0.172014622011742
cycle= 33 E= -4803.05440490656  delta_E= 1.21e-08  |g|= 0.000551  |ddm|= 0.0011
  HOMO = -0.224189878851304  LUMO = -0.172098975273477
cycle= 34 E= -4803.05440452065  delta_E= 3.86e-07  |g|= 0.00022  |ddm|= 0.0373
  HOMO = -0.224145458367945  LUMO = -0.172145760374316
cycle= 35 E= -4803.05440406964  delta_E= 4.51e-07  |g|= 4.12e-05  |ddm|= 0.0413
  HOMO = -0.22421708915984  LUMO = -0.172072947503568
cycle= 36 E= -4803.05440482782  delta_E= -7.58e-07  |g|= 0.000322  |ddm|= 0.0673
  HOMO = -0.224408861379  LUMO = -0.171885666613833
cycle= 37 E= -4803.05440529606  delta_E= -4.68e-07  |g|= 0.00105  |ddm|= 0.0716
  HOMO = -0.224153172427852  LUMO = -0.17213459676636
cycle= 38 E= -4803.05440417782  delta_E= 1.12e-06  |g|= 8.79e-05  |ddm|= 0.129
  HOMO = -0.224127758096133  LUMO = -0.172160337020661
cycle= 39 E= -4803.05440421784  delta_E= -4e-08  |g|= 4.43e-05  |ddm|= 0.00346
  HOMO = -0.224103891468241  LUMO = -0.172185200707281
cycle= 40 E= -4803.05440406814  delta_E= 1.5e-07  |g|= 0.000127  |ddm|= 0.0129
  HOMO = -0.224114398066524  LUMO = -0.172175628118996
cycle= 41 E= -4803.05440395831  delta_E= 1.1e-07  |g|= 8.81e-05  |ddm|= 0.00937
  HOMO = -0.224128895524198  LUMO = -0.172161846432425
cycle= 42 E= -4803.0544041527  delta_E= -1.94e-07  |g|= 3.9e-05  |ddm|= 0.0164
  HOMO = -0.224201132929936  LUMO = -0.172090601584319
cycle= 43 E= -4803.05440383332  delta_E= 3.19e-07  |g|= 0.000263  |ddm|= 0.0244
  HOMO = -0.224422470871425  LUMO = -0.171871518964568
cycle= 44 E= -4803.05440526425  delta_E= -1.43e-06  |g|= 0.00111  |ddm|= 0.157
  HOMO = -0.224419896304025  LUMO = -0.171873725473137
cycle= 45 E= -4803.05440519416  delta_E= 7.01e-08  |g|= 0.0011  |ddm|= 0.00834
  HOMO = -0.224396460135587  LUMO = -0.171896392633942
cycle= 46 E= -4803.05440528497  delta_E= -9.08e-08  |g|= 0.00101  |ddm|= 0.00255
  HOMO = -0.224413320916959  LUMO = -0.171879702241877
cycle= 47 E= -4803.05440533558  delta_E= -5.06e-08  |g|= 0.00107  |ddm|= 0.0111
  HOMO = -0.224327819964295  LUMO = -0.171966022350625
cycle= 48 E= -4803.05440496263  delta_E= 3.73e-07  |g|= 0.000744  |ddm|= 0.0551
  HOMO = -0.22411306632627  LUMO = -0.172177527082421
cycle= 49 E= -4803.05440427215  delta_E= 6.9e-07  |g|= 9.42e-05  |ddm|= 0.0717
  HOMO = -0.224074935234702  LUMO = -0.1722133345639
cycle= 50 E= -4803.05440461486  delta_E= -3.43e-07  |g|= 0.00024  |ddm|= 0.031
  HOMO = -0.224224813670884  LUMO = -0.172068170117354
cycle= 51 E= -4803.05440291795  delta_E= 1.7e-06  |g|= 0.00036  |ddm|= 0.122
  HOMO = -0.224090954908246  LUMO = -0.172198037162859
cycle= 52 E= -4803.05440404846  delta_E= -1.13e-06  |g|= 0.000176  |ddm|= 0.0721
  HOMO = -0.224225190056421  LUMO = -0.172069312776873
cycle= 53 E= -4803.05440287711  delta_E= 1.17e-06  |g|= 0.000356  |ddm|= 0.0745
  HOMO = -0.224127815776299  LUMO = -0.172161543529793
cycle= 54 E= -4803.05440444373  delta_E= -1.57e-06  |g|= 3.92e-05  |ddm|= 0.109
  HOMO = -0.224146962124021  LUMO = -0.172143829150161
cycle= 55 E= -4803.05440419407  delta_E= 2.5e-07  |g|= 4.83e-05  |ddm|= 0.0224
  HOMO = -0.22421818910085  LUMO = -0.172074298964151
cycle= 56 E= -4803.0544040437  delta_E= 1.5e-07  |g|= 0.000321  |ddm|= 0.0102
  HOMO = -0.224216240411557  LUMO = -0.172075056385899
cycle= 57 E= -4803.05440468778  delta_E= -6.44e-07  |g|= 0.000314  |ddm|= 0.0555
  HOMO = -0.224183702850012  LUMO = -0.172107867448459
cycle= 58 E= -4803.05440418472  delta_E= 5.03e-07  |g|= 0.000187  |ddm|= 0.0451
  HOMO = -0.224288974802849  LUMO = -0.172003688297644
cycle= 59 E= -4803.05440504043  delta_E= -8.56e-07  |g|= 0.000592  |ddm|= 0.0794
  HOMO = -0.224192879923107  LUMO = -0.172098449410588
cycle= 60 E= -4803.05440467175  delta_E= 3.69e-07  |g|= 0.000222  |ddm|= 0.037
  HOMO = -0.22419131736404  LUMO = -0.172099909716332
cycle= 61 E= -4803.05440468269  delta_E= -1.09e-08  |g|= 0.000216  |ddm|= 0.000792
  HOMO = -0.22413788718963  LUMO = -0.172153742834615
cycle= 62 E= -4803.0544040014  delta_E= 6.81e-07  |g|= 2.68e-05  |ddm|= 0.0602
  HOMO = -0.224692841223905  LUMO = -0.17161931527112
cycle= 63 E= -4803.05439956961  delta_E= 4.43e-06  |g|= 0.00215  |ddm|= 0.168
  HOMO = -0.224546533454639  LUMO = -0.17176091286682
cycle= 64 E= -4803.05440070894  delta_E= -1.14e-06  |g|= 0.00159  |ddm|= 0.0241
  HOMO = -0.224622797894549  LUMO = -0.171689142505235
cycle= 65 E= -4803.05439992413  delta_E= 7.85e-07  |g|= 0.00188  |ddm|= 0.026
  HOMO = -0.224231152338753  LUMO = -0.1720598303451
cycle= 66 E= -4803.05440438307  delta_E= -4.46e-06  |g|= 0.000373  |ddm|= 0.208
  HOMO = -0.224290516704462  LUMO = -0.172001981406679
cycle= 67 E= -4803.05440498613  delta_E= -6.03e-07  |g|= 0.000597  |ddm|= 0.0541
  HOMO = -0.224211595303956  LUMO = -0.172079634603853
cycle= 68 E= -4803.05440471872  delta_E= 2.67e-07  |g|= 0.000294  |ddm|= 0.0281
  HOMO = -0.224249639162998  LUMO = -0.172042730283778
cycle= 69 E= -4803.05440462539  delta_E= 9.33e-08  |g|= 0.000442  |ddm|= 0.00435
  HOMO = -0.22429965386632  LUMO = -0.171992840297736
cycle= 70 E= -4803.05440482742  delta_E= -2.02e-07  |g|= 0.000635  |ddm|= 0.0213
  HOMO = -0.224241452966864  LUMO = -0.172050486765967
cycle= 71 E= -4803.05440478653  delta_E= 4.09e-08  |g|= 0.00041  |ddm|= 0.00951
  HOMO = -0.224103869810124  LUMO = -0.172187724521692
cycle= 72 E= -4803.0544050951  delta_E= -3.09e-07  |g|= 0.000137  |ddm|= 0.0199
  HOMO = -0.224087431605696  LUMO = -0.17220696764777
cycle= 73 E= -4803.05440557866  delta_E= -4.84e-07  |g|= 0.000214  |ddm|= 0.0439
  HOMO = -0.224082877456525  LUMO = -0.172209562417842
cycle= 74 E= -4803.05440513724  delta_E= 4.41e-07  |g|= 0.000221  |ddm|= 0.0397
  HOMO = -0.224287410448448  LUMO = -0.172011010344756
cycle= 75 E= -4803.05440580944  delta_E= -6.72e-07  |g|= 0.00056  |ddm|= 0.0825
  HOMO = -0.224312749767779  LUMO = -0.17198667047211
cycle= 76 E= -4803.05440580762  delta_E= 1.82e-09  |g|= 0.000656  |ddm|= 0.00737
  HOMO = -0.224277025609155  LUMO = -0.172020866125222
cycle= 77 E= -4803.05440579353  delta_E= 1.41e-08  |g|= 0.00052  |ddm|= 0.0127
  HOMO = -0.224241310639581  LUMO = -0.172054620366657
cycle= 78 E= -4803.05440574632  delta_E= 4.72e-08  |g|= 0.000384  |ddm|= 0.0135
  HOMO = -0.224155528490593  LUMO = -0.172135112890667
cycle= 79 E= -4803.05440533991  delta_E= 4.06e-07  |g|= 6.71e-05  |ddm|= 0.0481
  HOMO = -0.224130468625211  LUMO = -0.172161126370475
cycle= 80 E= -4803.05440526277  delta_E= 7.71e-08  |g|= 3.88e-05  |ddm|= 0.00666
  HOMO = -0.224115438577075  LUMO = -0.172176326018363
cycle= 81 E= -4803.05440526118  delta_E= 1.59e-09  |g|= 9.43e-05  |ddm|= 0.000114
  HOMO = -0.224123630006054  LUMO = -0.172167610810147
cycle= 82 E= -4803.05440544744  delta_E= -1.86e-07  |g|= 6.51e-05  |ddm|= 0.0163
  HOMO = -0.224152015569925  LUMO = -0.172141928047399
cycle= 83 E= -4803.05440579321  delta_E= -3.46e-07  |g|= 4.22e-05  |ddm|= 0.0377
  HOMO = -0.224280657247224  LUMO = -0.172015797488016
cycle= 84 E= -4803.05440604744  delta_E= -2.54e-07  |g|= 0.000527  |ddm|= 0.0618
  HOMO = -0.224286342154663  LUMO = -0.172010136359131
cycle= 85 E= -4803.05440605932  delta_E= -1.19e-08  |g|= 0.000549  |ddm|= 0.00299
  HOMO = -0.224275278849802  LUMO = -0.172020800376241
cycle= 86 E= -4803.05440605644  delta_E= 2.88e-09  |g|= 0.000507  |ddm|= 0.00276
  HOMO = -0.22429383826632  LUMO = -0.172003763970147
cycle= 87 E= -4803.05440608447  delta_E= -2.8e-08  |g|= 0.000576  |ddm|= 0.00767
  HOMO = -0.224322475570311  LUMO = -0.171975841675121
cycle= 88 E= -4803.05440611575  delta_E= -3.13e-08  |g|= 0.000686  |ddm|= 0.00969
  HOMO = -0.224124673175012  LUMO = -0.172167536929314
cycle= 89 E= -4803.05440580689  delta_E= 3.09e-07  |g|= 6.81e-05  |ddm|= 0.0774
  HOMO = -0.224105553466946  LUMO = -0.172185757255094
cycle= 90 E= -4803.05440580206  delta_E= 4.83e-09  |g|= 0.00014  |ddm|= 0.000105
  HOMO = -0.224143342319183  LUMO = -0.172148859558928
cycle= 91 E= -4803.05440589498  delta_E= -9.29e-08  |g|= 1.13e-05  |ddm|= 0.013
  HOMO = -0.22414483698414  LUMO = -0.17214719682338
cycle= 92 E= -4803.05440589229  delta_E= 2.69e-09  |g|= 1.38e-05  |ddm|= 0.000442
  HOMO = -0.224154453158461  LUMO = -0.172139302608975
cycle= 93 E= -4803.05440603783  delta_E= -1.46e-07  |g|= 4.27e-05  |ddm|= 0.028
  HOMO = -0.224134649972073  LUMO = -0.172157877147053
cycle= 94 E= -4803.05440600136  delta_E= 3.65e-08  |g|= 3.45e-05  |ddm|= 0.00752
  HOMO = -0.224197523680889  LUMO = -0.172098059627519
cycle= 95 E= -4803.05440627165  delta_E= -2.7e-07  |g|= 0.000204  |ddm|= 0.0447
  HOMO = -0.224163546958823  LUMO = -0.172128824984081
cycle= 96 E= -4803.05440597008  delta_E= 3.02e-07  |g|= 7.89e-05  |ddm|= 0.0507
  HOMO = -0.224160325636287  LUMO = -0.172132765789352
cycle= 97 E= -4803.05440611134  delta_E= -1.41e-07  |g|= 6.48e-05  |ddm|= 0.0273
  HOMO = -0.224238849021178  LUMO = -0.172059236490412
cycle= 98 E= -4803.05440651159  delta_E= -4e-07  |g|= 0.000359  |ddm|= 0.0506
  HOMO = -0.224156514620498  LUMO = -0.172136848715354
cycle= 99 E= -4803.0544061214  delta_E= 3.9e-07  |g|= 5.02e-05  |ddm|= 0.049
  HOMO = -0.22419352652717  LUMO = -0.172102139822713
cycle= 100 E= -4803.05440636503  delta_E= -2.44e-07  |g|= 0.000188  |ddm|= 0.0314
  HOMO = -0.22414242513509  LUMO = -0.172147289562801
cycle= 101 E= -4803.05440581631  delta_E= 5.49e-07  |g|= 2.61e-05  |ddm|= 0.0863
  HOMO = -0.224205727634218  LUMO = -0.172083842717882
cycle= 102 E= -4803.05440540382  delta_E= 4.12e-07  |g|= 0.000259  |ddm|= 0.0428
  HOMO = -0.224157350720094  LUMO = -0.172132116832257
cycle= 103 E= -4803.0544056352  delta_E= -2.31e-07  |g|= 7.32e-05  |ddm|= 0.0208
  HOMO = -0.224187703763206  LUMO = -0.172103504480449
cycle= 104 E= -4803.05440572802  delta_E= -9.28e-08  |g|= 0.000179  |ddm|= 0.0118
  HOMO = -0.224175224310293  LUMO = -0.172116328216172
cycle= 105 E= -4803.05440582111  delta_E= -9.31e-08  |g|= 0.000129  |ddm|= 0.0116
  HOMO = -0.224181202906653  LUMO = -0.172109866563362
cycle= 106 E= -4803.05440579667  delta_E= 2.44e-08  |g|= 0.000153  |ddm|= 0.00307
  HOMO = -0.224184212967054  LUMO = -0.172108786781301
cycle= 107 E= -4803.05440609397  delta_E= -2.97e-07  |g|= 0.000157  |ddm|= 0.0532
  HOMO = -0.224188177473944  LUMO = -0.17210408688276
cycle= 108 E= -4803.05440596353  delta_E= 1.3e-07  |g|= 0.000175  |ddm|= 0.0252
  HOMO = -0.224182293518714  LUMO = -0.172109405869873
cycle= 109 E= -4803.05440601092  delta_E= -4.74e-08  |g|= 0.000152  |ddm|= 0.00912
  HOMO = -0.224172485740044  LUMO = -0.172119256010061
cycle= 110 E= -4803.05440600647  delta_E= 4.44e-09  |g|= 0.000115  |ddm|= 0.00164
  HOMO = -0.224173274268593  LUMO = -0.172118775986924
cycle= 111 E= -4803.0544060221  delta_E= -1.56e-08  |g|= 0.000117  |ddm|= 0.00324
  HOMO = -0.224169988411675  LUMO = -0.172122301586228
cycle= 112 E= -4803.05440606621  delta_E= -4.41e-08  |g|= 0.000103  |ddm|= 0.00854
  HOMO = -0.224211009149889  LUMO = -0.172085861073823
cycle= 113 E= -4803.05440647481  delta_E= -4.09e-07  |g|= 0.000255  |ddm|= 0.0524
  HOMO = -0.224217379572774  LUMO = -0.172079953993447
cycle= 114 E= -4803.0544065083  delta_E= -3.35e-08  |g|= 0.000278  |ddm|= 0.00367
  HOMO = -0.22415793261551  LUMO = -0.172136860092865
cycle= 115 E= -4803.05440630789  delta_E= 2e-07  |g|= 5.48e-05  |ddm|= 0.0226
  HOMO = -0.224166310383856  LUMO = -0.17212896261743
cycle= 116 E= -4803.05440632427  delta_E= -1.64e-08  |g|= 8.59e-05  |ddm|= 0.00192
  HOMO = -0.224167849165663  LUMO = -0.172127549755509
cycle= 117 E= -4803.05440629902  delta_E= 2.53e-08  |g|= 9.16e-05  |ddm|= 0.00267
  HOMO = -0.224246534046854  LUMO = -0.172050151219716
cycle= 118 E= -4803.05440591788  delta_E= 3.81e-07  |g|= 0.000398  |ddm|= 0.052
  HOMO = -0.224166833711074  LUMO = -0.17212678829021
cycle= 119 E= -4803.05440608826  delta_E= -1.7e-07  |g|= 9.22e-05  |ddm|= 0.0232
  HOMO = -0.224174267305626  LUMO = -0.17212004209184
cycle= 120 E= -4803.05440606673  delta_E= 2.15e-08  |g|= 0.000119  |ddm|= 0.00359
SCF not converged.
SCF energy = -4803.05440606673
Electronic spatial extent <R**2> (au): 363.6746
* Multipoles in the independent field-basis, Gauge -> (0,0,0)
Electronic Dipole moment(X, Y, Z, Debye): -0.0000, 0.0000, 0.0000
Nuclear Dipole moment(X, Y, Z, Debye): 0.0000, 0.0000, 0.0000
Total Dipole moment(X, Y, Z, Debye): 0.0000, -0.0000, -0.0000
Quadrupole moments (Debye-Angs)
Total Quadrupole moments (XX, YY, ZZ): -35.9921, -37.1521, -33.5124
Total Quadrupole moments (XY, XZ, YZ): -2.8339, 0.0000, -0.0000
Octupole moments (Debye-Angs**2)
Total Octupole moments (XXX, YYY, ZZZ, XYY): 0.0000, -0.0000, -0.0000, 0.0000
Total Octupole moments (XXY, XXZ, XZZ, YZZ): -0.0000, -0.0000, 0.0000, -0.0000
Total Octupole moments (YYZ, XYZ): -0.0000, 0.0000
Hexadecapole moments (Debye-Angs**3)
Total Hexadecapole moments (XXXX, YYYY, ZZZZ, XXXY): -47.1633, -50.3237, -275.2153, -3.8894
Total Hexadecapole moments (XXXZ, YYYX, YYYZ, ZZZX): 0.0000, -3.8325, -0.0000, 0.0000
Total Hexadecapole moments (ZZZY, XXYY, XXZZ, YYZZ): -0.0000, -16.1600, -56.5978, -59.3740
Total Hexadecapole moments (XXYZ, YYXZ, ZZXY): -0.0000, 0.0000, -6.7812
