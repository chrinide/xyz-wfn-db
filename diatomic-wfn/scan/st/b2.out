#INFO: **** input file is /home/jluis/src/git/db/diatomic-wfn/scan/run_sp.py ****
#!/usr/bin/env python

import numpy, sys, os
from pyscf import lib, gto, scf, dft
from pyscf.tools import molden
from pyscf.data import radii

def read_molecule(path):

    charge = spin = 0
    with open(path, 'r') as myfile:
        output = myfile.read()
        output = output.lstrip()
        output = output.rstrip()
        output = output.split('\n')

    try:
        int(output[0])
    except ValueError:
        try:
            charge = int(output[0].split(' ')[0])
            spin = int(output[0].split(' ')[1]) - 1
        except ValueError:
            molecule = output
        else:
            molecule = '\n'.join(output[1:])
    else:
        if int(output[0]) == len(output) - 2:
            molecule = '\n'.join(output[2:])
            try:
                charge = int(output[1].split(' ')[0])
                spin = int(output[1].split(' ')[1])-1
            except ValueError:
                pass
        else:
            print "THIS IS NOT A VALID XYZ FILE"

    return (molecule, charge, spin)

directory = '../../diatomic/'
files = [i for i in os.listdir(directory) if i.endswith('.xyz')]

for filename in files:

    name = filename[:-8]
    mol = gto.Mole()
    (mol.atom, charge, spin) = read_molecule(directory+filename)
    mol.basis = 'aug-cc-pvtz'
    mol.charge = charge
    mol.spin = spin
    mol.output = name+'.out'
    mol.symmetry = 0
    mol.verbose = 4
    mol.build()

    mf = dft.RKS(mol) 
    mf.xc = 'scan'
    mf.grids.level = 4
    mf.max_cycle = 120
    mf.chkfile = name+'.chk'
    mf = scf.addons.remove_linear_dep_(mf)
    #mf = mf.newton()
    mf.kernel()
    #
    #stable_cyc = 3
    #for i in range(stable_cyc):
    #    new_mo_coeff = mf.stability(internal=True, external=False)[0]
    #    if numpy.linalg.norm(numpy.array(new_mo_coeff) - numpy.array(mf.mo_coeff)) < 10**-8:
    #        lib.logger.info(mf,"* The molecule is stable")
    #        break
    #    else:
    #        lib.logger.info(mf,"* The molecule is unstable")
    #        n_alpha = numpy.count_nonzero(mf.mo_occ)
    #        P_alpha = 2.0*numpy.dot(new_mo_coeff[:, :n_alpha], new_mo_coeff.T[:n_alpha])
    #        mf.kernel(dm0=(P_alpha))
    #        lib.logger.info(mf,"* Updated SCF energy and orbitals: %.6f" % mf.e_tot)
    #
    dm = mf.make_rdm1()
    nao = mol.nao_nr()
    unit = 2.541746
    origin = ([0.0,0.0,0.0])
    charges = mol.atom_charges()
    coords  = mol.atom_coords()
    mol.set_common_orig(origin)
    r2 = mol.intor_symmetric('int1e_r2')
    r2 = numpy.einsum('ij,ji->', r2, dm)
    lib.logger.info(mf,'Electronic spatial extent <R**2> (au): %.4f', r2)

    lib.logger.info(mf,'* Multipoles in the independent field-basis, Gauge -> (0,0,0)')
    ao_dip = mol.intor_symmetric('int1e_r', comp=3)
    el_dip = numpy.einsum('xij,ji->x', ao_dip, dm)
    lib.logger.info(mf,'Electronic Dipole moment(X, Y, Z, Debye): %.4f, %.4f, %.4f', *el_dip*unit)
    nucl_dip = numpy.einsum('i,ix->x', charges, coords)
    lib.logger.info(mf,'Nuclear Dipole moment(X, Y, Z, Debye): %.4f, %.4f, %.4f', *nucl_dip*unit)
    mol_dip = (nucl_dip - el_dip) * unit
    lib.logger.info(mf,'Total Dipole moment(X, Y, Z, Debye): %.4f, %.4f, %.4f', *mol_dip)

    lib.logger.info(mf,'Quadrupole moments (Debye-Angs)')
    rr = mol.intor_symmetric('int1e_rr', comp=9).reshape(3,3,nao,nao)
    rr = -1.0*numpy.einsum('xyij,ji->xy', rr, dm)
    rr += numpy.einsum('z,zx,zy->xy', charges, coords, coords)
    rr = rr*unit*lib.param.BOHR
    lib.logger.info(mf,'Total Quadrupole moments (XX, YY, ZZ): %.4f, %.4f, %.4f', \
    rr[0,0], rr[1,1], rr[2,2])
    lib.logger.info(mf,'Total Quadrupole moments (XY, XZ, YZ): %.4f, %.4f, %.4f', \
    rr[0,1], rr[0,2], rr[1,2])
 
    lib.logger.info(mf,'Octupole moments (Debye-Angs**2)')
    rrr = mol.intor_symmetric('int1e_rrr', comp=27).reshape(3,3,3,nao,nao)
    rrr = -1.0*numpy.einsum('xyzij,ji->xyz', rrr, dm)
    rrr += numpy.einsum('z,zx,zy,zk->xyk', charges, coords, coords, coords)
    rrr = rrr*unit*lib.param.BOHR**2
    lib.logger.info(mf,'Total Octupole moments (XXX, YYY, ZZZ, XYY): %.4f, %.4f, %.4f, %.4f', \
    rrr[0,0,0], rrr[1,1,1], rrr[2,2,2], rrr[0,1,1])
    lib.logger.info(mf,'Total Octupole moments (XXY, XXZ, XZZ, YZZ): %.4f, %.4f, %.4f, %.4f', \
    rrr[0,0,1], rrr[0,0,2], rrr[0,2,2], rrr[1,2,2])
    lib.logger.info(mf,'Total Octupole moments (YYZ, XYZ): %.4f, %.4f', rrr[1,1,2], rrr[0,1,2])

    lib.logger.info(mf,'Hexadecapole moments (Debye-Angs**3)')
    rrrr = mol.intor_symmetric('int1e_rrrr', comp=81).reshape(3,3,3,3,nao,nao)
    rrrr = -1.0*numpy.einsum('xyzwij,ji->xyzw', rrrr, dm)
    rrrr += numpy.einsum('z,zx,zy,zk,zw->xykw', charges, coords, coords, coords, coords)
    rrrr = rrrr*unit*lib.param.BOHR**3
    lib.logger.info(mf,'Total Hexadecapole moments (XXXX, YYYY, ZZZZ, XXXY): %.4f, %.4f, %.4f, %.4f', \
    rrrr[0,0,0,0], rrrr[1,1,1,1], rrrr[2,2,2,2], rrrr[0,0,0,1])
    lib.logger.info(mf,'Total Hexadecapole moments (XXXZ, YYYX, YYYZ, ZZZX): %.4f, %.4f, %.4f, %.4f', \
    rrrr[0,0,0,2], rrrr[1,1,1,0], rrrr[1,1,1,2], rrrr[2,2,2,0])
    lib.logger.info(mf,'Total Hexadecapole moments (ZZZY, XXYY, XXZZ, YYZZ): %.4f, %.4f, %.4f, %.4f', \
    rrrr[2,2,2,1], rrrr[0,0,1,1], rrrr[0,0,2,2], rrrr[1,1,2,2])
    lib.logger.info(mf,'Total Hexadecapole moments (XXYZ, YYXZ, ZZXY): %.4f, %.4f, %.4f', \
    rrrr[0,0,1,2], rrrr[1,1,0,2], rrrr[2,2,0,1])
     
    coeff = mf.mo_coeff[:,mf.mo_occ>0]
    occ = mf.mo_occ[mf.mo_occ>0]
    energy = mf.mo_energy[mf.mo_occ>0]
    den_file = name+'.mol'
    fspt = open(den_file,'w')
    molden.header(mol, fspt)
    molden.orbital_coeff(mol, fspt, coeff, ene=energy, occ=occ) 
    fspt.close()                    
    cmd = '/home/jluis/bin/molden2aim '+name
    os.system(cmd)
    den_file = name+'.wfn'
    fspt = open(den_file,'a')
    fspt.write('RHF\n')
    fspt.close()                    

    pmd_file = name+'.pmd'
    fspt = open(pmd_file,'w')
    fspt.write('%s.wfn\n' % (name))
    if (mol.symmetry == False):
        fspt.write('nosymmetry\n')
    fspt.write('tes\n')
    fspt.write('  epsiscp 0.220\n')
    fspt.write('  radialquad 7\n')
    fspt.write('  rmapping 2\n')
    fspt.write('  lmax 10\n')
    fspt.write('  nr 551\n')
    fspt.write('  lebedev 5810\n')
    fspt.write('  betasphere\n')
    for ia in range(mol.natm):
        symb = mol.atom_pure_symbol(ia)
        inuc = lib.parameters.NUC[symb]
        betarad = radii.COVALENT[inuc]/3.5
        fspt.write('  betaradw %d %1.3f\n' % ((ia+1),betarad))
    fspt.write('  radialquadbeta 7\n')
    fspt.write('  rmappingbeta 3\n')
    fspt.write('  lmaxbeta 8\n')
    fspt.write('  nrb 451\n')
    fspt.write('  lebedevbeta 3074\n')
    fspt.write('  dafh\n')
    fspt.write('endtes')
    fspt.close()                    

    cmd = 'rm '+name+'.mol'
    os.system(cmd)
#INFO: ******************** input file end ********************


System: ('Linux', 'silicio', '3.16.0-4-amd64', '#1 SMP Debian 3.16.51-3 (2017-12-13)', 'x86_64', '')  Threads 12
Python 2.7.14 (default, Apr  9 2018, 16:34:43) 
[GCC 7.3.0]
numpy 1.14.2  scipy 1.0.1
Date: Fri Jun 29 23:08:07 2018
PySCF version 1.5
PySCF path  /home/jluis/src/pyscf/pyscf
GIT ORIG_HEAD f2dbb26d09ae5148fbf5975669a994500ac7a4c9
GIT HEAD      ref: refs/heads/master
GIT master branch  f2dbb26d09ae5148fbf5975669a994500ac7a4c9

[ENV] PYSCF_TMPDIR /scratch-ssd/jluis
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 10
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry 0 subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 B      0.000000000000   0.000000000000   0.975046000000 AA    0.000000000000   0.000000000000   1.842569898853 Bohr
[INPUT]  2 B      0.000000000000   0.000000000000  -0.975046000000 AA    0.000000000000   0.000000000000  -1.842569898853 Bohr

nuclear repulsion = 6.78400315113338
number of shells = 26
number of NR pGTOs = 116
number of NR cGTOs = 92
basis = aug-cc-pvtz
ecp = {}
CPU time:       469.15


******** <class 'pyscf.dft.rks.RKS'> flags ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
DIIS start cycle = 1
DIIS space = 8
SCF tol = 1e-09
SCF gradient tol = None
max. SCF cycles = 120
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = b2.chk
max_memory 64000 MB (current use 90 MB)
XC functionals = scan
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs (JCP 102, 346 (M4)) radial grids
    
becke partition: Becke, JCP, 88, 2547 (1988)
pruning grids: <function nwchem_prune at 0x2b067e0f35f0>
grids dens level: 4
symmetrized grids: 0
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b067e0f3500>
Set gradient conv threshold to 3.16228e-05
tot grids = 54216
init E= -49.2854554425041

WARN: HOMO -0.150816389705509 == LUMO -0.150616483451056

cycle= 1 E= -49.2808382517525  delta_E= 0.00462  |g|= 0.114  |ddm|= 1.24

WARN: HOMO -0.177078657158851 == LUMO -0.17707865715885

cycle= 2 E= -49.2638412636157  delta_E= 0.017  |g|= 0.207  |ddm|= 1.24

WARN: HOMO -0.170984428269911 == LUMO -0.170059591363287

cycle= 3 E= -49.2763290084319  delta_E= -0.0125  |g|= 0.135  |ddm|= 0.174
  HOMO = -0.185114200588383  LUMO = -0.176549044212845
cycle= 4 E= -49.2799655257504  delta_E= -0.00364  |g|= 0.114  |ddm|= 1.26
  HOMO = -0.179740109916133  LUMO = -0.171941719514026
cycle= 5 E= -49.2804030804504  delta_E= -0.000438  |g|= 0.109  |ddm|= 0.0309
  HOMO = -0.179740686597451  LUMO = -0.171955567722071
cycle= 6 E= -49.2804136098031  delta_E= -1.05e-05  |g|= 0.109  |ddm|= 0.00164
  HOMO = -0.170113064629985  LUMO = -0.168953497233716
cycle= 7 E= -49.2789937178405  delta_E= 0.00142  |g|= 0.116  |ddm|= 1.32
  HOMO = -0.170102740701578  LUMO = -0.168936682137331
cycle= 8 E= -49.2789867113745  delta_E= 7.01e-06  |g|= 0.116  |ddm|= 0.000163
  HOMO = -0.173125380179052  LUMO = -0.171138144987984
cycle= 9 E= -49.2841253251487  delta_E= -0.00514  |g|= 0.0641  |ddm|=  1.3
  HOMO = -0.191182096616915  LUMO = -0.172907100297369
cycle= 10 E= -48.4858439289982  delta_E= 0.798  |g|= 0.332  |ddm|=  756
  HOMO = -0.234634361815767  LUMO = -0.187669565458515
cycle= 11 E= -48.4872716078086  delta_E= -0.00143  |g|= 0.334  |ddm|= 60.4
  HOMO = -0.227405819058171  LUMO = -0.184488298574895
cycle= 12 E= -48.488013373752  delta_E= -0.000742  |g|= 0.336  |ddm|= 23.4
  HOMO = -0.171497037575409  LUMO = -0.170244953338643
cycle= 13 E= -49.2774958207291  delta_E= -0.789  |g|= 0.128  |ddm|=  686

WARN: HOMO -0.168448209642653 == LUMO -0.167849591576523

cycle= 14 E= -49.2799158427411  delta_E= -0.00242  |g|= 0.108  |ddm|= 0.0693
  HOMO = -0.18367133403545  LUMO = -0.172773441014101
cycle= 15 E= -49.277161287413  delta_E= 0.00275  |g|= 0.137  |ddm|=  1.3
  HOMO = -0.166013330520355  LUMO = -0.164904062153056
cycle= 16 E= -49.2777633928781  delta_E= -0.000602  |g|= 0.126  |ddm|= 1.31
  HOMO = -0.164431337823237  LUMO = -0.16324008028015
cycle= 17 E= -49.2795645709974  delta_E= -0.0018  |g|= 0.112  |ddm|= 0.0555
  HOMO = -0.168272885912613  LUMO = -0.157083821561019
cycle= 18 E= -49.2761359250041  delta_E= 0.00343  |g|= 0.145  |ddm|=  1.3
  HOMO = -0.181433141157948  LUMO = -0.17099090804715
cycle= 19 E= -49.2774362661736  delta_E= -0.0013  |g|= 0.134  |ddm|= 0.209
  HOMO = -0.185596987954392  LUMO = -0.175789651591717
cycle= 20 E= -49.2780088143731  delta_E= -0.000573  |g|= 0.129  |ddm|= 0.0576
  HOMO = -0.182762223627661  LUMO = -0.173161945487512
cycle= 21 E= -49.2781873433713  delta_E= -0.000179  |g|= 0.128  |ddm|= 0.0626
  HOMO = -1.01842667189138  LUMO = -0.576795286369319
cycle= 22 E= -43.2422870751353  delta_E= 6.04  |g|= 0.672  |ddm|=  639
  HOMO = -1.08322099641218  LUMO = -0.616520485684627
cycle= 23 E= -43.2260999379565  delta_E= 0.0162  |g|= 0.688  |ddm|=   48
  HOMO = -0.948939061365566  LUMO = -0.574770086499293
cycle= 24 E= -43.2651014485649  delta_E= -0.039  |g|= 0.641  |ddm|=  129
  HOMO = -1.16744308121821  LUMO = -1.1023834946939
cycle= 25 E= -43.1526060174195  delta_E= 0.112  |g|= 0.74  |ddm|=  411
  HOMO = -1.24051954072329  LUMO = -1.17304851596108
cycle= 26 E= -46.4990471641771  delta_E= -3.35  |g|= 0.781  |ddm|=   68
  HOMO = -1.24775382549052  LUMO = -1.09511161007857
cycle= 27 E= -46.6084249777983  delta_E= -0.109  |g|= 0.648  |ddm|=  539
  HOMO = -1.30350581122126  LUMO = -1.28991465320467
cycle= 28 E= -48.6752530903617  delta_E= -2.07  |g|= 1.17  |ddm|=  443
  HOMO = -1.29898184492622  LUMO = -1.28539685946972
cycle= 29 E= -48.6802817248078  delta_E= -0.00503  |g|= 1.17  |ddm|= 0.0127
  HOMO = -1.41325938524686  LUMO = -1.39737531440837
cycle= 30 E= -48.5934853591012  delta_E= 0.0868  |g|= 1.26  |ddm|= 0.125
  HOMO = -1.41729327346854  LUMO = -1.40571812436534
cycle= 31 E= -48.5772926749052  delta_E= 0.0162  |g|= 1.28  |ddm|= 0.163
  HOMO = -1.39672209330999  LUMO = -1.39279952401611
cycle= 32 E= -48.4414014288727  delta_E= 0.136  |g|= 1.37  |ddm|= 1.78
  HOMO = -1.28851234807655  LUMO = -1.2864118935962
cycle= 33 E= -48.6031810896111  delta_E= -0.162  |g|= 1.21  |ddm|= 0.765
  HOMO = -0.945233160623698  LUMO = -0.943864287720479
cycle= 34 E= -48.8682282013186  delta_E= -0.265  |g|= 0.903  |ddm|= 0.722

WARN: HOMO -0.861687925401601 == LUMO -0.861045055947589

cycle= 35 E= -48.9373094867873  delta_E= -0.0691  |g|= 0.819  |ddm|= 1.39
  HOMO = -0.10183137105141  LUMO = -0.0838012227891623
cycle= 36 E= -49.2591120259532  delta_E= -0.322  |g|= 0.251  |ddm|= 1.94

WARN: HOMO -0.164297868828603 == LUMO -0.163879653703866

cycle= 37 E= -49.2697431514303  delta_E= -0.0106  |g|= 0.177  |ddm|= 1.36
  HOMO = -0.181113668705694  LUMO = -0.177307995764258
cycle= 38 E= -49.2827736631234  delta_E= -0.013  |g|= 0.0852  |ddm|= 1.29

WARN: HOMO -0.16768314388851 == LUMO -0.1668930958281

cycle= 39 E= -49.2776374151589  delta_E= 0.00514  |g|= 0.127  |ddm|= 1.25

WARN: HOMO -0.172519359011277 == LUMO -0.171859263095067

cycle= 40 E= -49.2850129122877  delta_E= -0.00738  |g|= 0.0519  |ddm|= 1.27

WARN: HOMO -0.174381672879784 == LUMO -0.173829902535819

cycle= 41 E= -49.2755379924364  delta_E= 0.00947  |g|= 0.141  |ddm|= 1.27

WARN: HOMO -0.17468551355815 == LUMO -0.17403185416669

cycle= 42 E= -49.2757419102788  delta_E= -0.000204  |g|= 0.14  |ddm|= 0.0221

WARN: HOMO -0.17447213684 == LUMO -0.173672416447856

cycle= 43 E= -49.2765035415749  delta_E= -0.000762  |g|= 0.134  |ddm|= 0.185

WARN: HOMO -0.174325396511098 == LUMO -0.17341701570671

cycle= 44 E= -49.2769400644041  delta_E= -0.000437  |g|= 0.131  |ddm|= 0.116
  HOMO = -0.177075152261371  LUMO = -0.175766691115985
cycle= 45 E= -49.2773320321755  delta_E= -0.000392  |g|= 0.128  |ddm|= 0.0765
  HOMO = -0.177063189025316  LUMO = -0.175793842240728
cycle= 46 E= -49.2840975821592  delta_E= -0.00677  |g|= 0.0669  |ddm|= 1.26
  HOMO = -0.177651907834412  LUMO = -0.173917266816889
cycle= 47 E= -49.2821903671704  delta_E= 0.00191  |g|= 0.0902  |ddm|= 0.134

WARN: HOMO -0.174433147769523 == LUMO -0.173937045610276

cycle= 48 E= -49.2750751413068  delta_E= 0.00712  |g|= 0.145  |ddm|= 1.27
  HOMO = -0.168926971937337  LUMO = -0.166951981927945
cycle= 49 E= -49.2800933282044  delta_E= -0.00502  |g|= 0.111  |ddm|= 0.374
  HOMO = -0.171280768666554  LUMO = -0.170046244571798
cycle= 50 E= -49.2804057985364  delta_E= -0.000312  |g|= 0.104  |ddm|= 0.363
  HOMO = -0.177229065406157  LUMO = -0.173147499502061
cycle= 51 E= -49.2821653623714  delta_E= -0.00176  |g|= 0.0911  |ddm|= 1.25

WARN: HOMO -0.173098246205651 == LUMO -0.172656974459637

cycle= 52 E= -49.2851790032891  delta_E= -0.00301  |g|= 0.0736  |ddm|= 0.785
  HOMO = -0.171875151469324  LUMO = -0.170673443988518
cycle= 53 E= -49.2808161626154  delta_E= 0.00436  |g|= 0.106  |ddm|= 0.637

WARN: HOMO -0.171818925568001 == LUMO -0.170973536202216

cycle= 54 E= -49.2822421105583  delta_E= -0.00143  |g|= 0.0952  |ddm|= 0.131
  HOMO = -0.176138845908677  LUMO = -0.171867609416035
cycle= 55 E= -49.2817703889216  delta_E= 0.000472  |g|= 0.0956  |ddm|= 1.14
  HOMO = -0.176886890329088  LUMO = -0.17299344619232
cycle= 56 E= -49.28152843781  delta_E= 0.000242  |g|= 0.0984  |ddm|= 0.0688

WARN: HOMO -0.171405889138599 == LUMO -0.171102631788086

cycle= 57 E= -49.2870743834822  delta_E= -0.00555  |g|= 0.0392  |ddm|= 0.757
  HOMO = -0.175570729588588  LUMO = -0.173662366126042
cycle= 58 E= -49.2828905879695  delta_E= 0.00418  |g|= 0.0991  |ddm|= 1.13
  HOMO = -0.173935774540971  LUMO = -0.170926091998779
cycle= 59 E= -49.2827615648188  delta_E= 0.000129  |g|= 0.0948  |ddm|= 0.507
  HOMO = -0.174058951557807  LUMO = -0.171360266815524
cycle= 60 E= -49.2826260302446  delta_E= 0.000136  |g|= 0.0941  |ddm|= 0.0888
  HOMO = -0.171538985332604  LUMO = -0.169532435232153
cycle= 61 E= -49.2810060818562  delta_E= 0.00162  |g|= 0.102  |ddm|= 0.281
  HOMO = -0.171529373420756  LUMO = -0.170306617225107
cycle= 62 E= -49.2820749274544  delta_E= -0.00107  |g|= 0.0969  |ddm|= 0.193

WARN: HOMO -0.171687932243647 == LUMO -0.171038021459425

cycle= 63 E= -49.2815565919096  delta_E= 0.000518  |g|=  0.1  |ddm|= 0.0709

WARN: HOMO -0.171623680175641 == LUMO -0.170973728515383

cycle= 64 E= -49.2810404446985  delta_E= 0.000516  |g|= 0.103  |ddm|= 0.0967
  HOMO = -0.171762659150914  LUMO = -0.170280058595569
cycle= 65 E= -49.2839472437102  delta_E= -0.00291  |g|= 0.0874  |ddm|= 0.468
  HOMO = -0.174511288699773  LUMO = -0.170259335734131
cycle= 66 E= -49.2800777319796  delta_E= 0.00387  |g|= 0.122  |ddm|= 1.17
  HOMO = -0.17104690321423  LUMO = -0.169331342058922
cycle= 67 E= -49.2866122720426  delta_E= -0.00653  |g|= 0.0477  |ddm|= 1.13

WARN: HOMO -0.172423842519239 == LUMO -0.171637190547391

cycle= 68 E= -49.2796137351793  delta_E= 0.007  |g|= 0.113  |ddm|= 1.05

WARN: HOMO -0.17241459784533 == LUMO -0.171712899717556

cycle= 69 E= -49.2796752016163  delta_E= -6.15e-05  |g|= 0.112  |ddm|= 0.0298

WARN: HOMO -0.172668231657685 == LUMO -0.172322581553914

cycle= 70 E= -49.2796655544131  delta_E= 9.65e-06  |g|= 0.11  |ddm|= 0.216

WARN: HOMO -0.172468174845328 == LUMO -0.171842756216986

cycle= 71 E= -49.2871626433391  delta_E= -0.0075  |g|= 0.0348  |ddm|= 0.928

WARN: HOMO -0.173933655346838 == LUMO -0.173208267034622

cycle= 72 E= -49.2805913593612  delta_E= 0.00657  |g|= 0.105  |ddm|= 1.07

WARN: HOMO -0.174254291254135 == LUMO -0.173282719350656

cycle= 73 E= -49.2834996579763  delta_E= -0.00291  |g|= 0.0902  |ddm|= 0.461

WARN: HOMO -0.172961919070509 == LUMO -0.172323499685882

cycle= 74 E= -49.2815122760613  delta_E= 0.00199  |g|= 0.0984  |ddm|= 0.358
  HOMO = -0.174131104163242  LUMO = -0.172993181161626
cycle= 75 E= -49.2833567593492  delta_E= -0.00184  |g|= 0.0978  |ddm|= 0.756

WARN: HOMO -0.173099579243821 == LUMO -0.172254945510651

cycle= 76 E= -49.2805250002889  delta_E= 0.00283  |g|= 0.101  |ddm|= 1.02

WARN: HOMO -0.173247410121981 == LUMO -0.172826086910545

cycle= 77 E= -49.2818431967457  delta_E= -0.00132  |g|= 0.094  |ddm|= 0.359

WARN: HOMO -0.173193375452559 == LUMO -0.172971927120972

cycle= 78 E= -49.2836492500824  delta_E= -0.00181  |g|= 0.0828  |ddm|= 0.255
  HOMO = -0.174577541836675  LUMO = -0.173286234760974
cycle= 79 E= -49.2850313368535  delta_E= -0.00138  |g|= 0.0679  |ddm|= 1.23

WARN: HOMO -0.172830238043804 == LUMO -0.172077222666979

cycle= 80 E= -49.2853249457515  delta_E= -0.000294  |g|= 0.0637  |ddm|= 0.879
  HOMO = -0.172849337426333  LUMO = -0.170418439949042
cycle= 81 E= -49.2822559487728  delta_E= 0.00307  |g|= 0.0978  |ddm|= 1.23
  HOMO = -0.172389197749348  LUMO = -0.169673525498063
cycle= 82 E= -49.2823853035582  delta_E= -0.000129  |g|= 0.0944  |ddm|= 0.0781
  HOMO = -0.171730375636415  LUMO = -0.168764216390436
cycle= 83 E= -49.2807709937243  delta_E= 0.00161  |g|= 0.105  |ddm|= 0.192
  HOMO = -0.171143745673791  LUMO = -0.169689743395542
cycle= 84 E= -49.2807827857523  delta_E= -1.18e-05  |g|= 0.0991  |ddm|= 0.427
  HOMO = -0.171446873838562  LUMO = -0.170089999508343
cycle= 85 E= -49.2813755910716  delta_E= -0.000593  |g|= 0.0949  |ddm|= 0.203
  HOMO = -0.171538890866012  LUMO = -0.170020887769527
cycle= 86 E= -49.2817087377762  delta_E= -0.000333  |g|= 0.0931  |ddm|= 0.485

WARN: HOMO -0.172201740275943 == LUMO -0.17138202711213

cycle= 87 E= -49.2835332553267  delta_E= -0.00182  |g|= 0.0771  |ddm|= 0.701
  HOMO = -0.172485102267755  LUMO = -0.171188818789103
cycle= 88 E= -49.2851246368306  delta_E= -0.00159  |g|= 0.074  |ddm|= 1.11
  HOMO = -0.176889354583058  LUMO = -0.174159049373084
cycle= 89 E= -49.2806228724326  delta_E= 0.0045  |g|= 0.11  |ddm|= 1.07

WARN: HOMO -0.172498534014614 == LUMO -0.172108461023821

cycle= 90 E= -49.2850576781105  delta_E= -0.00443  |g|= 0.0708  |ddm|= 0.747

WARN: HOMO -0.172337887098221 == LUMO -0.171859453572688

cycle= 91 E= -49.2859576871911  delta_E= -0.0009  |g|= 0.0645  |ddm|= 1.13
  HOMO = -0.172227087000089  LUMO = -0.17052115164469
cycle= 92 E= -49.2861604061329  delta_E= -0.000203  |g|= 0.0591  |ddm|= 0.147
  HOMO = -0.172393250270421  LUMO = -0.17033416695401
cycle= 93 E= -49.285968660213  delta_E= 0.000192  |g|= 0.0604  |ddm|= 0.114
  HOMO = -0.171987797862284  LUMO = -0.170082085288921
cycle= 94 E= -49.2859128431665  delta_E= 5.58e-05  |g|= 0.0614  |ddm|= 0.0347

WARN: HOMO -0.171798916376406 == LUMO -0.171074345261764

cycle= 95 E= -49.285356289653  delta_E= 0.000557  |g|= 0.0645  |ddm|= 1.16
  HOMO = -0.171635163825248  LUMO = -0.169718013209261
cycle= 96 E= -49.2798346107973  delta_E= 0.00552  |g|= 0.108  |ddm|= 1.15
  HOMO = -0.171394045618648  LUMO = -0.170338017926593
cycle= 97 E= -49.2820788055993  delta_E= -0.00224  |g|= 0.0926  |ddm|= 0.429
  HOMO = -0.171590162440766  LUMO = -0.169634045772265
cycle= 98 E= -49.2829584957466  delta_E= -0.00088  |g|= 0.0859  |ddm|= 0.108
  HOMO = -0.171696272064374  LUMO = -0.169988524826314
cycle= 99 E= -49.2835690201517  delta_E= -0.000611  |g|= 0.0798  |ddm|= 0.109
  HOMO = -0.171616401978497  LUMO = -0.169981775351032
cycle= 100 E= -49.2834868573333  delta_E= 8.22e-05  |g|= 0.0802  |ddm|= 0.0228
  HOMO = -0.171705633588211  LUMO = -0.170675597355758
cycle= 101 E= -49.2832262581119  delta_E= 0.000261  |g|= 0.0815  |ddm|= 0.0597

WARN: HOMO -0.172356733487539 == LUMO -0.171830557427018

cycle= 102 E= -49.2856009520088  delta_E= -0.00237  |g|= 0.0685  |ddm|= 1.22
  HOMO = -0.171533788720184  LUMO = -0.169929993241465
cycle= 103 E= -49.2815028223075  delta_E= 0.0041  |g|=  0.1  |ddm|= 1.23
  HOMO = -0.17557014231048  LUMO = -0.174007195322754
cycle= 104 E= -49.281807772848  delta_E= -0.000305  |g|= 0.0978  |ddm|=  1.2
  HOMO = -0.175953046714144  LUMO = -0.173453338141935
cycle= 105 E= -49.2847022432844  delta_E= -0.00289  |g|= 0.0792  |ddm|= 0.631
  HOMO = -0.175891636545785  LUMO = -0.173342613153176
cycle= 106 E= -49.2848905812357  delta_E= -0.000188  |g|= 0.0769  |ddm|= 0.0204
  HOMO = -0.173737391343277  LUMO = -0.171688228987488
cycle= 107 E= -49.2846213239594  delta_E= 0.000269  |g|= 0.0755  |ddm|= 0.375
  HOMO = -0.173345775602257  LUMO = -0.171643408225063
cycle= 108 E= -49.2813937160605  delta_E= 0.00323  |g|= 0.0943  |ddm|= 0.602
  HOMO = -0.171553929045847  LUMO = -0.170355458079739
cycle= 109 E= -49.282957180619  delta_E= -0.00156  |g|= 0.0832  |ddm|= 0.269
  HOMO = -0.171956810389227  LUMO = -0.169731114696581
cycle= 110 E= -49.2809666664162  delta_E= 0.00199  |g|=  0.1  |ddm|= 0.714
  HOMO = -0.171415610108056  LUMO = -0.168700921810121
cycle= 111 E= -49.2801104642381  delta_E= 0.000856  |g|= 0.107  |ddm|= 0.112
  HOMO = -0.171013115754012  LUMO = -0.16936770835706
cycle= 112 E= -49.2814482151063  delta_E= -0.00134  |g|= 0.0956  |ddm|= 0.0987
  HOMO = -0.17807881328531  LUMO = -0.17305479909593
cycle= 113 E= -49.2803862269742  delta_E= 0.00106  |g|= 0.111  |ddm|= 1.23
  HOMO = -0.174195922350983  LUMO = -0.172095236491474
cycle= 114 E= -49.2822426833155  delta_E= -0.00186  |g|= 0.0911  |ddm|= 0.0722
  HOMO = -0.17266921317938  LUMO = -0.170799384787823
cycle= 115 E= -49.280579257811  delta_E= 0.00166  |g|= 0.103  |ddm|= 1.22
  HOMO = -0.172792323584517  LUMO = -0.171484705373783
cycle= 116 E= -49.2786029373617  delta_E= 0.00198  |g|= 0.119  |ddm|= 0.167
  HOMO = -0.172929015411945  LUMO = -0.171464297857641
cycle= 117 E= -49.2804701098301  delta_E= -0.00187  |g|= 0.104  |ddm|= 0.263
  HOMO = -0.172963740573639  LUMO = -0.170944029606868
cycle= 118 E= -49.2797201724923  delta_E= 0.00075  |g|= 0.114  |ddm|= 0.602
  HOMO = -0.171991345517704  LUMO = -0.17024699889654
cycle= 119 E= -49.2764597338696  delta_E= 0.00326  |g|= 0.135  |ddm|= 0.387
  HOMO = -0.17213738674409  LUMO = -0.169775374820992
cycle= 120 E= -49.2775105225026  delta_E= -0.00105  |g|= 0.128  |ddm|= 0.308
SCF not converged.
SCF energy = -49.2775105225026
Electronic spatial extent <R**2> (au): 63.0958
* Multipoles in the independent field-basis, Gauge -> (0,0,0)
Electronic Dipole moment(X, Y, Z, Debye): 0.7515, 0.1518, -0.7558
Nuclear Dipole moment(X, Y, Z, Debye): 0.0000, 0.0000, 0.0000
Total Dipole moment(X, Y, Z, Debye): -0.7515, -0.1518, 0.7558
Quadrupole moments (Debye-Angs)
Total Quadrupole moments (XX, YY, ZZ): -17.5219, -11.6115, -10.0678
Total Quadrupole moments (XY, XZ, YZ): -1.4064, -0.0068, 0.0016
Octupole moments (Debye-Angs**2)
Total Octupole moments (XXX, YYY, ZZZ, XYY): -1.5734, -0.3153, 2.0083, -0.5037
Total Octupole moments (XXY, XXZ, XZZ, YZZ): -0.1112, 0.4875, -2.5038, -0.5439
Total Octupole moments (YYZ, XYZ): 0.2881, 0.0470
Hexadecapole moments (Debye-Angs**3)
Total Hexadecapole moments (XXXX, YYYY, ZZZZ, XXXY): -36.5226, -17.2793, -86.4477, -2.2758
Total Hexadecapole moments (XXXZ, YYYX, YYYZ, ZZZX): 0.0011, -2.2763, 0.0025, 0.0239
Total Hexadecapole moments (ZZZY, XXYY, XXZZ, YYZZ): 0.0138, -8.9722, -23.8443, -17.1542
Total Hexadecapole moments (XXYZ, YYXZ, ZZXY): 0.0011, -0.0008, -1.5731
