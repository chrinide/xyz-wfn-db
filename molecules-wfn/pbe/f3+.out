#INFO: **** input file is /home/jluis/src/git/db/molecules-wfn/pbe/run_sp.py ****
#!/usr/bin/env python

import numpy, sys, os
from pyscf import lib, gto, scf, dft
from pyscf.tools import molden
from pyscf.data import radii

def read_molecule(path):

    charge = spin = 0
    with open(path, 'r') as myfile:
        output = myfile.read()
        output = output.lstrip()
        output = output.rstrip()
        output = output.split('\n')

    try:
        int(output[0])
    except ValueError:
        try:
            charge = int(output[0].split(' ')[0])
            spin = int(output[0].split(' ')[1]) - 1
        except ValueError:
            molecule = output
        else:
            molecule = '\n'.join(output[1:])
    else:
        if int(output[0]) == len(output) - 2:
            molecule = '\n'.join(output[2:])
            try:
                charge = int(output[1].split(' ')[0])
                spin = int(output[1].split(' ')[1])-1
            except ValueError:
                pass
        else:
            print "THIS IS NOT A VALID XYZ FILE"

    return (molecule, charge, spin)

directory = '../../molecules/'
files = [i for i in os.listdir(directory) if i.endswith('.xyz')]

for filename in files:

    name = filename[:-8]
    mol = gto.Mole()
    (mol.atom, charge, spin) = read_molecule(directory+filename)
    mol.basis = 'aug-cc-pvtz'
    mol.charge = charge
    mol.spin = spin
    mol.output = name+'.out'
    mol.symmetry = 0
    mol.max_memory = 10000
    mol.verbose = 4
    mol.build()

    mf = dft.RKS(mol) 
    mf.grids.level = 4
    mf.xc = 'pbe,pbe'
    mf = scf.addons.remove_linear_dep_(mf)
    mf.max_cycle = 120
    mf.chkfile = name+'.chk'
    mf.kernel()

    dm = mf.make_rdm1()
    nao = mol.nao_nr()
    unit = 2.541746
    origin = ([0.0,0.0,0.0])
    charges = mol.atom_charges()
    coords  = mol.atom_coords()
    mol.set_common_orig(origin)
    r2 = mol.intor_symmetric('int1e_r2')
    r2 = numpy.einsum('ij,ji->', r2, dm)
    lib.logger.info(mf,'Electronic spatial extent <R**2> (au): %.4f', r2)

    lib.logger.info(mf,'* Multipoles in the independent field-basis, Gauge -> (0,0,0)')
    ao_dip = mol.intor_symmetric('int1e_r', comp=3)
    el_dip = numpy.einsum('xij,ji->x', ao_dip, dm)
    lib.logger.info(mf,'Electronic Dipole moment(X, Y, Z, Debye): %.4f, %.4f, %.4f', *el_dip*unit)
    nucl_dip = numpy.einsum('i,ix->x', charges, coords)
    lib.logger.info(mf,'Nuclear Dipole moment(X, Y, Z, Debye): %.4f, %.4f, %.4f', *nucl_dip*unit)
    mol_dip = (nucl_dip - el_dip) * unit
    lib.logger.info(mf,'Total Dipole moment(X, Y, Z, Debye): %.4f, %.4f, %.4f', *mol_dip)

    lib.logger.info(mf,'Quadrupole moments (Debye-Angs)')
    rr = mol.intor_symmetric('int1e_rr', comp=9).reshape(3,3,nao,nao)
    rr = -1.0*numpy.einsum('xyij,ji->xy', rr, dm)
    rr += numpy.einsum('z,zx,zy->xy', charges, coords, coords)
    rr = rr*unit*lib.param.BOHR
    lib.logger.info(mf,'Total Quadrupole moments (XX, YY, ZZ): %.4f, %.4f, %.4f', \
    rr[0,0], rr[1,1], rr[2,2])
    lib.logger.info(mf,'Total Quadrupole moments (XY, XZ, YZ): %.4f, %.4f, %.4f', \
    rr[0,1], rr[0,2], rr[1,2])
 
    lib.logger.info(mf,'Octupole moments (Debye-Angs**2)')
    rrr = mol.intor_symmetric('int1e_rrr', comp=27).reshape(3,3,3,nao,nao)
    rrr = -1.0*numpy.einsum('xyzij,ji->xyz', rrr, dm)
    rrr += numpy.einsum('z,zx,zy,zk->xyk', charges, coords, coords, coords)
    rrr = rrr*unit*lib.param.BOHR**2
    lib.logger.info(mf,'Total Octupole moments (XXX, YYY, ZZZ, XYY): %.4f, %.4f, %.4f, %.4f', \
    rrr[0,0,0], rrr[1,1,1], rrr[2,2,2], rrr[0,1,1])
    lib.logger.info(mf,'Total Octupole moments (XXY, XXZ, XZZ, YZZ): %.4f, %.4f, %.4f, %.4f', \
    rrr[0,0,1], rrr[0,0,2], rrr[0,2,2], rrr[1,2,2])
    lib.logger.info(mf,'Total Octupole moments (YYZ, XYZ): %.4f, %.4f', rrr[1,1,2], rrr[0,1,2])

    lib.logger.info(mf,'Hexadecapole moments (Debye-Angs**3)')
    rrrr = mol.intor_symmetric('int1e_rrrr', comp=81).reshape(3,3,3,3,nao,nao)
    rrrr = -1.0*numpy.einsum('xyzwij,ji->xyzw', rrrr, dm)
    rrrr += numpy.einsum('z,zx,zy,zk,zw->xykw', charges, coords, coords, coords, coords)
    rrrr = rrrr*unit*lib.param.BOHR**3
    lib.logger.info(mf,'Total Hexadecapole moments (XXXX, YYYY, ZZZZ, XXXY): %.4f, %.4f, %.4f, %.4f', \
    rrrr[0,0,0,0], rrrr[1,1,1,1], rrrr[2,2,2,2], rrrr[0,0,0,1])
    lib.logger.info(mf,'Total Hexadecapole moments (XXXZ, YYYX, YYYZ, ZZZX): %.4f, %.4f, %.4f, %.4f', \
    rrrr[0,0,0,2], rrrr[1,1,1,0], rrrr[1,1,1,2], rrrr[2,2,2,0])
    lib.logger.info(mf,'Total Hexadecapole moments (ZZZY, XXYY, XXZZ, YYZZ): %.4f, %.4f, %.4f, %.4f', \
    rrrr[2,2,2,1], rrrr[0,0,1,1], rrrr[0,0,2,2], rrrr[1,1,2,2])
    lib.logger.info(mf,'Total Hexadecapole moments (XXYZ, YYXZ, ZZXY): %.4f, %.4f, %.4f', \
    rrrr[0,0,1,2], rrrr[1,1,0,2], rrrr[2,2,0,1])
     
    coeff = mf.mo_coeff[:,mf.mo_occ>0]
    occ = mf.mo_occ[mf.mo_occ>0]
    energy = mf.mo_energy[mf.mo_occ>0]
    den_file = name+'.mol'
    fspt = open(den_file,'w')
    molden.header(mol, fspt)
    molden.orbital_coeff(mol, fspt, coeff, ene=energy, occ=occ) 
    fspt.close()                    
    cmd = '/home/jluis/bin/molden2aim '+name
    os.system(cmd)
    den_file = name+'.wfn'
    fspt = open(den_file,'a')
    fspt.write('RHF\n')
    fspt.close()                    

    pmd_file = name+'.pmd'
    fspt = open(pmd_file,'w')
    fspt.write('%s.wfn\n' % (name))
    if (mol.symmetry == False):
        fspt.write('nosymmetry\n')
    fspt.write('tes\n')
    fspt.write('  epsiscp 0.220\n')
    fspt.write('  radialquad 7\n')
    fspt.write('  rmapping 2\n')
    fspt.write('  lmax 10\n')
    fspt.write('  nr 551\n')
    fspt.write('  lebedev 5810\n')
    fspt.write('  betasphere\n')
    for ia in range(mol.natm):
        symb = mol.atom_pure_symbol(ia)
        inuc = lib.parameters.NUC[symb]
        betarad = radii.COVALENT[inuc]/3.5
        fspt.write('  betaradw %d %1.3f\n' % ((ia+1),betarad))
    fspt.write('  radialquadbeta 7\n')
    fspt.write('  rmappingbeta 3\n')
    fspt.write('  lmaxbeta 8\n')
    fspt.write('  nrb 451\n')
    fspt.write('  lebedevbeta 3074\n')
    fspt.write('  dafh\n')
    fspt.write('endtes')
    fspt.close()                    

    cmd = 'rm '+name+'.mol'
    os.system(cmd)

#INFO: ******************** input file end ********************


System: ('Linux', 'silicio', '3.16.0-4-amd64', '#1 SMP Debian 3.16.51-3 (2017-12-13)', 'x86_64', '')  Threads 12
Python 2.7.14 (default, Apr  9 2018, 16:34:43) 
[GCC 7.3.0]
numpy 1.14.2  scipy 1.0.1
Date: Fri Jun 29 01:22:17 2018
PySCF version 1.5
PySCF path  /home/jluis/src/pyscf/pyscf
GIT ORIG_HEAD f2dbb26d09ae5148fbf5975669a994500ac7a4c9
GIT HEAD      ref: refs/heads/master
GIT master branch  f2dbb26d09ae5148fbf5975669a994500ac7a4c9

[ENV] PYSCF_TMPDIR /scratch-ssd/jluis
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 26
[INPUT] charge = 1
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry 0 subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 F      0.000000000000   0.000000000000  -0.475167000000 AA    0.000000000000   0.000000000000  -0.897935493431 Bohr
[INPUT]  2 F      0.000000000000   0.000000000000   1.000000000000 AA    0.000000000000   0.000000000000   1.889726124565 Bohr
[INPUT]  3 F      0.000000000000   0.000000000000   2.475167000000 AA    0.000000000000   0.000000000000   4.677387742561 Bohr

nuclear repulsion = 72.6415281871815
number of shells = 39
number of NR pGTOs = 174
number of NR cGTOs = 138
basis = aug-cc-pvtz
ecp = {}
CPU time:    100822.39


******** <class 'pyscf.dft.rks.RKS'> flags ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
DIIS start cycle = 1
DIIS space = 8
SCF tol = 1e-09
SCF gradient tol = None
max. SCF cycles = 120
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = f3+.chk
max_memory 10000 MB (current use 218 MB)
XC functionals = pbe,pbe
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs (JCP 102, 346 (M4)) radial grids
    
becke partition: Becke, JCP, 88, 2547 (1988)
pruning grids: <function nwchem_prune at 0x2ab98a2da5f0>
grids dens level: 4
symmetrized grids: 0
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2ab98a2da500>
Set gradient conv threshold to 3.16228e-05
tot grids = 88236
init E= -299.311205641703

WARN: HOMO -0.350943148046924 == LUMO -0.350943148046921

cycle= 1 E= -298.301051742911  delta_E= 1.01  |g|= 1.04  |ddm|= 1.46
  HOMO = -0.744574597037339  LUMO = -0.732637873569509
cycle= 2 E= -297.172587835219  delta_E= 1.13  |g|= 2.86  |ddm|= 1.87
  HOMO = -0.771557608665241  LUMO = -0.75761825038641
cycle= 3 E= -298.456533299571  delta_E= -1.28  |g|= 0.565  |ddm|= 1.14
  HOMO = -0.716488330044569  LUMO = -0.69984857573521
cycle= 4 E= -298.485754811722  delta_E= -0.0292  |g|= 0.309  |ddm|= 1.63
  HOMO = -0.725860201852137  LUMO = -0.71925645488859
cycle= 5 E= -298.497207802717  delta_E= -0.0115  |g|= 0.157  |ddm|= 1.62
  HOMO = -0.730548554204447  LUMO = -0.725065814057331
cycle= 6 E= -298.496325792999  delta_E= 0.000882  |g|= 0.173  |ddm|= 1.62
  HOMO = -0.722162229217925  LUMO = -0.721138792029557
cycle= 7 E= -298.498134042012  delta_E= -0.00181  |g|= 0.127  |ddm|= 0.03
  HOMO = -0.730812755666457  LUMO = -0.714817930735844
cycle= 8 E= -298.496162858898  delta_E= 0.00197  |g|= 0.187  |ddm|= 1.62
  HOMO = -0.730556551039389  LUMO = -0.715127194673606
cycle= 9 E= -298.496259603975  delta_E= -9.67e-05  |g|= 0.185  |ddm|= 0.000814
  HOMO = -0.731887229347104  LUMO = -0.707240620414576
cycle= 10 E= -298.493455925296  delta_E= 0.0028  |g|= 0.248  |ddm|= 1.62
  HOMO = -0.731845023940326  LUMO = -0.709161158424659
cycle= 11 E= -298.493958800048  delta_E= -0.000503  |g|= 0.237  |ddm|= 0.00541
  HOMO = -0.731149188872694  LUMO = -0.70892851661476
cycle= 12 E= -298.492124109956  delta_E= 0.00183  |g|= 0.257  |ddm|= 1.62
  HOMO = -0.73101528579893  LUMO = -0.70888564437141
cycle= 13 E= -298.49334490413  delta_E= -0.00122  |g|= 0.243  |ddm|= 0.0129
  HOMO = -0.730837131548844  LUMO = -0.712464948039254
cycle= 14 E= -298.494702636524  delta_E= -0.00136  |g|= 0.214  |ddm|= 0.00793
  HOMO = -0.731545067880712  LUMO = -0.711906118201504
cycle= 15 E= -298.495273933461  delta_E= -0.000571  |g|= 0.21  |ddm|= 1.62
  HOMO = -0.731565174463781  LUMO = -0.70803728271994
cycle= 16 E= -298.493903350385  delta_E= 0.00137  |g|= 0.24  |ddm|= 0.00804
  HOMO = -0.730130972411258  LUMO = -0.715337794065308
cycle= 17 E= -298.496402076564  delta_E= -0.0025  |g|= 0.182  |ddm|= 0.0162
  HOMO = -0.731435955983205  LUMO = -0.707503507516156
cycle= 18 E= -298.493729761712  delta_E= 0.00267  |g|= 0.244  |ddm|= 1.62
  HOMO = -0.731308900650103  LUMO = -0.712688260981629
cycle= 19 E= -298.495597891296  delta_E= -0.00187  |g|= 0.202  |ddm|= 0.0106

WARN: HOMO -0.722973561811636 == LUMO -0.722694246519227

cycle= 20 E= -298.498193413134  delta_E= -0.0026  |g|= 0.124  |ddm|= 1.61
  HOMO = -0.728704016713763  LUMO = -0.716874766437926
cycle= 21 E= -298.496826124607  delta_E= 0.00137  |g|= 0.17  |ddm|= 1.61
  HOMO = -0.729466697762184  LUMO = -0.715236170918969
cycle= 22 E= -298.496509035503  delta_E= 0.000317  |g|= 0.179  |ddm|= 0.00376
  HOMO = -0.72797500272634  LUMO = -0.717314015508055
cycle= 23 E= -298.49699537342  delta_E= -0.000486  |g|= 0.165  |ddm|= 0.00758
  HOMO = -0.731770947657512  LUMO = -0.711113232552637
cycle= 24 E= -298.495001509277  delta_E= 0.00199  |g|= 0.217  |ddm|= 1.62
  HOMO = -0.731853181751145  LUMO = -0.710104578827625
cycle= 25 E= -298.494621996662  delta_E= 0.00038  |g|= 0.225  |ddm|= 0.00664
  HOMO = -0.731843609510441  LUMO = -0.70960332286279
cycle= 26 E= -298.494439435411  delta_E= 0.000183  |g|= 0.229  |ddm|= 0.00108
  HOMO = -0.725591728744283  LUMO = -0.71734592403572
cycle= 27 E= -298.497133378746  delta_E= -0.00269  |g|= 0.159  |ddm|= 1.62
  HOMO = -0.727216915866537  LUMO = -0.716676961150333
cycle= 28 E= -298.49695215588  delta_E= 0.000181  |g|= 0.166  |ddm|= 0.00773
  HOMO = -0.722263621117258  LUMO = -0.721174410046908
cycle= 29 E= -298.498043688716  delta_E= -0.00109  |g|= 0.129  |ddm|= 1.59
  HOMO = -0.730760284022627  LUMO = -0.712321465662403
cycle= 30 E= -298.495096858504  delta_E= 0.00295  |g|= 0.209  |ddm|= 1.59
  HOMO = -0.730909727363721  LUMO = -0.710754755399376
cycle= 31 E= -298.494908109345  delta_E= 0.000189  |g|= 0.217  |ddm|= 0.0127
  HOMO = -0.724259395394739  LUMO = -0.72204139965828
cycle= 32 E= -298.497899365525  delta_E= -0.00299  |g|= 0.134  |ddm|= 0.0261
  HOMO = -0.731408926188344  LUMO = -0.704374474029666
cycle= 33 E= -298.492432542857  delta_E= 0.00547  |g|= 0.268  |ddm|= 1.62
  HOMO = -0.731401581873823  LUMO = -0.704600431443751
cycle= 34 E= -298.492573347568  delta_E= -0.000141  |g|= 0.266  |ddm|= 0.00529
  HOMO = -0.731400481709221  LUMO = -0.704621042326455
cycle= 35 E= -298.492584273206  delta_E= -1.09e-05  |g|= 0.266  |ddm|= 0.0011
  HOMO = -0.73139846237055  LUMO = -0.705885172569401
cycle= 36 E= -298.493104253242  delta_E= -0.00052  |g|= 0.256  |ddm|= 0.019
  HOMO = -0.726535069108543  LUMO = -0.718868390785218
cycle= 37 E= -298.497397370736  delta_E= -0.00429  |g|= 0.154  |ddm|= 1.24
  HOMO = -0.730118285761591  LUMO = -0.703142121664557
cycle= 38 E= -298.492908943251  delta_E= 0.00449  |g|= 0.262  |ddm|= 1.27
  HOMO = -0.723374407401937  LUMO = -0.721250151822379
cycle= 39 E= -298.497496439  delta_E= -0.00459  |g|= 0.143  |ddm|= 0.332
  HOMO = -0.731591419449298  LUMO = -0.712274534595265
cycle= 40 E= -298.495363382463  delta_E= 0.00213  |g|= 0.207  |ddm|=  1.6
  HOMO = -0.73159101955567  LUMO = -0.710640102514353
cycle= 41 E= -298.494962120157  delta_E= 0.000401  |g|= 0.218  |ddm|= 0.0144
  HOMO = -0.730921383728248  LUMO = -0.711229276957368
cycle= 42 E= -298.495339755974  delta_E= -0.000378  |g|= 0.209  |ddm|= 0.094
  HOMO = -0.721513515473269  LUMO = -0.718482882628275
cycle= 43 E= -298.49338126008  delta_E= 0.00196  |g|= 0.212  |ddm|= 1.22
  HOMO = -0.722970391412805  LUMO = -0.719364617081445
cycle= 44 E= -298.497550647592  delta_E= -0.00417  |g|= 0.144  |ddm|= 1.12
  HOMO = -0.726486513824558  LUMO = -0.718954001882808
cycle= 45 E= -298.496649986447  delta_E= 0.000901  |g|= 0.167  |ddm|= 1.62
  HOMO = -0.730660695155371  LUMO = -0.717476507617871
cycle= 46 E= -298.496377619938  delta_E= 0.000272  |g|= 0.181  |ddm|= 0.131
  HOMO = -0.730497501487166  LUMO = -0.717075353049667
cycle= 47 E= -298.496596483184  delta_E= -0.000219  |g|= 0.177  |ddm|= 0.018
  HOMO = -0.731743324215728  LUMO = -0.71581134055835
cycle= 48 E= -298.496279021263  delta_E= 0.000317  |g|= 0.186  |ddm|= 0.0373
  HOMO = -0.721130572064163  LUMO = -0.719981915605422
cycle= 49 E= -298.490041637932  delta_E= 0.00624  |g|= 0.253  |ddm|= 1.44
  HOMO = -0.730360591980073  LUMO = -0.71603865074442
cycle= 50 E= -298.495532149448  delta_E= -0.00549  |g|= 0.195  |ddm|= 1.53
  HOMO = -0.726390939153665  LUMO = -0.71687066797923
cycle= 51 E= -298.4971617804  delta_E= -0.00163  |g|= 0.161  |ddm|=  1.6
  HOMO = -0.726417171833191  LUMO = -0.717609655413392
cycle= 52 E= -298.497211203922  delta_E= -4.94e-05  |g|= 0.158  |ddm|= 0.103
  HOMO = -0.726745277930222  LUMO = -0.715968574404691
cycle= 53 E= -298.49565986124  delta_E= 0.00155  |g|= 0.188  |ddm|= 0.107
  HOMO = -0.727877428345181  LUMO = -0.715376252354316
cycle= 54 E= -298.49678177945  delta_E= -0.00112  |g|= 0.172  |ddm|= 0.0655
  HOMO = -0.730245411842573  LUMO = -0.710925817000971
cycle= 55 E= -298.495377891045  delta_E= 0.0014  |g|= 0.206  |ddm|= 1.62
  HOMO = -0.729960465236031  LUMO = -0.70841143789597
cycle= 56 E= -298.494530756452  delta_E= 0.000847  |g|= 0.226  |ddm|= 0.0352
  HOMO = -0.730073893039947  LUMO = -0.709611930020192
cycle= 57 E= -298.495162067526  delta_E= -0.000631  |g|= 0.214  |ddm|= 0.017
  HOMO = -0.730013230198965  LUMO = -0.710902944067406
cycle= 58 E= -298.495325587271  delta_E= -0.000164  |g|= 0.207  |ddm|= 0.0105
  HOMO = -0.72569063347996  LUMO = -0.719213868365369
cycle= 59 E= -298.497491281707  delta_E= -0.00217  |g|= 0.149  |ddm|= 0.0378
  HOMO = -0.730730855737675  LUMO = -0.707739267748059
cycle= 60 E= -298.493989938562  delta_E= 0.0035  |g|= 0.238  |ddm|= 1.62
  HOMO = -0.730815521326562  LUMO = -0.70829247580609
cycle= 61 E= -298.494097006248  delta_E= -0.000107  |g|= 0.235  |ddm|= 0.0069
  HOMO = -0.730654647086495  LUMO = -0.710743640521453
cycle= 62 E= -298.495088277705  delta_E= -0.000991  |g|= 0.213  |ddm|= 0.0098
  HOMO = -0.730931550557919  LUMO = -0.709992243993961
cycle= 63 E= -298.494684683915  delta_E= 0.000404  |g|= 0.222  |ddm|= 0.00996
  HOMO = -0.73079847897946  LUMO = -0.71448994022491
cycle= 64 E= -298.496167092246  delta_E= -0.00148  |g|= 0.188  |ddm|= 1.62
  HOMO = -0.731742432222644  LUMO = -0.70949051929476
cycle= 65 E= -298.494397021125  delta_E= 0.00177  |g|= 0.23  |ddm|= 0.0623
  HOMO = -0.731921770280833  LUMO = -0.70727939763791
cycle= 66 E= -298.493350393211  delta_E= 0.00105  |g|= 0.25  |ddm|= 0.0063
  HOMO = -0.732435697321182  LUMO = -0.710650177735633
cycle= 67 E= -298.494604201663  delta_E= -0.00125  |g|= 0.225  |ddm|= 0.00837
  HOMO = -0.73184509372233  LUMO = -0.709997216662522
cycle= 68 E= -298.494245106543  delta_E= 0.000359  |g|= 0.23  |ddm|= 0.0116
  HOMO = -0.728983586729715  LUMO = -0.715761398721386
cycle= 69 E= -298.495859671859  delta_E= -0.00161  |g|= 0.188  |ddm|= 0.043
  HOMO = -0.731596321464816  LUMO = -0.707759917136397
cycle= 70 E= -298.493714152843  delta_E= 0.00215  |g|= 0.244  |ddm|= 1.62
  HOMO = -0.731588190753196  LUMO = -0.707689835095487
cycle= 71 E= -298.493675178804  delta_E= 3.9e-05  |g|= 0.244  |ddm|= 0.00163
  HOMO = -0.731589434609083  LUMO = -0.707746965685975
cycle= 72 E= -298.493700295173  delta_E= -2.51e-05  |g|= 0.244  |ddm|= 0.000478
  HOMO = -0.731673950194713  LUMO = -0.708757402118988
cycle= 73 E= -298.494048734288  delta_E= -0.000348  |g|= 0.236  |ddm|= 0.0344
  HOMO = -0.731404045208311  LUMO = -0.708155933021391
cycle= 74 E= -298.493932324619  delta_E= 0.000116  |g|= 0.239  |ddm|= 0.0215
  HOMO = -0.730246208651874  LUMO = -0.716493254093278
cycle= 75 E= -298.495994692289  delta_E= -0.00206  |g|= 0.189  |ddm|= 1.62
  HOMO = -0.726733939853283  LUMO = -0.719613144200386
cycle= 76 E= -298.497151080071  delta_E= -0.00116  |g|= 0.157  |ddm|= 0.0287
  HOMO = -0.725501899592891  LUMO = -0.720783370763082
cycle= 77 E= -298.496759542095  delta_E= 0.000392  |g|= 0.161  |ddm|= 0.0446
  HOMO = -0.723456519472329  LUMO = -0.722438171007552
cycle= 78 E= -298.497884207588  delta_E= -0.00112  |g|= 0.133  |ddm|= 1.61
  HOMO = -0.722900765814642  LUMO = -0.721756085259631
cycle= 79 E= -298.498065493217  delta_E= -0.000181  |g|= 0.129  |ddm|= 0.449
  HOMO = -0.727848670868112  LUMO = -0.717580159411969
cycle= 80 E= -298.496311518528  delta_E= 0.00175  |g|= 0.177  |ddm|=  1.6
  HOMO = -0.727283045688425  LUMO = -0.718584893367247
cycle= 81 E= -298.496516308193  delta_E= -0.000205  |g|= 0.171  |ddm|= 0.215
  HOMO = -0.723840642683245  LUMO = -0.718898850027136
cycle= 82 E= -298.496916737451  delta_E= -0.0004  |g|= 0.158  |ddm|= 0.209

WARN: HOMO -0.721692152364617 == LUMO -0.72081303417846

cycle= 83 E= -298.497226127338  delta_E= -0.000309  |g|= 0.146  |ddm|= 0.294
  HOMO = -0.723690877157097  LUMO = -0.722034354946672
cycle= 84 E= -298.497283128019  delta_E= -5.7e-05  |g|= 0.146  |ddm|= 1.61
  HOMO = -0.723445122321534  LUMO = -0.722005739527063
cycle= 85 E= -298.497878676641  delta_E= -0.000596  |g|= 0.133  |ddm|= 0.0935
  HOMO = -0.7230890595927  LUMO = -0.721498403085732
cycle= 86 E= -298.497886582749  delta_E= -7.91e-06  |g|= 0.133  |ddm|= 0.292
  HOMO = -0.725128073549124  LUMO = -0.721829705383081
cycle= 87 E= -298.497886915063  delta_E= -3.32e-07  |g|= 0.136  |ddm|= 0.159
  HOMO = -0.724898121991693  LUMO = -0.72146881281773
cycle= 88 E= -298.497862131343  delta_E= 2.48e-05  |g|= 0.137  |ddm|= 0.00482
  HOMO = -0.731291482953396  LUMO = -0.712811031674389
cycle= 89 E= -298.494245904902  delta_E= 0.00362  |g|= 0.219  |ddm|= 1.62
  HOMO = -0.729495232307028  LUMO = -0.715541813184712
cycle= 90 E= -298.496443643513  delta_E= -0.0022  |g|= 0.18  |ddm|= 0.0278
  HOMO = -0.729542853680858  LUMO = -0.715349153893201
cycle= 91 E= -298.496419643523  delta_E= 2.4e-05  |g|= 0.181  |ddm|= 0.00449
  HOMO = -0.729277122560406  LUMO = -0.714977281336201
cycle= 92 E= -298.496463102107  delta_E= -4.35e-05  |g|= 0.18  |ddm|= 0.00541
  HOMO = -0.728248852429194  LUMO = -0.716097533630918
cycle= 93 E= -298.494506971081  delta_E= 0.00196  |g|= 0.207  |ddm|= 0.109
  HOMO = -0.723428979402292  LUMO = -0.718996838622112
cycle= 94 E= -298.497792632853  delta_E= -0.00329  |g|= 0.14  |ddm|= 0.0972
  HOMO = -0.730509776327724  LUMO = -0.710986216832164
cycle= 95 E= -298.495358413895  delta_E= 0.00243  |g|= 0.208  |ddm|= 1.62
  HOMO = -0.730649714683253  LUMO = -0.709355999210174
cycle= 96 E= -298.494704671611  delta_E= 0.000654  |g|= 0.223  |ddm|= 0.0128
  HOMO = -0.730614760535375  LUMO = -0.709852464184429
cycle= 97 E= -298.494908599029  delta_E= -0.000204  |g|= 0.218  |ddm|= 0.00246
  HOMO = -0.724514164559044  LUMO = -0.719579070214363
cycle= 98 E= -298.497725430873  delta_E= -0.00282  |g|= 0.142  |ddm|= 0.0909
  HOMO = -0.730262077903484  LUMO = -0.716104993745935
cycle= 99 E= -298.496544606419  delta_E= 0.00118  |g|= 0.179  |ddm|= 1.62
  HOMO = -0.730504484508339  LUMO = -0.716243478109714
cycle= 100 E= -298.496508426053  delta_E= 3.62e-05  |g|= 0.179  |ddm|= 0.00278
  HOMO = -0.726853888033677  LUMO = -0.721162034266375
cycle= 101 E= -298.497620153545  delta_E= -0.00111  |g|= 0.146  |ddm|= 0.0164
  HOMO = -0.723914838839402  LUMO = -0.720544257835233
cycle= 102 E= -298.497078332037  delta_E= 0.000542  |g|= 0.153  |ddm|= 1.61
  HOMO = -0.728666928844222  LUMO = -0.715517885420266
cycle= 103 E= -298.496001480802  delta_E= 0.00108  |g|= 0.186  |ddm|= 1.61
  HOMO = -0.725907332026573  LUMO = -0.714401842111016
cycle= 104 E= -298.496810872159  delta_E= -0.000809  |g|= 0.17  |ddm|= 1.62

WARN: HOMO -0.722531269968018 == LUMO -0.72233154988946

cycle= 105 E= -298.49813661806  delta_E= -0.00133  |g|= 0.125  |ddm|= 0.671
  HOMO = -0.729592490904578  LUMO = -0.710206567474988
cycle= 106 E= -298.495501989318  delta_E= 0.00263  |g|= 0.206  |ddm|= 0.664
  HOMO = -0.728394464749033  LUMO = -0.713313429835984
cycle= 107 E= -298.496342327975  delta_E= -0.00084  |g|= 0.184  |ddm|= 0.0148
  HOMO = -0.7284479480415  LUMO = -0.716680465658576
cycle= 108 E= -298.496762264573  delta_E= -0.00042  |g|= 0.171  |ddm|= 1.62
  HOMO = -0.731983931866802  LUMO = -0.71069136619256
cycle= 109 E= -298.494749889933  delta_E= 0.00201  |g|= 0.222  |ddm|= 0.0466
  HOMO = -0.732483866161252  LUMO = -0.706795311882564
cycle= 110 E= -298.493077235197  delta_E= 0.00167  |g|= 0.257  |ddm|= 0.00995
  HOMO = -0.73231892230386  LUMO = -0.715316159911999
cycle= 111 E= -298.495927683731  delta_E= -0.00285  |g|= 0.193  |ddm|= 1.62
  HOMO = -0.726015320885228  LUMO = -0.719419172858631
cycle= 112 E= -298.497233162161  delta_E= -0.00131  |g|= 0.155  |ddm|= 1.62
  HOMO = -0.731377841753692  LUMO = -0.714425429700195
cycle= 113 E= -298.495987277383  delta_E= 0.00125  |g|= 0.192  |ddm|= 1.62
  HOMO = -0.73035221270023  LUMO = -0.714771347005043
cycle= 114 E= -298.496288993878  delta_E= -0.000302  |g|= 0.185  |ddm|= 0.0376
  HOMO = -0.733368835613102  LUMO = -0.710505779837333
cycle= 115 E= -298.49436020161  delta_E= 0.00193  |g|= 0.231  |ddm|= 0.022
  HOMO = -0.732679924734657  LUMO = -0.708519776425301
cycle= 116 E= -298.493770113329  delta_E= 0.00059  |g|= 0.243  |ddm|= 0.0157
  HOMO = -0.732744412275026  LUMO = -0.715413948906347
cycle= 117 E= -298.495939019382  delta_E= -0.00217  |g|= 0.193  |ddm|= 0.0366
  HOMO = -0.731635871543838  LUMO = -0.707680426766783
cycle= 118 E= -298.493713704331  delta_E= 0.00223  |g|= 0.244  |ddm|= 1.62
  HOMO = -0.731644715504548  LUMO = -0.707711308064186
cycle= 119 E= -298.493719192117  delta_E= -5.49e-06  |g|= 0.244  |ddm|= 0.00122
  HOMO = -0.729034609531436  LUMO = -0.71703958446793
cycle= 120 E= -298.49679473589  delta_E= -0.00308  |g|= 0.171  |ddm|= 0.0199
SCF not converged.
SCF energy = -298.49679473589
Electronic spatial extent <R**2> (au): 254.8182
* Multipoles in the independent field-basis, Gauge -> (0,0,0)
Electronic Dipole moment(X, Y, Z, Debye): -0.0007, -0.0019, 124.8309
Nuclear Dipole moment(X, Y, Z, Debye): 0.0000, 0.0000, 129.6865
Total Dipole moment(X, Y, Z, Debye): 0.0007, 0.0019, 4.8556
Quadrupole moments (Debye-Angs)
Total Quadrupole moments (XX, YY, ZZ): -11.8905, -13.0659, 0.0459
Total Quadrupole moments (XY, XZ, YZ): 0.3723, 0.0007, 0.0019
Octupole moments (Debye-Angs**2)
Total Octupole moments (XXX, YYY, ZZZ, XYY): -0.0005, 0.0008, -9.4946, -0.0002
Total Octupole moments (XXY, XXZ, XZZ, YZZ): 0.0002, -11.8808, -0.0127, -0.0009
Total Octupole moments (YYZ, XYZ): -13.0629, 0.3733
Hexadecapole moments (Debye-Angs**3)
Total Hexadecapole moments (XXXX, YYYY, ZZZZ, XXXY): -6.4014, -7.2543, -118.3782, 0.1349
Total Hexadecapole moments (XXXZ, YYYX, YYYZ, ZZZX): -0.0005, 0.1353, 0.0008, -0.0396
Total Hexadecapole moments (ZZZY, XXYY, XXZZ, YYZZ): -0.0065, -2.2758, -30.9481, -34.4346
Total Hexadecapole moments (XXYZ, YYXZ, ZZXY): 0.0002, -0.0002, 1.1022
