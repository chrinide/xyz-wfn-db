#INFO: **** input file is /home/jluis/src/git/db/diatomic-wfn/m06-l/run_sp.py ****
#!/usr/bin/env python

import numpy, sys, os
from pyscf import lib, gto, scf, dft
from pyscf.tools import molden
from pyscf.data import radii

def read_molecule(path):

    charge = spin = 0
    with open(path, 'r') as myfile:
        output = myfile.read()
        output = output.lstrip()
        output = output.rstrip()
        output = output.split('\n')

    try:
        int(output[0])
    except ValueError:
        try:
            charge = int(output[0].split(' ')[0])
            spin = int(output[0].split(' ')[1]) - 1
        except ValueError:
            molecule = output
        else:
            molecule = '\n'.join(output[1:])
    else:
        if int(output[0]) == len(output) - 2:
            molecule = '\n'.join(output[2:])
            try:
                charge = int(output[1].split(' ')[0])
                spin = int(output[1].split(' ')[1])-1
            except ValueError:
                pass
        else:
            print "THIS IS NOT A VALID XYZ FILE"

    return (molecule, charge, spin)

directory = '../../diatomic/'
files = [i for i in os.listdir(directory) if i.endswith('.xyz')]

for filename in files:

    name = filename[:-8]
    mol = gto.Mole()
    (mol.atom, charge, spin) = read_molecule(directory+filename)
    mol.basis = 'aug-cc-pvtz'
    mol.charge = charge
    mol.spin = spin
    mol.output = name+'.out'
    mol.symmetry = 0
    mol.verbose = 4
    mol.build()

    mf = dft.RKS(mol) 
    mf.xc = 'm06-l'
    mf.grids.level = 4
    mf.max_cycle = 120
    mf.chkfile = name+'.chk'
    mf = scf.addons.remove_linear_dep_(mf)
    #mf = mf.newton()
    mf.kernel()
    #
    #stable_cyc = 3
    #for i in range(stable_cyc):
    #    new_mo_coeff = mf.stability(internal=True, external=False)[0]
    #    if numpy.linalg.norm(numpy.array(new_mo_coeff) - numpy.array(mf.mo_coeff)) < 10**-8:
    #        lib.logger.info(mf,"* The molecule is stable")
    #        break
    #    else:
    #        lib.logger.info(mf,"* The molecule is unstable")
    #        n_alpha = numpy.count_nonzero(mf.mo_occ)
    #        P_alpha = 2.0*numpy.dot(new_mo_coeff[:, :n_alpha], new_mo_coeff.T[:n_alpha])
    #        mf.kernel(dm0=(P_alpha))
    #        lib.logger.info(mf,"* Updated SCF energy and orbitals: %.6f" % mf.e_tot)
    #
    dm = mf.make_rdm1()
    nao = mol.nao_nr()
    unit = 2.541746
    origin = ([0.0,0.0,0.0])
    charges = mol.atom_charges()
    coords  = mol.atom_coords()
    mol.set_common_orig(origin)
    r2 = mol.intor_symmetric('int1e_r2')
    r2 = numpy.einsum('ij,ji->', r2, dm)
    lib.logger.info(mf,'Electronic spatial extent <R**2> (au): %.4f', r2)

    lib.logger.info(mf,'* Multipoles in the independent field-basis, Gauge -> (0,0,0)')
    ao_dip = mol.intor_symmetric('int1e_r', comp=3)
    el_dip = numpy.einsum('xij,ji->x', ao_dip, dm)
    lib.logger.info(mf,'Electronic Dipole moment(X, Y, Z, Debye): %.4f, %.4f, %.4f', *el_dip*unit)
    nucl_dip = numpy.einsum('i,ix->x', charges, coords)
    lib.logger.info(mf,'Nuclear Dipole moment(X, Y, Z, Debye): %.4f, %.4f, %.4f', *nucl_dip*unit)
    mol_dip = (nucl_dip - el_dip) * unit
    lib.logger.info(mf,'Total Dipole moment(X, Y, Z, Debye): %.4f, %.4f, %.4f', *mol_dip)

    lib.logger.info(mf,'Quadrupole moments (Debye-Angs)')
    rr = mol.intor_symmetric('int1e_rr', comp=9).reshape(3,3,nao,nao)
    rr = -1.0*numpy.einsum('xyij,ji->xy', rr, dm)
    rr += numpy.einsum('z,zx,zy->xy', charges, coords, coords)
    rr = rr*unit*lib.param.BOHR
    lib.logger.info(mf,'Total Quadrupole moments (XX, YY, ZZ): %.4f, %.4f, %.4f', \
    rr[0,0], rr[1,1], rr[2,2])
    lib.logger.info(mf,'Total Quadrupole moments (XY, XZ, YZ): %.4f, %.4f, %.4f', \
    rr[0,1], rr[0,2], rr[1,2])
 
    lib.logger.info(mf,'Octupole moments (Debye-Angs**2)')
    rrr = mol.intor_symmetric('int1e_rrr', comp=27).reshape(3,3,3,nao,nao)
    rrr = -1.0*numpy.einsum('xyzij,ji->xyz', rrr, dm)
    rrr += numpy.einsum('z,zx,zy,zk->xyk', charges, coords, coords, coords)
    rrr = rrr*unit*lib.param.BOHR**2
    lib.logger.info(mf,'Total Octupole moments (XXX, YYY, ZZZ, XYY): %.4f, %.4f, %.4f, %.4f', \
    rrr[0,0,0], rrr[1,1,1], rrr[2,2,2], rrr[0,1,1])
    lib.logger.info(mf,'Total Octupole moments (XXY, XXZ, XZZ, YZZ): %.4f, %.4f, %.4f, %.4f', \
    rrr[0,0,1], rrr[0,0,2], rrr[0,2,2], rrr[1,2,2])
    lib.logger.info(mf,'Total Octupole moments (YYZ, XYZ): %.4f, %.4f', rrr[1,1,2], rrr[0,1,2])

    lib.logger.info(mf,'Hexadecapole moments (Debye-Angs**3)')
    rrrr = mol.intor_symmetric('int1e_rrrr', comp=81).reshape(3,3,3,3,nao,nao)
    rrrr = -1.0*numpy.einsum('xyzwij,ji->xyzw', rrrr, dm)
    rrrr += numpy.einsum('z,zx,zy,zk,zw->xykw', charges, coords, coords, coords, coords)
    rrrr = rrrr*unit*lib.param.BOHR**3
    lib.logger.info(mf,'Total Hexadecapole moments (XXXX, YYYY, ZZZZ, XXXY): %.4f, %.4f, %.4f, %.4f', \
    rrrr[0,0,0,0], rrrr[1,1,1,1], rrrr[2,2,2,2], rrrr[0,0,0,1])
    lib.logger.info(mf,'Total Hexadecapole moments (XXXZ, YYYX, YYYZ, ZZZX): %.4f, %.4f, %.4f, %.4f', \
    rrrr[0,0,0,2], rrrr[1,1,1,0], rrrr[1,1,1,2], rrrr[2,2,2,0])
    lib.logger.info(mf,'Total Hexadecapole moments (ZZZY, XXYY, XXZZ, YYZZ): %.4f, %.4f, %.4f, %.4f', \
    rrrr[2,2,2,1], rrrr[0,0,1,1], rrrr[0,0,2,2], rrrr[1,1,2,2])
    lib.logger.info(mf,'Total Hexadecapole moments (XXYZ, YYXZ, ZZXY): %.4f, %.4f, %.4f', \
    rrrr[0,0,1,2], rrrr[1,1,0,2], rrrr[2,2,0,1])
     
    coeff = mf.mo_coeff[:,mf.mo_occ>0]
    occ = mf.mo_occ[mf.mo_occ>0]
    energy = mf.mo_energy[mf.mo_occ>0]
    den_file = name+'.mol'
    fspt = open(den_file,'w')
    molden.header(mol, fspt)
    molden.orbital_coeff(mol, fspt, coeff, ene=energy, occ=occ) 
    fspt.close()                    
    cmd = '/home/jluis/bin/molden2aim '+name
    os.system(cmd)
    den_file = name+'.wfn'
    fspt = open(den_file,'a')
    fspt.write('RHF\n')
    fspt.close()                    

    pmd_file = name+'.pmd'
    fspt = open(pmd_file,'w')
    fspt.write('%s.wfn\n' % (name))
    if (mol.symmetry == False):
        fspt.write('nosymmetry\n')
    fspt.write('tes\n')
    fspt.write('  epsiscp 0.220\n')
    fspt.write('  radialquad 7\n')
    fspt.write('  rmapping 2\n')
    fspt.write('  lmax 10\n')
    fspt.write('  nr 551\n')
    fspt.write('  lebedev 5810\n')
    fspt.write('  betasphere\n')
    for ia in range(mol.natm):
        symb = mol.atom_pure_symbol(ia)
        inuc = lib.parameters.NUC[symb]
        betarad = radii.COVALENT[inuc]/3.5
        fspt.write('  betaradw %d %1.3f\n' % ((ia+1),betarad))
    fspt.write('  radialquadbeta 7\n')
    fspt.write('  rmappingbeta 3\n')
    fspt.write('  lmaxbeta 8\n')
    fspt.write('  nrb 451\n')
    fspt.write('  lebedevbeta 3074\n')
    fspt.write('  dafh\n')
    fspt.write('endtes')
    fspt.close()                    

    cmd = 'rm '+name+'.mol'
    os.system(cmd)
#INFO: ******************** input file end ********************


System: ('Linux', 'silicio', '3.16.0-4-amd64', '#1 SMP Debian 3.16.51-3 (2017-12-13)', 'x86_64', '')  Threads 12
Python 2.7.14 (default, Apr  9 2018, 16:34:43) 
[GCC 7.3.0]
numpy 1.14.2  scipy 1.0.1
Date: Fri Jun 29 22:54:24 2018
PySCF version 1.5
PySCF path  /home/jluis/src/pyscf/pyscf
GIT ORIG_HEAD f2dbb26d09ae5148fbf5975669a994500ac7a4c9
GIT HEAD      ref: refs/heads/master
GIT master branch  f2dbb26d09ae5148fbf5975669a994500ac7a4c9

[ENV] PYSCF_TMPDIR /scratch-ssd/jluis
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 16
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry 0 subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 O      0.000000000000   0.000000000000   0.596187000000 AA    0.000000000000   0.000000000000   1.126630149026 Bohr
[INPUT]  2 O      0.000000000000   0.000000000000  -0.596187000000 AA    0.000000000000   0.000000000000  -1.126630149026 Bohr

nuclear repulsion = 28.4032874742992
number of shells = 26
number of NR pGTOs = 116
number of NR cGTOs = 92
basis = aug-cc-pvtz
ecp = {}
CPU time:       326.44


******** <class 'pyscf.dft.rks.RKS'> flags ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
DIIS start cycle = 1
DIIS space = 8
SCF tol = 1e-09
SCF gradient tol = None
max. SCF cycles = 120
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = o2.chk
max_memory 64000 MB (current use 107 MB)
XC functionals = m06-l
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs (JCP 102, 346 (M4)) radial grids
    
becke partition: Becke, JCP, 88, 2547 (1988)
pruning grids: <function nwchem_prune at 0x2ba011de95f0>
grids dens level: 4
symmetrized grids: 0
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2ba011de9500>
Set gradient conv threshold to 3.16228e-05
tot grids = 56904
init E= -150.601490002075

WARN: HOMO -0.236234312289753 == LUMO -0.236234312289751

cycle= 1 E= -150.286721861351  delta_E= 0.315  |g|= 0.222  |ddm|=  1.4
  HOMO = -0.199930884323224  LUMO = -0.181880281342556
cycle= 2 E= -150.286244660625  delta_E= 0.000477  |g|= 0.227  |ddm|= 2.07

WARN: HOMO -0.200741312230284 == LUMO -0.199900601568591

cycle= 3 E= -150.291415753597  delta_E= -0.00517  |g|= 0.115  |ddm|= 0.102
  HOMO = -0.211391775199596  LUMO = -0.196066848712297
cycle= 4 E= -150.28690206852  delta_E= 0.00451  |g|= 0.215  |ddm|=    2
  HOMO = -0.210169405116599  LUMO = -0.19996221331616
cycle= 5 E= -150.28885694874  delta_E= -0.00195  |g|= 0.178  |ddm|= 0.0181
  HOMO = -0.207366514453232  LUMO = -0.202301045975764
cycle= 6 E= -150.290560652017  delta_E= -0.0017  |g|= 0.14  |ddm|= 0.0188
  HOMO = -0.21302335105771  LUMO = -0.203274914582765
cycle= 7 E= -150.28887297846  delta_E= 0.00169  |g|= 0.177  |ddm|=    2
  HOMO = -0.212378759838443  LUMO = -0.20389398713036
cycle= 8 E= -150.289329386924  delta_E= -0.000456  |g|= 0.167  |ddm|= 0.00448
  HOMO = -0.20894448554317  LUMO = -0.206023396203837
cycle= 9 E= -150.291080114496  delta_E= -0.00175  |g|= 0.125  |ddm|=    2
  HOMO = -0.20862690298586  LUMO = -0.206195930839183
cycle= 10 E= -150.291205425131  delta_E= -0.000125  |g|= 0.121  |ddm|= 0.0555
  HOMO = -0.211002453564261  LUMO = -0.203755210515339
cycle= 11 E= -150.289799207869  delta_E= 0.00141  |g|= 0.157  |ddm|=    2
  HOMO = -0.210121030724002  LUMO = -0.204586350745104
cycle= 12 E= -150.29034056973  delta_E= -0.000541  |g|= 0.145  |ddm|= 0.00615
  HOMO = -0.20894786585841  LUMO = -0.205831503240187
cycle= 13 E= -150.291020097118  delta_E= -0.00068  |g|= 0.127  |ddm|=    2
  HOMO = -0.214745862575393  LUMO = -0.20028664711724
cycle= 14 E= -150.287013719331  delta_E= 0.00401  |g|= 0.211  |ddm|= 0.0411
  HOMO = -0.20958392107916  LUMO = -0.205057994257238
cycle= 15 E= -150.29063321663  delta_E= -0.00362  |g|= 0.137  |ddm|= 0.0358
  HOMO = -0.209463746759019  LUMO = -0.20535968942792
cycle= 16 E= -150.290749440513  delta_E= -0.000116  |g|= 0.134  |ddm|=    2
  HOMO = -0.208676366615201  LUMO = -0.206024152284249
cycle= 17 E= -150.291140658798  delta_E= -0.000391  |g|= 0.123  |ddm|= 0.00889

WARN: HOMO -0.207756214734881 == LUMO -0.206902257887389

cycle= 18 E= -150.291579783554  delta_E= -0.000439  |g|= 0.11  |ddm|= 0.00743
  HOMO = -0.209317204634601  LUMO = -0.205363971122277
cycle= 19 E= -150.290792456844  delta_E= 0.000787  |g|= 0.133  |ddm|= 0.0291
  HOMO = -0.210455527261171  LUMO = -0.204525123435164
cycle= 20 E= -150.290209933173  delta_E= 0.000583  |g|= 0.148  |ddm|= 0.00823
  HOMO = -0.209454678214626  LUMO = -0.205527294855118
cycle= 21 E= -150.290797767355  delta_E= -0.000588  |g|= 0.133  |ddm|= 0.0281
  HOMO = -0.208071016120974  LUMO = -0.206923047378153
cycle= 22 E= -150.291442231761  delta_E= -0.000644  |g|= 0.115  |ddm|= 0.305
  HOMO = -0.214293184973794  LUMO = -0.201008463591642
cycle= 23 E= -150.287510178714  delta_E= 0.00393  |g|= 0.203  |ddm|= 1.97
  HOMO = -0.214363611563085  LUMO = -0.200944726424282
cycle= 24 E= -150.287453080701  delta_E= 5.71e-05  |g|= 0.204  |ddm|= 0.000491
  HOMO = -0.211271443853122  LUMO = -0.203703295510321
cycle= 25 E= -150.289690202597  delta_E= -0.00224  |g|= 0.16  |ddm|= 0.0749
  HOMO = -0.21234795016895  LUMO = -0.202694994663211
cycle= 26 E= -150.288950857453  delta_E= 0.000739  |g|= 0.176  |ddm|= 0.0571
  HOMO = -0.210249297758595  LUMO = -0.20448765443998
cycle= 27 E= -150.290257871649  delta_E= -0.00131  |g|= 0.147  |ddm|= 0.0452
  HOMO = -0.210228481788136  LUMO = -0.204133033711696
cycle= 28 E= -150.290153380382  delta_E= 0.000104  |g|= 0.149  |ddm|=    2
  HOMO = -0.214644398469529  LUMO = -0.200219532774505
cycle= 29 E= -150.287014558632  delta_E= 0.00314  |g|= 0.211  |ddm|= 0.0353
  HOMO = -0.210774908112636  LUMO = -0.203879016110998
cycle= 30 E= -150.289901131265  delta_E= -0.00289  |g|= 0.155  |ddm|= 0.029
  HOMO = -0.212554048732506  LUMO = -0.202109921559415
cycle= 31 E= -150.288651855566  delta_E= 0.00125  |g|= 0.182  |ddm|= 0.0189

WARN: HOMO -0.207663821596148 == LUMO -0.206979659662141

cycle= 32 E= -150.291618649019  delta_E= -0.00297  |g|= 0.109  |ddm|= 0.0372
  HOMO = -0.213961221272156  LUMO = -0.200902351767913
cycle= 33 E= -150.287613754511  delta_E= 0.004  |g|= 0.201  |ddm|= 1.99
  HOMO = -0.215192141094039  LUMO = -0.199814620031582
cycle= 34 E= -150.286597104704  delta_E= 0.00102  |g|= 0.218  |ddm|= 0.00833
  HOMO = -0.213358268192638  LUMO = -0.20146090373743
cycle= 35 E= -150.28809220043  delta_E= -0.0015  |g|= 0.192  |ddm|= 0.0126
  HOMO = -0.212804656387586  LUMO = -0.201974693077843
cycle= 36 E= -150.288513307959  delta_E= -0.000421  |g|= 0.184  |ddm|= 0.00388
  HOMO = -0.211870118801375  LUMO = -0.202830387565104
cycle= 37 E= -150.289179871944  delta_E= -0.000667  |g|= 0.171  |ddm|= 0.007
  HOMO = -0.213703973275092  LUMO = -0.201099234124103
cycle= 38 E= -150.287801987282  delta_E= 0.00138  |g|= 0.198  |ddm|= 0.0154
  HOMO = -0.210699336669855  LUMO = -0.203822405959735
cycle= 39 E= -150.289908882706  delta_E= -0.00211  |g|= 0.155  |ddm|= 1.99
  HOMO = -0.213696764615021  LUMO = -0.200907463886533
cycle= 40 E= -150.28771888497  delta_E= 0.00219  |g|= 0.199  |ddm|= 0.0216
  HOMO = -0.213478101055897  LUMO = -0.201108629062174
cycle= 41 E= -150.28789310679  delta_E= -0.000174  |g|= 0.196  |ddm|= 0.00233
  HOMO = -0.212541234220238  LUMO = -0.202001630559951
cycle= 42 E= -150.288617739229  delta_E= -0.000725  |g|= 0.182  |ddm|= 0.00661
  HOMO = -0.21026852309467  LUMO = -0.20402808681884
cycle= 43 E= -150.290119681104  delta_E= -0.0015  |g|= 0.15  |ddm|= 1.99

WARN: HOMO -0.20753291878099 == LUMO -0.207253554458363

cycle= 44 E= -150.291711258537  delta_E= -0.00159  |g|= 0.105  |ddm|= 0.0235
  HOMO = -0.215324245677821  LUMO = -0.199549906918932
cycle= 45 E= -150.286419887104  delta_E= 0.00529  |g|= 0.221  |ddm|= 1.99
  HOMO = -0.209378306650449  LUMO = -0.20511025097773
cycle= 46 E= -150.290705835026  delta_E= -0.00429  |g|= 0.135  |ddm|= 1.99
  HOMO = -0.214593008728076  LUMO = -0.199891808848122
cycle= 47 E= -150.286904269511  delta_E= 0.0038  |g|= 0.213  |ddm|= 0.0387
  HOMO = -0.211744789310313  LUMO = -0.202644018769529
cycle= 48 E= -150.289155330021  delta_E= -0.00225  |g|= 0.171  |ddm|= 1.99
  HOMO = -0.208440083116142  LUMO = -0.205923804292562
cycle= 49 E= -150.291175888607  delta_E= -0.00202  |g|= 0.122  |ddm|=    2
  HOMO = -0.212634474379569  LUMO = -0.201622445307842
cycle= 50 E= -150.288448123853  delta_E= 0.00273  |g|= 0.186  |ddm|= 1.99
  HOMO = -0.209906109551481  LUMO = -0.204732510131764
cycle= 51 E= -150.290447850967  delta_E= -0.002  |g|= 0.142  |ddm|= 0.0283
  HOMO = -0.211827408547936  LUMO = -0.202981348950736
cycle= 52 E= -150.289245294356  delta_E= 0.0012  |g|= 0.169  |ddm|= 0.0168

WARN: HOMO -0.208025837403537 == LUMO -0.207170888794521

cycle= 53 E= -150.291573357139  delta_E= -0.00233  |g|= 0.11  |ddm|=    2
  HOMO = -0.21099978333955  LUMO = -0.203650354136365
cycle= 54 E= -150.289759219718  delta_E= 0.00181  |g|= 0.158  |ddm|=    2
  HOMO = -0.208725941864222  LUMO = -0.205808338676939
cycle= 55 E= -150.291073668637  delta_E= -0.00131  |g|= 0.125  |ddm|=    2
  HOMO = -0.21420668042903  LUMO = -0.200444447877489
cycle= 56 E= -150.287322045389  delta_E= 0.00375  |g|= 0.206  |ddm|= 0.0388
  HOMO = -0.214245206341779  LUMO = -0.200613280280299
cycle= 57 E= -150.287373458805  delta_E= -5.14e-05  |g|= 0.205  |ddm|= 1.99
  HOMO = -0.211118677787802  LUMO = -0.203798052522691
cycle= 58 E= -150.289753810206  delta_E= -0.00238  |g|= 0.158  |ddm|= 1.99
  HOMO = -0.210465841072943  LUMO = -0.203834050536178
cycle= 59 E= -150.289998701696  delta_E= -0.000245  |g|= 0.153  |ddm|= 1.99
  HOMO = -0.20817496756269  LUMO = -0.206165359300735
cycle= 60 E= -150.291310782251  delta_E= -0.00131  |g|= 0.118  |ddm|= 0.0178
  HOMO = -0.21124776753162  LUMO = -0.203740673202917
cycle= 61 E= -150.289701161965  delta_E= 0.00161  |g|= 0.159  |ddm|=    2
  HOMO = -0.212102935254894  LUMO = -0.20298823295543
cycle= 62 E= -150.289143303206  delta_E= 0.000558  |g|= 0.171  |ddm|= 0.00645
  HOMO = -0.211636875007876  LUMO = -0.203383295553936
cycle= 63 E= -150.289446986552  delta_E= -0.000304  |g|= 0.165  |ddm|= 0.00344
  HOMO = -0.213993063306184  LUMO = -0.201234317535007
cycle= 64 E= -150.2877310424  delta_E= 0.00172  |g|= 0.199  |ddm|= 0.0162
  HOMO = -0.213031173215652  LUMO = -0.202133075498196
cycle= 65 E= -150.288478533089  delta_E= -0.000747  |g|= 0.185  |ddm|= 0.00669
  HOMO = -0.213603352531963  LUMO = -0.201507485931702
cycle= 66 E= -150.288007754223  delta_E= 0.000471  |g|= 0.194  |ddm|= 1.99
  HOMO = -0.213329181100989  LUMO = -0.201724468309786
cycle= 67 E= -150.288204993964  delta_E= -0.000197  |g|= 0.19  |ddm|= 0.00191
  HOMO = -0.209294778550137  LUMO = -0.205751577842127
cycle= 68 E= -150.290904522619  delta_E= -0.0027  |g|= 0.13  |ddm|= 0.0293
  HOMO = -0.210865435638964  LUMO = -0.204088730199963
cycle= 69 E= -150.289945161567  delta_E= 0.000959  |g|= 0.154  |ddm|= 0.0149
  HOMO = -0.208278299377453  LUMO = -0.206541872534957
cycle= 70 E= -150.291373916924  delta_E= -0.00143  |g|= 0.116  |ddm|= 0.0183
  HOMO = -0.213698334416608  LUMO = -0.201557569220864
cycle= 71 E= -150.2879827412  delta_E= 0.00339  |g|= 0.194  |ddm|= 1.99
  HOMO = -0.21778297439898  LUMO = -0.197730533408801
cycle= 72 E= -150.28427985747  delta_E= 0.0037  |g|= 0.253  |ddm|= 0.0284
  HOMO = -0.219536683308151  LUMO = -0.196190314145833
cycle= 73 E= -150.282450254347  delta_E= 0.00183  |g|= 0.278  |ddm|= 0.0119
  HOMO = -0.216294200734913  LUMO = -0.199031057573023
cycle= 74 E= -150.285700653901  delta_E= -0.00325  |g|= 0.232  |ddm|= 0.0219
  HOMO = -0.215466856220818  LUMO = -0.199896075021931
cycle= 75 E= -150.286501326042  delta_E= -0.000801  |g|= 0.22  |ddm|= 0.00614
  HOMO = -0.216644491908229  LUMO = -0.198807457952621
cycle= 76 E= -150.285420459642  delta_E= 0.00108  |g|= 0.237  |ddm|= 0.0081
  HOMO = -0.217506778558051  LUMO = -0.198011319447842
cycle= 77 E= -150.284580352654  delta_E= 0.00084  |g|= 0.249  |ddm|= 0.00587
  HOMO = -0.214134980114696  LUMO = -0.200423886670042
cycle= 78 E= -150.287348679627  delta_E= -0.00277  |g|= 0.206  |ddm|= 1.98
  HOMO = -0.214176176683233  LUMO = -0.200395623862678
cycle= 79 E= -150.287318790912  delta_E= 2.99e-05  |g|= 0.206  |ddm|= 0.00026
  HOMO = -0.207885809531612  LUMO = -0.206819974902404
cycle= 80 E= -150.291518638199  delta_E= -0.0042  |g|= 0.112  |ddm|= 1.99
  HOMO = -0.208488382584189  LUMO = -0.206320564010024
cycle= 81 E= -150.291277482999  delta_E= 0.000241  |g|= 0.119  |ddm|=    2

WARN: HOMO -0.207374033532689 == LUMO -0.207206778612494

cycle= 82 E= -150.291719634065  delta_E= -0.000442  |g|= 0.106  |ddm|= 0.132
  HOMO = -0.210790536635636  LUMO = -0.20418805541391
cycle= 83 E= -150.28999358089  delta_E= 0.00173  |g|= 0.153  |ddm|= 1.99

WARN: HOMO -0.207733244113406 == LUMO -0.20700372288781

cycle= 84 E= -150.291587342926  delta_E= -0.00159  |g|= 0.11  |ddm|= 1.98

WARN: HOMO -0.207523052035396 == LUMO -0.207301735758526

cycle= 85 E= -150.291246950119  delta_E= 0.00034  |g|= 0.129  |ddm|= 1.63
  HOMO = -0.212197873483149  LUMO = -0.202735180425056
cycle= 86 E= -150.289007789979  delta_E= 0.00224  |g|= 0.174  |ddm|= 0.946
  HOMO = -0.209695695394949  LUMO = -0.204252935244685
cycle= 87 E= -150.29035494275  delta_E= -0.00135  |g|= 0.144  |ddm|= 0.0255
  HOMO = -0.214387816632136  LUMO = -0.20141384924303
cycle= 88 E= -150.287642908476  delta_E= 0.00271  |g|=  0.2  |ddm|= 1.99
  HOMO = -0.221467326047063  LUMO = -0.194638569462426
cycle= 89 E= -150.28032531858  delta_E= 0.00732  |g|= 0.304  |ddm|= 1.98
  HOMO = -0.213573461658772  LUMO = -0.201606260414054
cycle= 90 E= -150.288078293722  delta_E= -0.00775  |g|= 0.192  |ddm|= 1.98
  HOMO = -0.213590996683123  LUMO = -0.201741091463096
cycle= 91 E= -150.28813336652  delta_E= -5.51e-05  |g|= 0.191  |ddm|= 0.014
  HOMO = -0.21346480060819  LUMO = -0.202036014911471
cycle= 92 E= -150.288305445919  delta_E= -0.000172  |g|= 0.188  |ddm|= 0.0126
  HOMO = -0.214079967873528  LUMO = -0.20111187002768
cycle= 93 E= -150.287693094098  delta_E= 0.000612  |g|= 0.199  |ddm|= 0.0256
  HOMO = -0.213533014707979  LUMO = -0.199665961189529
cycle= 94 E= -150.287262902287  delta_E= 0.00043  |g|= 0.207  |ddm|= 0.0726
  HOMO = -0.208777027134126  LUMO = -0.2054910694793
cycle= 95 E= -150.2909584718  delta_E= -0.0037  |g|= 0.129  |ddm|= 1.98
  HOMO = -0.212934387594741  LUMO = -0.199720833479254
cycle= 96 E= -150.287566406342  delta_E= 0.00339  |g|= 0.202  |ddm|= 0.148
  HOMO = -0.207005829093651  LUMO = -0.205795903288571
cycle= 97 E= -150.291377462527  delta_E= -0.00381  |g|= 0.118  |ddm|= 1.97
  HOMO = -0.210722266904348  LUMO = -0.202664245333931
cycle= 98 E= -150.289448677921  delta_E= 0.00193  |g|= 0.166  |ddm|=    2
  HOMO = -0.210807846559561  LUMO = -0.201188198577194
cycle= 99 E= -150.288916517167  delta_E= 0.000532  |g|= 0.178  |ddm|= 1.94
  HOMO = -0.207692611274549  LUMO = -0.205168612240126
cycle= 100 E= -150.291000470209  delta_E= -0.00208  |g|= 0.131  |ddm|= 0.447
  HOMO = -0.207383445519944  LUMO = -0.205465561917598
cycle= 101 E= -150.291124603191  delta_E= -0.000124  |g|= 0.128  |ddm|= 0.0716
  HOMO = -0.207260046053827  LUMO = -0.205391360952821
cycle= 102 E= -150.291105725327  delta_E= 1.89e-05  |g|= 0.129  |ddm|= 0.0874
  HOMO = -0.210574631301339  LUMO = -0.202445157318995
cycle= 103 E= -150.2894888606  delta_E= 0.00162  |g|= 0.164  |ddm|= 1.82
  HOMO = -0.212621049164047  LUMO = -0.201076082053136
cycle= 104 E= -150.288235348212  delta_E= 0.00125  |g|= 0.189  |ddm|= 0.0399
  HOMO = -0.209158331303199  LUMO = -0.205426552939818
cycle= 105 E= -150.29082345777  delta_E= -0.00259  |g|= 0.132  |ddm|= 0.133
  HOMO = -0.21375013850665  LUMO = -0.200125752467954
cycle= 106 E= -150.287255667169  delta_E= 0.00357  |g|= 0.209  |ddm|= 1.98
  HOMO = -0.211431005595081  LUMO = -0.199799520464433
cycle= 107 E= -150.288049799225  delta_E= -0.000794  |g|= 0.196  |ddm|= 0.0449
  HOMO = -0.210689938417082  LUMO = -0.201991044987374
cycle= 108 E= -150.289125847625  delta_E= -0.00108  |g|= 0.175  |ddm|= 0.0619
  HOMO = -0.206938329819854  LUMO = -0.205245195166692
cycle= 109 E= -150.291252590094  delta_E= -0.00213  |g|= 0.123  |ddm|=  1.9
  HOMO = -0.207238380683853  LUMO = -0.204943274431466
cycle= 110 E= -150.291131255609  delta_E= 0.000121  |g|= 0.126  |ddm|= 0.208
  HOMO = -0.212206266152054  LUMO = -0.201271501372885
cycle= 111 E= -150.288402240457  delta_E= 0.00273  |g|= 0.187  |ddm|= 1.98
  HOMO = -0.210440556263655  LUMO = -0.202043830481643
cycle= 112 E= -150.28937855469  delta_E= -0.000976  |g|= 0.166  |ddm|= 0.138
  HOMO = -0.209053845694233  LUMO = -0.203308990557275
cycle= 113 E= -150.290140775131  delta_E= -0.000762  |g|= 0.149  |ddm|= 1.99
  HOMO = -0.208688432318455  LUMO = -0.203269200240678
cycle= 114 E= -150.290325973055  delta_E= -0.000185  |g|= 0.145  |ddm|= 0.00496
  HOMO = -0.204253270144843  LUMO = -0.201988660303657
cycle= 115 E= -150.291152965857  delta_E= -0.000827  |g|= 0.125  |ddm|= 0.315
  HOMO = -0.209045360852412  LUMO = -0.204951204714582
cycle= 116 E= -150.290569857284  delta_E= 0.000583  |g|= 0.141  |ddm|= 1.95
  HOMO = -0.207835686935833  LUMO = -0.206117660482444
cycle= 117 E= -150.291188587926  delta_E= -0.000619  |g|= 0.125  |ddm|= 0.0135
  HOMO = -0.209179268926876  LUMO = -0.206465772581336
cycle= 118 E= -150.29101533637  delta_E= 0.000173  |g|= 0.128  |ddm|= 0.156
  HOMO = -0.210600428516366  LUMO = -0.204569103703733
cycle= 119 E= -150.290164635348  delta_E= 0.000851  |g|= 0.148  |ddm|= 1.99
  HOMO = -0.206301454812131  LUMO = -0.204530577392403
cycle= 120 E= -150.290927813876  delta_E= -0.000763  |g|= 0.137  |ddm|= 1.25
SCF not converged.
SCF energy = -150.290927813876
Electronic spatial extent <R**2> (au): 42.9769
* Multipoles in the independent field-basis, Gauge -> (0,0,0)
Electronic Dipole moment(X, Y, Z, Debye): 0.0000, -0.0000, 0.0325
Nuclear Dipole moment(X, Y, Z, Debye): 0.0000, 0.0000, 0.0000
Total Dipole moment(X, Y, Z, Debye): -0.0000, 0.0000, -0.0325
Quadrupole moments (Debye-Angs)
Total Quadrupole moments (XX, YY, ZZ): -10.3049, -9.6882, -10.4963
Total Quadrupole moments (XY, XZ, YZ): 0.9860, -0.0000, -0.0000
Octupole moments (Debye-Angs**2)
Total Octupole moments (XXX, YYY, ZZZ, XYY): -0.0000, 0.0000, -0.0191, -0.0000
Total Octupole moments (XXY, XXZ, XZZ, YZZ): 0.0000, -0.0014, -0.0000, 0.0000
Total Octupole moments (YYZ, XYZ): -0.0034, -0.0034
Hexadecapole moments (Debye-Angs**3)
Total Hexadecapole moments (XXXX, YYYY, ZZZZ, XXXY): -7.6795, -6.9042, -28.1112, 0.6191
Total Hexadecapole moments (XXXZ, YYYX, YYYZ, ZZZX): -0.0000, 0.6185, 0.0000, -0.0000
Total Hexadecapole moments (ZZZY, XXYY, XXZZ, YYZZ): 0.0000, -2.4315, -6.5546, -6.0282
Total Hexadecapole moments (XXYZ, YYXZ, ZZXY): -0.0000, -0.0000, 0.8387
