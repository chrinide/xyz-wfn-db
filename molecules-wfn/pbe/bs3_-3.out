#INFO: **** input file is /home/jluis/src/git/db/molecules-wfn/pbe/run_sp.py ****
#!/usr/bin/env python

import numpy, sys, os
from pyscf import lib, gto, scf, dft
from pyscf.tools import molden
from pyscf.data import radii

def read_molecule(path):

    charge = spin = 0
    with open(path, 'r') as myfile:
        output = myfile.read()
        output = output.lstrip()
        output = output.rstrip()
        output = output.split('\n')

    try:
        int(output[0])
    except ValueError:
        try:
            charge = int(output[0].split(' ')[0])
            spin = int(output[0].split(' ')[1]) - 1
        except ValueError:
            molecule = output
        else:
            molecule = '\n'.join(output[1:])
    else:
        if int(output[0]) == len(output) - 2:
            molecule = '\n'.join(output[2:])
            try:
                charge = int(output[1].split(' ')[0])
                spin = int(output[1].split(' ')[1])-1
            except ValueError:
                pass
        else:
            print "THIS IS NOT A VALID XYZ FILE"

    return (molecule, charge, spin)

directory = '../../molecules/'
files = [i for i in os.listdir(directory) if i.endswith('.xyz')]

for filename in files:

    name = filename[:-8]
    mol = gto.Mole()
    (mol.atom, charge, spin) = read_molecule(directory+filename)
    mol.basis = 'aug-cc-pvtz'
    mol.charge = charge
    mol.spin = spin
    mol.output = name+'.out'
    mol.symmetry = 0
    mol.max_memory = 10000
    mol.verbose = 4
    mol.build()

    mf = dft.RKS(mol) 
    mf.grids.level = 4
    mf.xc = 'pbe,pbe'
    mf = scf.addons.remove_linear_dep_(mf)
    mf.max_cycle = 120
    mf.chkfile = name+'.chk'
    mf.kernel()

    dm = mf.make_rdm1()
    nao = mol.nao_nr()
    unit = 2.541746
    origin = ([0.0,0.0,0.0])
    charges = mol.atom_charges()
    coords  = mol.atom_coords()
    mol.set_common_orig(origin)
    r2 = mol.intor_symmetric('int1e_r2')
    r2 = numpy.einsum('ij,ji->', r2, dm)
    lib.logger.info(mf,'Electronic spatial extent <R**2> (au): %.4f', r2)

    lib.logger.info(mf,'* Multipoles in the independent field-basis, Gauge -> (0,0,0)')
    ao_dip = mol.intor_symmetric('int1e_r', comp=3)
    el_dip = numpy.einsum('xij,ji->x', ao_dip, dm)
    lib.logger.info(mf,'Electronic Dipole moment(X, Y, Z, Debye): %.4f, %.4f, %.4f', *el_dip*unit)
    nucl_dip = numpy.einsum('i,ix->x', charges, coords)
    lib.logger.info(mf,'Nuclear Dipole moment(X, Y, Z, Debye): %.4f, %.4f, %.4f', *nucl_dip*unit)
    mol_dip = (nucl_dip - el_dip) * unit
    lib.logger.info(mf,'Total Dipole moment(X, Y, Z, Debye): %.4f, %.4f, %.4f', *mol_dip)

    lib.logger.info(mf,'Quadrupole moments (Debye-Angs)')
    rr = mol.intor_symmetric('int1e_rr', comp=9).reshape(3,3,nao,nao)
    rr = -1.0*numpy.einsum('xyij,ji->xy', rr, dm)
    rr += numpy.einsum('z,zx,zy->xy', charges, coords, coords)
    rr = rr*unit*lib.param.BOHR
    lib.logger.info(mf,'Total Quadrupole moments (XX, YY, ZZ): %.4f, %.4f, %.4f', \
    rr[0,0], rr[1,1], rr[2,2])
    lib.logger.info(mf,'Total Quadrupole moments (XY, XZ, YZ): %.4f, %.4f, %.4f', \
    rr[0,1], rr[0,2], rr[1,2])
 
    lib.logger.info(mf,'Octupole moments (Debye-Angs**2)')
    rrr = mol.intor_symmetric('int1e_rrr', comp=27).reshape(3,3,3,nao,nao)
    rrr = -1.0*numpy.einsum('xyzij,ji->xyz', rrr, dm)
    rrr += numpy.einsum('z,zx,zy,zk->xyk', charges, coords, coords, coords)
    rrr = rrr*unit*lib.param.BOHR**2
    lib.logger.info(mf,'Total Octupole moments (XXX, YYY, ZZZ, XYY): %.4f, %.4f, %.4f, %.4f', \
    rrr[0,0,0], rrr[1,1,1], rrr[2,2,2], rrr[0,1,1])
    lib.logger.info(mf,'Total Octupole moments (XXY, XXZ, XZZ, YZZ): %.4f, %.4f, %.4f, %.4f', \
    rrr[0,0,1], rrr[0,0,2], rrr[0,2,2], rrr[1,2,2])
    lib.logger.info(mf,'Total Octupole moments (YYZ, XYZ): %.4f, %.4f', rrr[1,1,2], rrr[0,1,2])

    lib.logger.info(mf,'Hexadecapole moments (Debye-Angs**3)')
    rrrr = mol.intor_symmetric('int1e_rrrr', comp=81).reshape(3,3,3,3,nao,nao)
    rrrr = -1.0*numpy.einsum('xyzwij,ji->xyzw', rrrr, dm)
    rrrr += numpy.einsum('z,zx,zy,zk,zw->xykw', charges, coords, coords, coords, coords)
    rrrr = rrrr*unit*lib.param.BOHR**3
    lib.logger.info(mf,'Total Hexadecapole moments (XXXX, YYYY, ZZZZ, XXXY): %.4f, %.4f, %.4f, %.4f', \
    rrrr[0,0,0,0], rrrr[1,1,1,1], rrrr[2,2,2,2], rrrr[0,0,0,1])
    lib.logger.info(mf,'Total Hexadecapole moments (XXXZ, YYYX, YYYZ, ZZZX): %.4f, %.4f, %.4f, %.4f', \
    rrrr[0,0,0,2], rrrr[1,1,1,0], rrrr[1,1,1,2], rrrr[2,2,2,0])
    lib.logger.info(mf,'Total Hexadecapole moments (ZZZY, XXYY, XXZZ, YYZZ): %.4f, %.4f, %.4f, %.4f', \
    rrrr[2,2,2,1], rrrr[0,0,1,1], rrrr[0,0,2,2], rrrr[1,1,2,2])
    lib.logger.info(mf,'Total Hexadecapole moments (XXYZ, YYXZ, ZZXY): %.4f, %.4f, %.4f', \
    rrrr[0,0,1,2], rrrr[1,1,0,2], rrrr[2,2,0,1])
     
    coeff = mf.mo_coeff[:,mf.mo_occ>0]
    occ = mf.mo_occ[mf.mo_occ>0]
    energy = mf.mo_energy[mf.mo_occ>0]
    den_file = name+'.mol'
    fspt = open(den_file,'w')
    molden.header(mol, fspt)
    molden.orbital_coeff(mol, fspt, coeff, ene=energy, occ=occ) 
    fspt.close()                    
    cmd = '/home/jluis/bin/molden2aim '+name
    os.system(cmd)
    den_file = name+'.wfn'
    fspt = open(den_file,'a')
    fspt.write('RHF\n')
    fspt.close()                    

    pmd_file = name+'.pmd'
    fspt = open(pmd_file,'w')
    fspt.write('%s.wfn\n' % (name))
    if (mol.symmetry == False):
        fspt.write('nosymmetry\n')
    fspt.write('tes\n')
    fspt.write('  epsiscp 0.220\n')
    fspt.write('  radialquad 7\n')
    fspt.write('  rmapping 2\n')
    fspt.write('  lmax 10\n')
    fspt.write('  nr 551\n')
    fspt.write('  lebedev 5810\n')
    fspt.write('  betasphere\n')
    for ia in range(mol.natm):
        symb = mol.atom_pure_symbol(ia)
        inuc = lib.parameters.NUC[symb]
        betarad = radii.COVALENT[inuc]/3.5
        fspt.write('  betaradw %d %1.3f\n' % ((ia+1),betarad))
    fspt.write('  radialquadbeta 7\n')
    fspt.write('  rmappingbeta 3\n')
    fspt.write('  lmaxbeta 8\n')
    fspt.write('  nrb 451\n')
    fspt.write('  lebedevbeta 3074\n')
    fspt.write('  dafh\n')
    fspt.write('endtes')
    fspt.close()                    

    cmd = 'rm '+name+'.mol'
    os.system(cmd)

#INFO: ******************** input file end ********************


System: ('Linux', 'silicio', '3.16.0-4-amd64', '#1 SMP Debian 3.16.51-3 (2017-12-13)', 'x86_64', '')  Threads 12
Python 2.7.14 (default, Apr  9 2018, 16:34:43) 
[GCC 7.3.0]
numpy 1.14.2  scipy 1.0.1
Date: Fri Jun 29 05:29:09 2018
PySCF version 1.5
PySCF path  /home/jluis/src/pyscf/pyscf
GIT ORIG_HEAD f2dbb26d09ae5148fbf5975669a994500ac7a4c9
GIT HEAD      ref: refs/heads/master
GIT master branch  f2dbb26d09ae5148fbf5975669a994500ac7a4c9

[ENV] PYSCF_TMPDIR /scratch-ssd/jluis
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 4
[INPUT] num. electrons = 56
[INPUT] charge = -3
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry 0 subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 B     -0.000125000000   0.000000000000   0.000000000000 AA   -0.000236215766   0.000000000000   0.000000000000 Bohr
[INPUT]  2 S     -0.939610000000   1.627538000000   0.000000000000 AA   -1.775605563903   3.075601077322   0.000000000000 Bohr
[INPUT]  3 S     -0.939610000000  -1.627538000000   0.000000000000 AA   -1.775605563903  -3.075601077322   0.000000000000 Bohr
[INPUT]  4 S      1.879345000000   0.000000000000   0.000000000000 AA    3.551447343571   0.000000000000   0.000000000000 Bohr

nuclear repulsion = 192.433462602917
number of shells = 52
number of NR pGTOs = 283
number of NR cGTOs = 196
basis = aug-cc-pvtz
ecp = {}
CPU time:    259489.98


******** <class 'pyscf.dft.rks.RKS'> flags ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
DIIS start cycle = 1
DIIS space = 8
SCF tol = 1e-09
SCF gradient tol = None
max. SCF cycles = 120
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = bs3_-3.chk
max_memory 10000 MB (current use 244 MB)
XC functionals = pbe,pbe
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs (JCP 102, 346 (M4)) radial grids
    
becke partition: Becke, JCP, 88, 2547 (1988)
pruning grids: <function nwchem_prune at 0x2ab98a2da5f0>
grids dens level: 4
symmetrized grids: 0
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2ab98a2da500>
Set gradient conv threshold to 3.16228e-05
tot grids = 113178
init E= -1219.05524010598
  HOMO = -0.245527951569281  LUMO = -0.0978368447850405
cycle= 1 E= -1218.44175357868  delta_E= 0.613  |g|= 0.742  |ddm|= 1.71
  HOMO = 0.391416100560857  LUMO = 0.405798138472371
cycle= 2 E= -1205.20943079283  delta_E= 13.2  |g|= 3.79  |ddm|=  513
  HOMO = 0.241716861750231  LUMO = 0.294059247837762
cycle= 3 E= -1218.70744136144  delta_E= -13.5  |g|= 0.302  |ddm|=  513
  HOMO = 0.273696314178169  LUMO = 0.294731037589996
cycle= 4 E= -1218.72027283683  delta_E= -0.0128  |g|= 0.336  |ddm|= 3.19

WARN: HOMO 0.305214881313023 == LUMO 0.306057688168942

cycle= 5 E= -1217.80662839695  delta_E= 0.914  |g|= 1.16  |ddm|=  419

WARN: HOMO 0.293373109053475 == LUMO 0.293378315592795

cycle= 6 E= -1218.56310647709  delta_E= -0.756  |g|= 0.476  |ddm|=  420
  HOMO = 0.284535124462348  LUMO = 0.287592436756401
cycle= 7 E= -1218.76046218628  delta_E= -0.197  |g|= 0.0348  |ddm|=  116

WARN: HOMO 0.28689145521183 == LUMO 0.287415867915632

cycle= 8 E= -1218.63538687213  delta_E= 0.125  |g|= 0.425  |ddm|= 88.8

WARN: HOMO 0.286700735991478 == LUMO 0.286769236979187

cycle= 9 E= -1218.61441162113  delta_E= 0.021  |g|= 0.415  |ddm|= 17.9

WARN: HOMO 0.287468347375356 == LUMO 0.287474025204203

cycle= 10 E= -1218.58366382747  delta_E= 0.0307  |g|= 0.434  |ddm|=  155

WARN: HOMO 0.286572680066535 == LUMO 0.286605469450908

cycle= 11 E= -1218.63043920399  delta_E= -0.0468  |g|= 0.396  |ddm|=  152
  HOMO = 0.281274995125039  LUMO = 0.283650417919311
cycle= 12 E= -1218.75943144638  delta_E= -0.129  |g|= 0.0607  |ddm|= 99.9
  HOMO = 0.279541376979832  LUMO = 0.28297339452473
cycle= 13 E= -1218.75944736074  delta_E= -1.59e-05  |g|= 0.0555  |ddm|= 3.51
  HOMO = 0.280178311188933  LUMO = 0.283090715078605
cycle= 14 E= -1218.75999270012  delta_E= -0.000545  |g|= 0.0468  |ddm|= 0.371
  HOMO = 0.281287164347774  LUMO = 0.283304545125263
cycle= 15 E= -1218.76051708691  delta_E= -0.000524  |g|= 0.0378  |ddm|= 0.618

WARN: HOMO 0.283243176645898 == LUMO 0.283740026475241

cycle= 16 E= -1218.75005016649  delta_E= 0.0105  |g|= 0.143  |ddm|=   21

WARN: HOMO 0.284129957692714 == LUMO 0.284333430700794

cycle= 17 E= -1218.59939232231  delta_E= 0.151  |g|= 0.405  |ddm|= 98.4

WARN: HOMO 0.283950572809636 == LUMO 0.284192798702454

cycle= 18 E= -1218.60256596185  delta_E= -0.00317  |g|=  0.4  |ddm|=   32

WARN: HOMO 0.283941388183218 == LUMO 0.284142032112567

cycle= 19 E= -1218.6028370642  delta_E= -0.000271  |g|= 0.399  |ddm|= 30.6

WARN: HOMO 0.283763758759651 == LUMO 0.284057593127226

cycle= 20 E= -1218.60503597629  delta_E= -0.0022  |g|= 0.398  |ddm|= 25.5

WARN: HOMO 0.283897946065867 == LUMO 0.284197129395875

cycle= 21 E= -1218.60091588378  delta_E= 0.00412  |g|= 0.402  |ddm|= 7.55
  HOMO = 0.281196749223192  LUMO = 0.282895901588449
cycle= 22 E= -1218.75903871593  delta_E= -0.158  |g|= 0.0658  |ddm|=  114
  HOMO = 0.280816831902965  LUMO = 0.282479594025057
cycle= 23 E= -1218.76041835473  delta_E= -0.00138  |g|= 0.0408  |ddm|= 5.32

WARN: HOMO 0.280699708569138 == LUMO 0.281565497915846

cycle= 24 E= -1218.76072300442  delta_E= -0.000305  |g|= 0.0342  |ddm|=  1.4
  HOMO = 0.28021247588839  LUMO = 0.282805761114433
cycle= 25 E= -1218.75895746695  delta_E= 0.00177  |g|= 0.0687  |ddm|= 3.73
  HOMO = 0.280529484216623  LUMO = 0.282647112067313
cycle= 26 E= -1218.76042058176  delta_E= -0.00146  |g|= 0.0394  |ddm|= 3.51
  HOMO = 0.280901075258559  LUMO = 0.282098019530669
cycle= 27 E= -1218.76050795085  delta_E= -8.74e-05  |g|= 0.0395  |ddm|= 1.22

WARN: HOMO 0.281375892485582 == LUMO 0.281950893984049

cycle= 28 E= -1218.61204302378  delta_E= 0.148  |g|= 0.387  |ddm|=  115

WARN: HOMO 0.281389999866705 == LUMO 0.282074128958625

cycle= 29 E= -1218.61044408135  delta_E= 0.0016  |g|= 0.388  |ddm|= 4.93

WARN: HOMO 0.281342282461413 == LUMO 0.28221102390574

cycle= 30 E= -1218.60789002491  delta_E= 0.00255  |g|= 0.389  |ddm|= 19.5

WARN: HOMO 0.281691437527553 == LUMO 0.281829007189062

cycle= 31 E= -1218.74593325114  delta_E= -0.138  |g|= 0.162  |ddm|= 90.7
  HOMO = 0.280147576811968  LUMO = 0.282366389862903
cycle= 32 E= -1218.76003070351  delta_E= -0.0141  |g|= 0.0481  |ddm|= 28.5
  HOMO = 0.280690715515995  LUMO = 0.281761942696387
cycle= 33 E= -1218.75981495776  delta_E= 0.000216  |g|= 0.0532  |ddm|= 3.11

WARN: HOMO 0.280830490479469 == LUMO 0.281656920589212

cycle= 34 E= -1218.76021023246  delta_E= -0.000395  |g|= 0.0454  |ddm|= 1.89

WARN: HOMO 0.281067277893862 == LUMO 0.281440957401713

cycle= 35 E= -1218.76069102104  delta_E= -0.000481  |g|= 0.0351  |ddm|= 1.32

WARN: HOMO 0.281616764647681 == LUMO 0.281871528580178

cycle= 36 E= -1218.61002375074  delta_E= 0.151  |g|= 0.386  |ddm|=  116

WARN: HOMO 0.281555307337753 == LUMO 0.281692134885788

cycle= 37 E= -1218.67463658974  delta_E= -0.0646  |g|= 0.338  |ddm|= 35.2

WARN: HOMO 0.28131014369915 == LUMO 0.281508123919157

cycle= 38 E= -1218.61281778604  delta_E= 0.0618  |g|= 0.382  |ddm|= 34.6

WARN: HOMO 0.281372743433146 == LUMO 0.281531719223082

cycle= 39 E= -1218.61045312969  delta_E= 0.00236  |g|= 0.383  |ddm|= 4.77

WARN: HOMO 0.282234991040643 == LUMO 0.282634574010057

cycle= 40 E= -1218.72520878095  delta_E= -0.115  |g|= 0.244  |ddm|= 72.4

WARN: HOMO 0.281665427110511 == LUMO 0.281833270588594

cycle= 41 E= -1218.7517842805  delta_E= -0.0266  |g|= 0.13  |ddm|= 28.1

WARN: HOMO 0.28101714379151 == LUMO 0.281276771095216

cycle= 42 E= -1218.62196000386  delta_E= 0.13  |g|= 0.377  |ddm|= 95.8

WARN: HOMO 0.281380213676686 == LUMO 0.281418984064756

cycle= 43 E= -1218.68328828649  delta_E= -0.0613  |g|= 0.319  |ddm|= 30.9
  HOMO = 0.280057353799454  LUMO = 0.281657504948253
cycle= 44 E= -1218.60977806191  delta_E= 0.0735  |g|= 0.415  |ddm|= 59.1
  HOMO = 0.2790265029345  LUMO = 0.280427920702209
cycle= 45 E= -1218.60737735884  delta_E= 0.0024  |g|= 0.388  |ddm|= 34.4
  HOMO = 0.279021232609469  LUMO = 0.280546473753792
cycle= 46 E= -1218.60526313595  delta_E= 0.00211  |g|= 0.391  |ddm|=   12
  HOMO = 0.277909523653326  LUMO = 0.28034909439836
cycle= 47 E= -1218.60598156233  delta_E= -0.000718  |g|= 0.39  |ddm|= 32.8
  HOMO = 0.276493287580533  LUMO = 0.279610140337067
cycle= 48 E= -1218.60945524585  delta_E= -0.00347  |g|= 0.405  |ddm|= 72.6
  HOMO = 0.273076709864516  LUMO = 0.277928348277737
cycle= 49 E= -1218.61083347686  delta_E= -0.00138  |g|= 0.401  |ddm|= 30.9
  HOMO = 0.255651183976743  LUMO = 0.26814267758753
cycle= 50 E= -1218.37303453138  delta_E= 0.238  |g|= 0.75  |ddm|=  107
  HOMO = 0.233464723459628  LUMO = 0.257408972698349
cycle= 51 E= -1218.69143187938  delta_E= -0.318  |g|= 0.364  |ddm|=  155
  HOMO = 0.229122636468605  LUMO = 0.268033343127196
cycle= 52 E= -1218.7124774059  delta_E= -0.021  |g|= 0.266  |ddm|=  1.3
  HOMO = 0.249767488664756  LUMO = 0.276115874512502
cycle= 53 E= -1218.73353418008  delta_E= -0.0211  |g|= 0.197  |ddm|= 1.11
  HOMO = 0.268145960783038  LUMO = 0.281067560542777
cycle= 54 E= -1218.74974524956  delta_E= -0.0162  |g|= 0.128  |ddm|=  2.3
  HOMO = 0.28033924812977  LUMO = 0.284447788890359
cycle= 55 E= -1218.75886335378  delta_E= -0.00912  |g|= 0.0639  |ddm|= 3.91
  HOMO = 0.284169573669641  LUMO = 0.285188267682336
cycle= 56 E= -1218.75593962296  delta_E= 0.00292  |g|= 0.104  |ddm|= 13.4

WARN: HOMO 0.283623560570517 == LUMO 0.28390089080067

cycle= 57 E= -1218.74235567417  delta_E= 0.0136  |g|= 0.182  |ddm|= 25.2

WARN: HOMO 0.283015865876375 == LUMO 0.284013659092458

cycle= 58 E= -1218.60365480058  delta_E= 0.139  |g|= 0.397  |ddm|= 90.3

WARN: HOMO 0.283114729132048 == LUMO 0.284048465369776

cycle= 59 E= -1218.60368970637  delta_E= -3.49e-05  |g|= 0.397  |ddm|= 3.73

WARN: HOMO 0.282922010534128 == LUMO 0.283700067047522

cycle= 60 E= -1218.60453590116  delta_E= -0.000846  |g|= 0.396  |ddm|= 1.06

WARN: HOMO 0.28201248567671 == LUMO 0.282128331027976

cycle= 61 E= -1218.76098790017  delta_E= -0.156  |g|= 0.0258  |ddm|=  116

WARN: HOMO 0.282176677833611 == LUMO 0.282463545370718

cycle= 62 E= -1218.74061444907  delta_E= 0.0204  |g|= 0.188  |ddm|=   33

WARN: HOMO 0.281775540913058 == LUMO 0.282258115875693

cycle= 63 E= -1218.7593224697  delta_E= -0.0187  |g|= 0.0618  |ddm|= 28.9

WARN: HOMO 0.282206898593807 == LUMO 0.282570250956377

cycle= 64 E= -1218.60786948944  delta_E= 0.151  |g|= 0.389  |ddm|=  113

WARN: HOMO 0.282406137056942 == LUMO 0.282642347559966

cycle= 65 E= -1218.76093864546  delta_E= -0.153  |g|= 0.0308  |ddm|=  116

WARN: HOMO 0.282763989550528 == LUMO 0.282885065418865

cycle= 66 E= -1218.75209125754  delta_E= 0.00885  |g|= 0.128  |ddm|= 18.7

WARN: HOMO 0.282375750793525 == LUMO 0.282832464902686

cycle= 67 E= -1218.60890043466  delta_E= 0.143  |g|= 0.392  |ddm|=  101

WARN: HOMO 0.282385990462667 == LUMO 0.282810637603386

cycle= 68 E= -1218.61259109285  delta_E= -0.00369  |g|= 0.39  |ddm|= 4.73

WARN: HOMO 0.282455487313225 == LUMO 0.282693846014681

cycle= 69 E= -1218.62690425236  delta_E= -0.0143  |g|= 0.382  |ddm|= 10.8

WARN: HOMO 0.282325225541331 == LUMO 0.282885552595076

cycle= 70 E= -1218.60718997165  delta_E= 0.0197  |g|= 0.391  |ddm|=   75

WARN: HOMO 0.282185805887802 == LUMO 0.28282828741985

cycle= 71 E= -1218.60417631074  delta_E= 0.00301  |g|= 0.393  |ddm|= 19.6

WARN: HOMO 0.282070817671175 == LUMO 0.282765765602524

cycle= 72 E= -1218.60514354126  delta_E= -0.000967  |g|= 0.393  |ddm|= 9.62

WARN: HOMO 0.282526137084846 == LUMO 0.282841883808493

cycle= 73 E= -1218.61405626581  delta_E= -0.00891  |g|= 0.39  |ddm|= 49.3
  HOMO = 0.27355161471882  LUMO = 0.276886529055046
cycle= 74 E= -1218.54438311491  delta_E= 0.0697  |g|= 0.567  |ddm|= 80.8
  HOMO = 0.219094381579226  LUMO = 0.245645500983128
cycle= 75 E= -1218.65197486814  delta_E= -0.108  |g|= 0.484  |ddm|=  112
  HOMO = 0.240060234439601  LUMO = 0.267598383318357
cycle= 76 E= -1218.72479550265  delta_E= -0.0728  |g|= 0.228  |ddm|= 2.99
  HOMO = 0.254164422031452  LUMO = 0.273911140241916
cycle= 77 E= -1218.73894032376  delta_E= -0.0141  |g|= 0.176  |ddm|= 1.02
  HOMO = 0.267515724503102  LUMO = 0.279427203401355
cycle= 78 E= -1218.75029812767  delta_E= -0.0114  |g|= 0.126  |ddm|= 1.88
  HOMO = 0.278155895401506  LUMO = 0.283355887839546
cycle= 79 E= -1218.75798130563  delta_E= -0.00768  |g|= 0.071  |ddm|= 2.67

WARN: HOMO 0.285471763105231 == LUMO 0.285916509976535

cycle= 80 E= -1218.60768896465  delta_E= 0.15  |g|= 0.401  |ddm|=  114

WARN: HOMO 0.285214810056851 == LUMO 0.285373406160736

cycle= 81 E= -1218.63577901613  delta_E= -0.0281  |g|= 0.38  |ddm|= 27.5

WARN: HOMO 0.285234160988621 == LUMO 0.285673040452005

cycle= 82 E= -1218.60499335857  delta_E= 0.0308  |g|= 0.399  |ddm|= 16.7

WARN: HOMO 0.285791928282199 == LUMO 0.286124999624524

cycle= 83 E= -1218.60610608085  delta_E= -0.00111  |g|= 0.407  |ddm|= 48.9
  HOMO = 0.282456588678341  LUMO = 0.284069018628309
cycle= 84 E= -1218.76015373237  delta_E= -0.154  |g|= 0.0505  |ddm|=  111
  HOMO = 0.282634075231767  LUMO = 0.283639301119322
cycle= 85 E= -1218.75826885018  delta_E= 0.00188  |g|= 0.0779  |ddm|= 7.76

WARN: HOMO 0.282087073560868 == LUMO 0.282859202812919

cycle= 86 E= -1218.76085001989  delta_E= -0.00258  |g|= 0.0327  |ddm|= 7.48

WARN: HOMO 0.282278225414765 == LUMO 0.282890885119752

cycle= 87 E= -1218.75990435018  delta_E= 0.000946  |g|= 0.0535  |ddm|= 4.68

WARN: HOMO 0.282667824328748 == LUMO 0.283011908939621

cycle= 88 E= -1218.76100966846  delta_E= -0.00111  |g|= 0.0288  |ddm|= 4.67

WARN: HOMO 0.282913685156961 == LUMO 0.283050032334039

cycle= 89 E= -1218.75017087865  delta_E= 0.0108  |g|= 0.139  |ddm|= 22.9

WARN: HOMO 0.28288440010116 == LUMO 0.282953521698666

cycle= 90 E= -1218.75362465444  delta_E= -0.00345  |g|= 0.117  |ddm|= 5.64

WARN: HOMO 0.282695249806409 == LUMO 0.283281846080028

cycle= 91 E= -1218.60281561244  delta_E= 0.151  |g|= 0.396  |ddm|=  100

WARN: HOMO 0.282597841191416 == LUMO 0.283065458708595

cycle= 92 E= -1218.6075926804  delta_E= -0.00478  |g|= 0.393  |ddm|=   17

WARN: HOMO 0.282650283588596 == LUMO 0.283046601773344

cycle= 93 E= -1218.61080755267  delta_E= -0.00321  |g|= 0.392  |ddm|= 1.97

WARN: HOMO 0.282712770137992 == LUMO 0.283058619135569

cycle= 94 E= -1218.62447058028  delta_E= -0.0137  |g|= 0.387  |ddm|= 66.7

WARN: HOMO 0.282522495892068 == LUMO 0.282809039765345

cycle= 95 E= -1218.61842016481  delta_E= 0.00605  |g|= 0.39  |ddm|= 9.77

WARN: HOMO 0.282416635035432 == LUMO 0.282933236415472

cycle= 96 E= -1218.60400769913  delta_E= 0.0144  |g|= 0.395  |ddm|= 22.7
  HOMO = 0.27892881762961  LUMO = 0.282388065306938
cycle= 97 E= -1218.66138300929  delta_E= -0.0574  |g|= 0.418  |ddm|= 99.7
  HOMO = 0.275176731787528  LUMO = 0.279088071305067
cycle= 98 E= -1218.54999424548  delta_E= 0.111  |g|= 0.539  |ddm|= 75.6
  HOMO = 0.220889480484847  LUMO = 0.256387067602048
cycle= 99 E= -1218.67184850745  delta_E= -0.122  |g|= 0.42  |ddm|=  124
  HOMO = 0.239897876999225  LUMO = 0.270250373479873
cycle= 100 E= -1218.726481748  delta_E= -0.0546  |g|= 0.22  |ddm|= 0.99
  HOMO = 0.262596578191939  LUMO = 0.277489616939286
cycle= 101 E= -1218.74683706244  delta_E= -0.0204  |g|= 0.142  |ddm|= 2.19
  HOMO = 0.271949618393808  LUMO = 0.281252501494044
cycle= 102 E= -1218.75410505321  delta_E= -0.00727  |g|= 0.105  |ddm|= 1.81
  HOMO = 0.282414935535976  LUMO = 0.284698900678672
cycle= 103 E= -1218.759208102  delta_E= -0.0051  |g|= 0.0605  |ddm|= 5.91

WARN: HOMO 0.284975417533322 == LUMO 0.28565071564641

cycle= 104 E= -1218.59911701998  delta_E= 0.16  |g|= 0.41  |ddm|=  114

WARN: HOMO 0.285298425592975 == LUMO 0.285953773278358

cycle= 105 E= -1218.59471118998  delta_E= 0.00441  |g|= 0.416  |ddm|= 14.4

WARN: HOMO 0.285648215203238 == LUMO 0.285852257412658

cycle= 106 E= -1218.62055561707  delta_E= -0.0258  |g|= 0.405  |ddm|= 37.5

WARN: HOMO 0.28577918964677 == LUMO 0.286224146490994

cycle= 107 E= -1218.602798004  delta_E= 0.0178  |g|= 0.415  |ddm|= 47.3
  HOMO = 0.280893202244211  LUMO = 0.283647299013646
cycle= 108 E= -1218.75863357909  delta_E= -0.156  |g|= 0.0759  |ddm|=  109
  HOMO = 0.280197552442115  LUMO = 0.28255253498837
cycle= 109 E= -1218.76017926384  delta_E= -0.00155  |g|= 0.0434  |ddm|= 3.89
  HOMO = 0.280168044029038  LUMO = 0.282751796441253
cycle= 110 E= -1218.76023265344  delta_E= -5.34e-05  |g|= 0.043  |ddm|= 0.679
  HOMO = 0.280699163312041  LUMO = 0.28302146928928
cycle= 111 E= -1218.76042741952  delta_E= -0.000195  |g|= 0.0387  |ddm|= 0.471
  HOMO = 0.280942926198936  LUMO = 0.283346425163918
cycle= 112 E= -1218.76030872158  delta_E= 0.000119  |g|= 0.0419  |ddm|= 1.09
  HOMO = 0.281075094187765  LUMO = 0.283386113701538
cycle= 113 E= -1218.76052724253  delta_E= -0.000219  |g|= 0.0369  |ddm|= 0.716

WARN: HOMO 0.283913957033512 == LUMO 0.284018830147493

cycle= 114 E= -1218.67398151631  delta_E= 0.0865  |g|= 0.341  |ddm|= 82.6

WARN: HOMO 0.282605091012869 == LUMO 0.2835672569154

cycle= 115 E= -1218.7610319441  delta_E= -0.0871  |g|= 0.0264  |ddm|= 81.8

WARN: HOMO 0.284140690011724 == LUMO 0.28491009167937

cycle= 116 E= -1218.59838805578  delta_E= 0.163  |g|= 0.406  |ddm|=  115

WARN: HOMO 0.283859345899554 == LUMO 0.283985958754966

cycle= 117 E= -1218.65687377714  delta_E= -0.0585  |g|= 0.361  |ddm|= 39.1

WARN: HOMO 0.282929679165342 == LUMO 0.283785411778786

cycle= 118 E= -1218.76043502684  delta_E= -0.104  |g|= 0.0426  |ddm|= 90.3

WARN: HOMO 0.283665290425618 == LUMO 0.283869669895886

cycle= 119 E= -1218.60273533345  delta_E= 0.158  |g|= 0.399  |ddm|=  115

WARN: HOMO 0.283341564360995 == LUMO 0.283410272321424

cycle= 120 E= -1218.76116944985  delta_E= -0.158  |g|= 0.0242  |ddm|=  115
SCF not converged.
SCF energy = -1218.76116944985
Electronic spatial extent <R**2> (au): 844.1112
* Multipoles in the independent field-basis, Gauge -> (0,0,0)
Electronic Dipole moment(X, Y, Z, Debye): 0.4209, -0.4028, -0.0000
Nuclear Dipole moment(X, Y, Z, Debye): 0.0066, 0.0000, 0.0000
Total Dipole moment(X, Y, Z, Debye): -0.4143, 0.4028, 0.0000
Quadrupole moments (Debye-Angs)
Total Quadrupole moments (XX, YY, ZZ): -120.8794, -121.2770, -78.9297
Total Quadrupole moments (XY, XZ, YZ): 0.2829, 0.0000, -0.0000
Octupole moments (Debye-Angs**2)
Total Octupole moments (XXX, YYY, ZZZ, XYY): -29.7969, 2.7682, 0.0000, 24.9891
Total Octupole moments (XXY, XXZ, XZZ, YZZ): 0.9846, 0.0000, -0.5014, 0.2729
Total Octupole moments (YYZ, XYZ): 0.0000, 0.0000
Hexadecapole moments (Debye-Angs**3)
Total Hexadecapole moments (XXXX, YYYY, ZZZZ, XXXY): -1472.7480, -1493.4400, -353.7384, 11.3622
Total Hexadecapole moments (XXXZ, YYYX, YYYZ, ZZZX): 0.0000, 1.1458, -0.0000, 0.0000
Total Hexadecapole moments (ZZZY, XXYY, XXZZ, YYZZ): -0.0000, -488.6739, -297.0446, -299.4796
Total Hexadecapole moments (XXYZ, YYXZ, ZZXY): -0.0000, -0.0000, 1.1727
